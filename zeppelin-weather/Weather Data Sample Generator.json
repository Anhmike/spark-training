{"paragraphs":[{"text":"%md\n# Generating a Sample of Weather Data\nThis notebook will create a sample of weather data to be used for stream processing. We require the sample to contain all years and stations, and the samples should be ordered by timestamp.\n\nBecause our streaming application expects the raw data, we simply access the original raw files.","dateUpdated":"2017-01-05T02:28:35-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483612115378_-2084812076","id":"20160618-111644_1635493301","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Generating a Sample of Weather Data</h1>\n<p>This notebook will create a sample of weather data to be used for stream processing. We require the sample to contain all years and stations, and the samples should be ordered by timestamp.</p>\n<p>Because our streaming application expects the raw data, we simply access the original raw files.</p>\n"},"dateCreated":"2017-01-05T02:28:35-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5065"},{"text":"val storageLocation = \"/user/training/data/weather\"","dateUpdated":"2017-01-05T03:23:30-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":12,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483612115379_-2085196825","id":"20160618-111748_1432174106","result":{"code":"SUCCESS","type":"TEXT","msg":"\nstorageLocation: String = /user/training/data/weather\n"},"dateCreated":"2017-01-05T02:28:35-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5066","dateFinished":"2017-01-05T03:23:31-0800","dateStarted":"2017-01-05T03:23:30-0800","focus":true},{"text":"// Get RDDs for all years\nval raw_weather_years = (2003 to 2014) map {i => sc.textFile(storageLocation + \"/\" + i.toString)}\n\n// Put all RDDs into a single one using the \"union\" method of the SparkContext\nval raw_weather = sc.union(raw_weather_years)","dateUpdated":"2017-01-05T03:23:35-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483612115379_-2085196825","id":"20160618-111846_1820606220","result":{"code":"SUCCESS","type":"TEXT","msg":"raw_weather_years: scala.collection.immutable.IndexedSeq[org.apache.spark.rdd.RDD[String]] = Vector(/user/training/data/weather/2003 MapPartitionsRDD[326] at textFile at <console>:103, /user/training/data/weather/2004 MapPartitionsRDD[328] at textFile at <console>:103, /user/training/data/weather/2005 MapPartitionsRDD[330] at textFile at <console>:103, /user/training/data/weather/2006 MapPartitionsRDD[332] at textFile at <console>:103, /user/training/data/weather/2007 MapPartitionsRDD[334] at textFile at <console>:103, /user/training/data/weather/2008 MapPartitionsRDD[336] at textFile at <console>:103, /user/training/data/weather/2009 MapPartitionsRDD[338] at textFile at <console>:103, /user/training/data/weather/2010 MapPartitionsRDD[340] at textFile at <console>:103, /user/training/da...\nraw_weather: org.apache.spark.rdd.RDD[String] = UnionRDD[349] at union at <console>:104\n"},"dateCreated":"2017-01-05T02:28:35-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5067","dateFinished":"2017-01-05T03:23:36-0800","dateStarted":"2017-01-05T03:23:35-0800","focus":true},{"text":"raw_weather.take(5).foreach(println)","dateUpdated":"2017-01-05T03:23:40-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483612115379_-2085196825","id":"20160618-111938_294721450","result":{"code":"SUCCESS","type":"TEXT","msg":"0168010015999992003010111504+61450+005870FM-15+0150ENBL V0201801N001510030019N0030001N1-00201-00301999999ADDGA1091+003009999GF109991999999000251999999MA1099901999999MW1861REMMET058ENBL 011150Z 18003KT 3000 SHSN SCT003 VV010 M02/M03 Q0999;EQDQ01+000003PRSWM1Q02    003PRSWM1\n0098010015999992003010112204+61450+005870FM-16+0150ENBL V0201601N001012200019N0020001N1+99999+99999999999ADDMW1001REMMET061ENBL 011220Z 16002KT 2000E -SHSN SCT003 BKN010 M02/M03 Q0999;EQDQ01+000000PRSWM2\n0098010015999992003010112504+61450+005870FM-15+0150ENBL V0202301N001512200019N0025001N1+99999+99999999999ADDMW1001REMMET061ENBL 011250Z 23003KT 2500E -SHSN SCT002 BKN010 M02/M03 Q0999;EQDQ01+000000PRSWM2\n0161010015999992003010113204+61450+005870FM-15+0150ENBL V0209999C000010015019N0012001N1-00101-00201999999ADDGA1091+001509999GF109991999999000251999999MA1099801999999MW1861REMMET051ENBL 011320Z 00000KT 1200 SHSN VV005 M01/M02 Q0998;EQDQ01+000003PRSWM1Q02    003PRSWM1\n0161010015999992003010113504+61450+005870FM-15+0150ENBL V0202101N001010012019N0010001N1-00101-00201999999ADDGA1091+001209999GF109991999999000251999999MA1099801999999MW1861REMMET051ENBL 011350Z 21002KT 1000 SHSN VV004 M01/M02 Q0998;EQDQ01+000003PRSWM1Q02    003PRSWM1\n"},"dateCreated":"2017-01-05T02:28:35-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5068","dateFinished":"2017-01-05T03:23:41-0800","dateStarted":"2017-01-05T03:23:40-0800","focus":true},{"text":"val sample = raw_weather.sample(false, 0.01)\nval sorted = sample.sortBy(_.substring(15,27)).coalesce(10)\nsorted.saveAsTextFile(\"/user/training/output/weather_sample\")","dateUpdated":"2017-01-05T03:24:01-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483612115379_-2085196825","id":"20160618-111951_2046894375","result":{"code":"SUCCESS","type":"TEXT","msg":"\nsample: org.apache.spark.rdd.RDD[String] = PartitionwiseSampledRDD[350] at sample at <console>:106\n\nsorted: org.apache.spark.rdd.RDD[String] = CoalescedRDD[359] at coalesce at <console>:108\n"},"dateCreated":"2017-01-05T02:28:35-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5069","dateFinished":"2017-01-05T03:25:06-0800","dateStarted":"2017-01-05T03:24:01-0800","focus":true},{"dateUpdated":"2017-01-05T03:25:31-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":12,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483612115379_-2085196825","id":"20160618-112715_1007313092","dateCreated":"2017-01-05T02:28:35-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5070","text":"%sh\nhdfs dfs -getmerge /user/training/output/weather_sample /tmp/weather_sample.txt\nhead -n10 /tmp/weather_sample.txt","dateFinished":"2017-01-05T03:25:31-0800","dateStarted":"2017-01-05T03:25:31-0800","result":{"code":"SUCCESS","type":"TEXT","msg":"0173036720999992003010100004+51550-000420FM-12+0040EGWU V0201301N00361003901CN0130001N1+00441+00131101011ADDAA106000091GA1081+003909999MA1999999100541MD1810301+9999REMSYN086AAXX  01004 03672 36463 /1307 10044 20013 30054 40101 58030 92350 333 88/13 555 7/098;EQDQ01  00002PRCP06\n038272576024021200301010053C+42817-108733FM-15+1694LND  V0200405N00315025915MN0160005N1+00005-00615100855ADDAA101000095GD13995+0259159GD24995+0335359GF108991999999999999999999MA1100585999999MW1001REMMET090KLND 010053Z AUTO 04006KT 10SM BKN085 OVC110 00/M06 A2970 RMK AO2 SLP085 T00001061 FZRANO;EQDQ01+000000PRSWM2N01 00000JPWTH 0QNNAA1D0 04085BA1 0 04085AA1D0 06110BA1 0 06110GA1 0 00085KA1D0 00021JA1 0-00061LA1 0 01000CA1 0 02970NA1 0 00000QA1 0 10085SA1D0 00032RA1 0 00000YA1 0 04006\n0219723240138822003010102124+35030-085200FM-16+0210KCHA V0202601N00411006001CN0112651N1+01201+01101999999ADDGD12991+0024019GD22991+0060019GD33991+0270019GF107991999999999999999999MA1100581999999MW1101OC100821REMMET072KCHA 010212Z 26008G16KT 7SM BR FEW008 SCT020 BKN095 12/11 A2970 RMK AO2;EQDQ01+000003PRSWM1Q02    003PRSWM1\n004799999963828200301010330I+31313-084471CRN05+005499999V02099999999999999999N999999999+99999+99999999999ADDAO115000091CG1+0362410CG2+0362710CG3+0353710\n0333702670264152003010103533+64000-145717FM-15+0386BIG  V0202905N00215027435MN0160005N1-02395-02675099615ADDAA101000391GD14995+0274359GF108991999999999999999999MA1098985999999MW1001REMMET078PABI 010353Z 29004KT 10SM OVC090 M24/M27 A2923 RMK AO2 SLP961 P0001 T12391267;EQDQ01+000000PRSWM2N01 00000JPWTH 0QNNAA1D0 06090BA1 0 06090GA1 0 00090KA1D0-00016JA1 0-00267LA1 0 01000CA1 0 02923NA1 0 00000QA1 0 09961SA1D0-00011RA1 0-00239YA1 0 29004\n033972576024021200301010353C+42817-108733FM-15+1694LND  V0202405N00215030485MN0160005N1-00175-00675101095ADDAA101000095GD14995+0304859GF108991999999999999999999MA1100785999999MW1001REMMET084KLND 010353Z AUTO 24004KT 10SM OVC100 M02/M07 A2976 RMK AO2 SLP109 T10171067 FZRANO;EQDQ01+000000PRSWM2N01 00000JPWTH 0QNNAA1D0 06100BA1 0 06100GA1 0 00100KA1D0 00020JA1 0-00067LA1 0 01000CA1 0 02976NA1 0 00000QA1 0 10109SA1D0 00029RA1 0-00017YA1 0 24004\n004799999904990200301010415I+43735-096622CRN05+048699999V02099999999999999999N999999999+99999+99999999999ADDAO115000091CG1+0200610CG2+0198310CG3+0199010\n0195703884999992003010104354+55200-132830AUTO +0000PAHY V0201401N00621007501CN0160931N1+00601+00101999999ADDGD12991+0054019GD22991+0075019GD33991+0093019GF107991999999999999999999MA1099731999999MW1001REMMET072PAHY 010435Z AUTO 14012KT 10SM FEW018 SCT025 BKN031 06/01 A2945 RMK AO1;EQDQ01+000000PRSWM2\n0459726360148402003010106003+43167-086233SY-MT+0190MKG  V0201005N00215220005MN0160005N1-00445-00725101885ADDAA101000095AA206000091GA1001+999999999GD10995+9999999GF100991001001999999001001GP10060000002000000002000000002000GR100600000900009KA1240M+00061KA2240N-00441MA1101795099481MD1310091+9999REMSYN092AAXX  01064 72636 32966 01004 11044 21072 39948 40188 53009 90555 333 10006 21044 555 90106;EQDQ01  00002PRCP06N01 00000JPWTH 0QNNAA1D0 00000BA1 0 00000GA1U0 99999KA1D0 00019JA1 0-00072LA1 0 01000CA1 0 03006NA1 0 00000QA1 0 10188SA1D0 00024RA1 0-00044YA1 0 10004\n0187038940999992003010106504+49430-002600FM-15+0102EGJB V0202001N00621220001CN0003001N1+01201+01201999999ADDED199U03509GA1071+000159999GF107991999999999999999999MA1099901999999MW1441MW2531REMMET060EGJB 010650Z 20012KT 0300 R27/0350 DZ FG BKN000 12/12 Q0999;EQDQ01+000003PRSWM1Q02    003PRSWM1\n"},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483612147860_-1895854393","id":"20170105-022907_937071531","dateCreated":"2017-01-05T02:29:07-0800","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5482","dateUpdated":"2017-01-05T02:29:18-0800","text":""}],"name":"Weather Data Sample Generator","id":"2C5KCTEH3","angularObjects":{"2C7PVCCMW:shared_process":[],"2C7N8FNUK:shared_process":[],"2C4ZABBYG:shared_process":[],"2C7NHPHKH:shared_process":[],"2C4ACPMVH:shared_process":[],"2C5JAXWD8:shared_process":[],"2C68PFPBP:shared_process":[],"2C6BVC9ES:shared_process":[],"2C66FR28V:shared_process":[],"2C4Y5MV3V:shared_process":[],"2C6KQ2GNT:shared_process":[],"2C78K3BRW:shared_process":[],"2C81FGN7P:shared_process":[],"2C5BQGTGT:shared_process":[],"2C7VFSCFR:shared_process":[],"2C5MXJ5D6:shared_process":[],"2C44EB781:shared_process":[],"2C4JS2HDQ:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}