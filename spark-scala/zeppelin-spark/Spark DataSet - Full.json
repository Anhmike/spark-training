{"paragraphs":[{"text":"%md\n# 1 Creating DataSets","dateUpdated":"2018-11-12T19:12:10+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896147_364413451","id":"20160617-201427_857258739","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h1>1 Creating DataSets</h1>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:39198","user":"anonymous","dateFinished":"2018-11-12T19:12:10+0000","dateStarted":"2018-11-12T19:12:10+0000"},{"text":"case class Person(\n    name:String,\n    sex:String,\n    age:Int)\n{\n}","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896147_364413451","id":"20160617-200218_1910498306","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class Person\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39199"},{"text":"val persons = Seq(\n        Person(\"Alice\", \"female\", 32), \n        Person(\"Bob\", \"male\", 24),\n        Person(\"Christine\", \"female\", 42), \n        Person(\"Dale\", \"male\", 19),\n        Person(\"Eve\", \"female\", 33)\n    ).toDS","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896148_362489706","id":"20160617-200626_1254551091","result":{"code":"SUCCESS","type":"TEXT","msg":"\npersons: org.apache.spark.sql.Dataset[Person] = [name: string, sex: string ... 1 more field]\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39200"},{"text":"persons.collect().foreach(println)","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896148_362489706","id":"20170105-002313_1230126684","result":{"code":"SUCCESS","type":"TEXT","msg":"Person(Alice,female,32)\nPerson(Bob,male,24)\nPerson(Christine,female,42)\nPerson(Dale,male,19)\nPerson(Eve,female,33)\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39201"},{"text":"%md\n## 1.1 Inspect Schema","dateUpdated":"2018-11-12T19:12:17+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896149_362104957","id":"20160617-205347_1951340760","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>1.1 Inspect Schema</h2>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39202","user":"anonymous","dateFinished":"2018-11-12T19:12:17+0000","dateStarted":"2018-11-12T19:12:17+0000"},{"text":"persons.schema","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896149_362104957","id":"20160617-201326_798645553","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres3: org.apache.spark.sql.types.StructType = StructType(StructField(name,StringType,true), StructField(sex,StringType,true), StructField(age,IntegerType,false))\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39203"},{"text":"persons.printSchema()","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":124.60000610351562,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896150_363259204","id":"20170105-010005_1268070331","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- name: string (nullable = true)\n |-- sex: string (nullable = true)\n |-- age: integer (nullable = false)\n\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39204"},{"text":"%md\n## 1.2 Loading Data","dateUpdated":"2018-11-12T19:12:28+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896150_363259204","id":"20170105-010041_2117356113","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>1.2 Loading Data</h2>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39205","user":"anonymous","dateFinished":"2018-11-12T19:12:28+0000","dateStarted":"2018-11-12T19:12:28+0000"},{"text":"import org.apache.spark.sql.types.IntegerType\nval persons = spark.read.json(\"s3://dimajix-training/data/persons.json\")\n    .withColumn(\"age\", $\"age\".cast(IntegerType))\n    .as[Person]","dateUpdated":"2018-11-12T19:14:12+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896151_362874455","id":"20170105-010057_986098899","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.types.IntegerType\n\npersons: org.apache.spark.sql.Dataset[Person] = [age: int, height: bigint ... 2 more fields]\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39206"},{"text":"%md\n### Note Schema vs Class Definition","dateUpdated":"2018-11-12T19:12:39+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896151_362874455","id":"20170105-010721_139087314","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h3>Note Schema vs Class Definition</h3>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39207","user":"anonymous","dateFinished":"2018-11-12T19:12:39+0000","dateStarted":"2018-11-12T19:12:39+0000"},{"text":"persons.printSchema()","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896151_362874455","id":"20170105-010659_1991798171","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- age: integer (nullable = true)\n |-- height: long (nullable = true)\n |-- name: string (nullable = true)\n |-- sex: string (nullable = true)\n\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39208"},{"text":"%md\n### Pretty Printing","dateUpdated":"2018-11-12T19:12:58+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896152_360950711","id":"20160618-054348_706632489","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h3>Pretty Printing</h3>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39209","user":"anonymous","dateFinished":"2018-11-12T19:12:58+0000","dateStarted":"2018-11-12T19:12:58+0000"},{"text":"z.show(persons)","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":204,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896152_360950711","id":"20160618-054337_2135335309","result":{"code":"SUCCESS","type":"TABLE","msg":"age\theight\tname\tsex\n14\t156\tAlice\tfemale\n21\t181\tBob\tmale\n27\t176\tCharlie\tmale\n24\t167\tEve\tfemale\n19\t172\tFrances\tfemale\n31\t191\tGeorge\tmale\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39210"},{"text":"%md\n# 2 Simple Transformations","dateUpdated":"2018-11-12T19:18:08+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896153_360565962","id":"20160617-205415_2045240993","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h1>2 Simple Transformations</h1>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39211","user":"anonymous","dateFinished":"2018-11-12T19:18:08+0000","dateStarted":"2018-11-12T19:18:08+0000"},{"text":"%md\n## 2.1 `map` et al","dateUpdated":"2018-11-12T19:18:37+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542050299545_-724676057","id":"20181112-191819_759653816","dateCreated":"2018-11-12T19:18:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:44116","user":"anonymous","dateFinished":"2018-11-12T19:18:37+0000","dateStarted":"2018-11-12T19:18:37+0000","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>2.1 <code>map</code> et al</h2>\n</div>"}},{"text":"// TODO","dateUpdated":"2018-11-12T19:18:55+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542050321235_-1955841889","id":"20181112-191841_1123152213","dateCreated":"2018-11-12T19:18:41+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:44200"},{"text":"%md\n## 2.2 DataFrame `select`","dateUpdated":"2018-11-12T19:18:17+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542050290323_-1469950001","id":"20181112-191810_1129285467","dateCreated":"2018-11-12T19:18:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:44032","user":"anonymous","dateFinished":"2018-11-12T19:18:17+0000","dateStarted":"2018-11-12T19:18:17+0000","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>2.2 DataFrame <code>select</code></h2>\n</div>"}},{"text":"val result = persons.select($\"name\".as[String], $\"age\".as[String])\nz.show(result)","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896153_360565962","id":"20160618-055305_406692908","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tage\nAlice\t14\nBob\t21\nCharlie\t27\nEve\t24\nFrances\t19\nGeorge\t31\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39212"},{"text":"%md\n### Compare Dataset Types\n\nInput data type is \"Person\", while the result of the select operation is a tuple","dateUpdated":"2018-11-12T19:14:21+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896154_361720208","id":"20170105-002950_381594314","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h3>Compare Dataset Types</h3>\n<p>Input data type is &ldquo;Person&rdquo;, while the result of the select operation is a tuple</p>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39213","user":"anonymous","dateFinished":"2018-11-12T19:14:21+0000","dateStarted":"2018-11-12T19:14:21+0000"},{"text":"persons","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896154_361720208","id":"20170105-003038_78931382","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres14: org.apache.spark.sql.Dataset[Person] = [age: int, height: bigint ... 2 more fields]\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39214"},{"text":"result","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896155_361335460","id":"20170105-003042_32233686","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres16: org.apache.spark.sql.Dataset[(String, String)] = [name: string, age: int]\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39215"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542050090478_-1671233328","id":"20181112-191450_2081317570","dateCreated":"2018-11-12T19:14:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:43594","text":"%md\n# 3 Joins","user":"anonymous","dateUpdated":"2018-11-12T19:14:58+0000","dateFinished":"2018-11-12T19:14:58+0000","dateStarted":"2018-11-12T19:14:58+0000","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h1>3 Joins</h1>\n</div>"}},{"text":"%md\n## 3.1 Dataset Joining\n\nDatasets  also support join operations, the result is a tuple.","dateUpdated":"2018-11-12T19:15:04+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896155_361335460","id":"20160618-064756_323624134","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>3.1 Dataset Joining</h2>\n<p>Datasets also support join operations, the result is a tuple.</p>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39216","user":"anonymous","dateFinished":"2018-11-12T19:15:04+0000","dateStarted":"2018-11-12T19:15:04+0000"},{"text":"case class PersonAddress (\n    name:String,\n    city:String\n) { }\n\nval addresses = spark.read.json(\"file:///home/cloudera/Training/data/addresses.json\")\n    .as[PersonAddress]","dateUpdated":"2018-11-12T19:14:43+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896155_361335460","id":"20160618-064806_552944470","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class PersonAddress\n\naddresses: org.apache.spark.sql.Dataset[PersonAddress] = [city: string, name: string]\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39217"},{"text":"val result = persons.as(\"person\").joinWith(addresses.as(\"address\"), $\"person.name\" === $\"address.name\")\nz.show(result)","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":124,"optionOpen":false,"keys":[{"name":"_1","index":0,"aggr":"sum"}],"values":[{"name":"_2","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"_1","index":0,"aggr":"sum"},"yAxis":{"name":"_2","index":1,"aggr":"sum"}}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896156_359411715","id":"20160618-065315_531175389","result":{"code":"SUCCESS","type":"TABLE","msg":"_1\t_2\n[14,156,Alice,female]\t[Hamburg,Alice]\n[21,181,Bob,male]\t[Frankfurt,Bob]\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39218"},{"text":"result","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896156_359411715","id":"20170105-003325_556063070","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres23: org.apache.spark.sql.Dataset[(Person, PersonAddress)] = [_1: struct<age: int, height: bigint ... 2 more fields>, _2: struct<city: string, name: string>]\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39219"},{"text":"result.printSchema","dateUpdated":"2018-11-12T19:11:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896156_359411715","id":"20170131-224714_1038353131","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- _1: struct (nullable = false)\n |    |-- age: integer (nullable = true)\n |    |-- height: long (nullable = true)\n |    |-- name: string (nullable = true)\n |    |-- sex: string (nullable = true)\n |-- _2: struct (nullable = false)\n |    |-- city: string (nullable = true)\n |    |-- name: string (nullable = true)\n\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39220"},{"text":"%md\n## 3.2 DataFrame like Joining\n\nYou can also use traditional DataFrame join methods, these will return a DataFrame instead of a Dataset","dateUpdated":"2018-11-12T19:15:10+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896157_359026966","id":"20170105-003438_1163697573","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>3.2 DataFrame like Joining</h2>\n<p>You can also use traditional DataFrame join methods, these will return a DataFrame instead of a Dataset</p>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39221","user":"anonymous","dateFinished":"2018-11-12T19:15:10+0000","dateStarted":"2018-11-12T19:15:10+0000"},{"text":"val result = persons.as(\"person\").join(addresses.as(\"address\"), $\"person.name\" === $\"address.name\")\nz.show(result)","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":129,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896157_359026966","id":"20170105-003456_603691475","result":{"code":"SUCCESS","type":"TABLE","msg":"age\theight\tname\tsex\tcity\tname\n14\t156\tAlice\tfemale\tHamburg\tAlice\n21\t181\tBob\tmale\tFrankfurt\tBob\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39222"},{"text":"result.printSchema","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896157_359026966","id":"20170105-003538_2088315656","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- age: integer (nullable = true)\n |-- height: long (nullable = true)\n |-- name: string (nullable = true)\n |-- sex: string (nullable = true)\n |-- city: string (nullable = true)\n |-- name: string (nullable = true)\n\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39223"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542050120917_2035114124","id":"20181112-191520_1613620509","dateCreated":"2018-11-12T19:15:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:43697","text":"%md\n# 4 Grouping & Aggrgeation","user":"anonymous","dateUpdated":"2018-11-12T19:15:40+0000","dateFinished":"2018-11-12T19:15:40+0000","dateStarted":"2018-11-12T19:15:40+0000","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h1>4 Grouping &amp; Aggrgeation</h1>\n</div>"}},{"text":"%md\n## 4.1 Dataset Grouping\n\nAlso grouping operations are supported, returning the special type \"GroupedData\".","dateUpdated":"2018-11-12T19:15:45+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896158_360181213","id":"20160618-060107_408877976","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>4.1 Dataset Grouping</h2>\n<p>Also grouping operations are supported, returning the special type &ldquo;GroupedData&rdquo;.</p>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39224","user":"anonymous","dateFinished":"2018-11-12T19:15:45+0000","dateStarted":"2018-11-12T19:15:45+0000"},{"text":"persons.groupByKey(_.sex)","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896158_360181213","id":"20170105-011441_1643155245","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres31: org.apache.spark.sql.KeyValueGroupedDataset[String,Person] = org.apache.spark.sql.KeyValueGroupedDataset@36777e4\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39225"},{"text":"val result = persons.groupByKey(_.sex).agg(sum($\"age\").as(\"sum_age\").as[Long])\nz.show(result)","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":159,"optionOpen":false,"keys":[{"name":"value","index":0,"aggr":"sum"}],"values":[{"name":"sum_age","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"value","index":0,"aggr":"sum"}}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896158_360181213","id":"20160617-205426_874417461","result":{"code":"SUCCESS","type":"TABLE","msg":"value\tsum_age\nfemale\t57\nmale\t79\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39226"},{"text":"result","dateUpdated":"2018-11-12T19:11:36+0000","config":{"tableHide":false,"editorMode":"ace/mode/scala","colWidth":12,"editorHide":false,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896159_359796464","id":"20170105-003813_1445330503","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres35: org.apache.spark.sql.Dataset[(String, Long)] = [value: string, sum_age: bigint]\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39227"},{"text":"result","dateUpdated":"2018-11-12T19:11:36+0000","config":{"colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896160_345560755","id":"20170105-004046_233218812","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres37: org.apache.spark.sql.DataFrame = [sex: string, sum_age: bigint]\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39230"},{"text":"%md\n## 4.2 Use groupByKey with mapGroups","dateUpdated":"2018-11-12T19:19:53+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896160_345560755","id":"20170105-004009_780928702","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>4.2 Use groupByKey with mapGroups</h2>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39231","user":"anonymous","dateFinished":"2018-11-12T19:19:53+0000","dateStarted":"2018-11-12T19:19:53+0000"},{"text":"def avg_age(persons:Iterator[Person]) = {\n    val (age,count) = persons\n        .map(p => (p.age,1))\n        .reduce((l,r) => (l._1 + r._1, l._2 + r._2))\n        \n    age.toFloat / count.toFloat\n}\n\nval result = persons\n    .groupByKey(_.sex)\n    .mapGroups { case (key,values) => (key, avg_age(values)) }\n\nz.show(result)","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":154,"optionOpen":false,"keys":[{"name":"_1","index":0,"aggr":"sum"}],"values":[{"name":"_2","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"_1","index":0,"aggr":"sum"},"yAxis":{"name":"_2","index":1,"aggr":"sum"}}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896160_345560755","id":"20160618-060120_1186022942","result":{"code":"SUCCESS","type":"TABLE","msg":"_1\t_2\nfemale\t19.0\nmale\t26.333334\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39232"},{"text":"%md\n## 4.3 DataFrame groupBy","dateUpdated":"2018-11-12T19:19:48+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896159_359796464","id":"20170105-003951_1649173549","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>4.3 DataFrame groupBy</h2>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39228","user":"anonymous","dateFinished":"2018-11-12T19:19:48+0000","dateStarted":"2018-11-12T19:19:48+0000","focus":true},{"text":"val result = persons.groupBy($\"sex\").agg(sum($\"age\").as(\"sum_age\"))\nz.show(result)","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":134,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896159_359796464","id":"20170105-004005_1889169884","result":{"code":"SUCCESS","type":"TABLE","msg":"sex\tsum_age\nfemale\t57\nmale\t79\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39229","focus":true},{"text":"result","dateUpdated":"2018-11-12T19:11:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896160_345560755","id":"20170131-225205_2110338895","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres43: org.apache.spark.sql.Dataset[(String, Float)] = [_1: string, _2: float]\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39233"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542050212503_1624910500","id":"20181112-191652_124673017","dateCreated":"2018-11-12T19:16:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:43908","text":"%md\n# 5 DataSet <> RDD Conversions","user":"anonymous","dateUpdated":"2018-11-12T19:17:06+0000","dateFinished":"2018-11-12T19:17:06+0000","dateStarted":"2018-11-12T19:17:06+0000","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h1>5 DataSet &lt;&gt; RDD Conversions</h1>\n</div>"}},{"text":"%md\n## 5.1 Convert to RDD\n\nYou can convert a Dataset to a simpler RDD. This will finally drop unused columns.","dateUpdated":"2018-11-12T19:17:11+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896161_345176006","id":"20160617-201355_1310344176","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>5.1 Convert to RDD</h2>\n<p>You can convert a Dataset to a simpler RDD. This will finally drop unused columns.</p>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39234","user":"anonymous","dateFinished":"2018-11-12T19:17:11+0000","dateStarted":"2018-11-12T19:17:11+0000"},{"text":"val rdd = persons.rdd\n\nrdd.collect().foreach(println)","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896161_345176006","id":"20160618-053912_1439030409","result":{"code":"SUCCESS","type":"TEXT","msg":"\nrdd: org.apache.spark.rdd.RDD[Person] = MapPartitionsRDD[62] at rdd at <console>:33\nPerson(Alice,female,14)\nPerson(Bob,male,21)\nPerson(Charlie,male,27)\nPerson(Eve,female,24)\nPerson(Frances,female,19)\nPerson(George,male,31)\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39235"},{"text":"%md\n## 5.2 Convert back RDD to Dataset\n\nNote that the Dataset will not contain the unused column \"height\" any more.","dateUpdated":"2018-11-12T19:17:17+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896161_345176006","id":"20160618-053953_1578828210","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>5.2 Convert back RDD to Dataset</h2>\n<p>Note that the Dataset will not contain the unused column &ldquo;height&rdquo; any more.</p>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39236","user":"anonymous","dateFinished":"2018-11-12T19:17:17+0000","dateStarted":"2018-11-12T19:17:17+0000"},{"text":"val ds = rdd.toDS","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896162_346330252","id":"20160618-053926_647385200","result":{"code":"SUCCESS","type":"TEXT","msg":"\nds: org.apache.spark.sql.Dataset[Person] = [name: string, sex: string ... 1 more field]\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39237"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542050173076_1188928699","id":"20181112-191613_1426194629","dateCreated":"2018-11-12T19:16:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:43811","text":"%md\n# 6 IO Operations","user":"anonymous","dateUpdated":"2018-11-12T19:17:23+0000","dateFinished":"2018-11-12T19:17:23+0000","dateStarted":"2018-11-12T19:17:23+0000","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h1>6 IO Operations</h1>\n</div>"}},{"text":"%md\n## 7.1 Write to Parquet\n\n1. Get DataFrame writer\n2. Write Dataset to Parquet\n\nNote that this will also write unused columns!","dateUpdated":"2018-11-12T19:17:29+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896162_346330252","id":"20160617-201512_1954263996","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>7.1 Write to Parquet</h2>\n<ol>\n  <li>Get DataFrame writer</li>\n  <li>Write Dataset to Parquet</li>\n</ol>\n<p>Note that this will also write unused columns!</p>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39238","user":"anonymous","dateFinished":"2018-11-12T19:17:29+0000","dateStarted":"2018-11-12T19:17:29+0000"},{"text":"import org.apache.spark.sql.SaveMode\n\npersons.write.mode(SaveMode.Overwrite).parquet(\"persons.parquet\")","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"editorHide":false,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896162_346330252","id":"20160617-201343_563402997","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.SaveMode\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39239"},{"text":"%md\n## 7.2 Read from Parquet\n1. Read DataFrame from Parquet\n2. Convert DataFrame to DataSet\n\nSee the unused column \"height\" reappear aggain.","dateUpdated":"2018-11-12T19:17:37+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896163_345945504","id":"20160617-204919_1431109393","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h2>7.2 Read from Parquet</h2>\n<ol>\n  <li>Read DataFrame from Parquet</li>\n  <li>Convert DataFrame to DataSet</li>\n</ol>\n<p>See the unused column &ldquo;height&rdquo; reappear aggain.</p>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39240","user":"anonymous","dateFinished":"2018-11-12T19:17:37+0000","dateStarted":"2018-11-12T19:17:37+0000"},{"text":"val df = sqlContext.read.parquet(\"persons.parquet\")\nval ds = df.as[Person]\n\nz.show(ds)","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":244,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896163_345945504","id":"20160617-204932_794634446","result":{"code":"SUCCESS","type":"TABLE","msg":"age\theight\tname\tsex\n14\t156\tAlice\tfemale\n21\t181\tBob\tmale\n27\t176\tCharlie\tmale\n24\t167\tEve\tfemale\n19\t172\tFrances\tfemale\n31\t191\tGeorge\tmale\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39241"},{"text":"%md\n# 8 Nested Classes","dateUpdated":"2018-11-12T19:17:43+0000","config":{"editorMode":"ace/mode/markdown","colWidth":12,"editorHide":true,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896163_345945504","id":"20160617-202215_225550959","result":{"code":"SUCCESS","type":"HTML","msg":"<div class=\"markdown-body\">\n<h1>8 Nested Classes</h1>\n</div>"},"dateCreated":"2018-11-12T19:11:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:39242","user":"anonymous","dateFinished":"2018-11-12T19:17:43+0000","dateStarted":"2018-11-12T19:17:43+0000"},{"text":"case class Address(\n    city:String,\n    street:String\n)\n    \ncase class Person(\n    name:String,\n    sex:String,\n    addresses:Array[Address]\n)\n","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896164_344021759","id":"20160618-093335_468111792","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class Address\n\ndefined class Person\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39243"},{"text":"val ds = Seq(\n    Person(\"Alice\",\"female\",Array(Address(\"Berlin\",\"Hauptstraße 2\"),Address(\"Stuttgart\",\"Am Anger 13\"))),\n    Person(\"Bob\",\"male\",Array(Address(\"Mainz\",\"Kellergasse 23\")))\n).toDS","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896164_344021759","id":"20160618-093452_1868521561","result":{"code":"SUCCESS","type":"TEXT","msg":"\nds: org.apache.spark.sql.Dataset[Person] = [name: string, sex: string ... 1 more field]\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39244"},{"text":"ds.printSchema()","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896164_344021759","id":"20160618-093933_727106056","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- name: string (nullable = true)\n |-- sex: string (nullable = true)\n |-- addresses: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- city: string (nullable = true)\n |    |    |-- street: string (nullable = true)\n\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39245"},{"text":"import org.apache.spark.sql.SaveMode\n\nds.write.mode(SaveMode.Overwrite).parquet(\"persons2.parquet\")","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896165_343637010","id":"20160618-093622_1119250452","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.SaveMode\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39246"},{"text":"val ds = sqlContext.read.parquet(\"persons2.parquet\").as[Person]\n\nz.show(ds)","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"name","index":0,"aggr":"sum"}],"values":[{"name":"sex","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"name","index":0,"aggr":"sum"},"yAxis":{"name":"sex","index":1,"aggr":"sum"}}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896165_343637010","id":"20160618-093745_1829082972","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tsex\taddresses\nAlice\tfemale\tWrappedArray([Berlin,Hauptstraße 2], [Stuttgart,Am Anger 13])\nBob\tmale\tWrappedArray([Mainz,Kellergasse 23])\n"},"dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39247"},{"text":"","dateUpdated":"2018-11-12T19:11:36+0000","config":{"editorMode":"ace/mode/scala","colWidth":12,"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542049896165_343637010","id":"20160618-093840_324274912","dateCreated":"2018-11-12T19:11:36+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:39248"}],"name":"Spark DataSet - Full","id":"2DXRFVTZP","angularObjects":{"2DU4EM1QC:shared_process":[],"2DWH63KTX:shared_process":[],"2DTY3NN2K:shared_process":[],"2DTW2RFCG:shared_process":[],"2DUQAGCKJ:shared_process":[],"2DWWDB4VQ:shared_process":[],"2DV7ZN8WX:shared_process":[],"2DWF6XUFU:shared_process":[],"2DVE9GW7A:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}