{"paragraphs":[{"text":"%md\n# Load Dependencies\nFirst we have to load additional dependencies that we want to use. In this case we want to use a CSV parser.","dateUpdated":"Jun 11, 2016 9:00:48 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635630898_215366959","id":"20160611-090030_1196932168","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Load Dependencies</h1>\n<p>First we have to load additional dependencies that we want to use. In this case we want to use a CSV parser.</p>\n"},"dateCreated":"Jun 11, 2016 9:00:30 AM","dateStarted":"Jun 11, 2016 9:00:45 AM","dateFinished":"Jun 11, 2016 9:00:45 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1421"},{"text":"%dep\nz.load(\"com.databricks:spark-csv_2.10:1.4.0\")","dateUpdated":"Jun 11, 2016 9:05:16 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635629273_740549207","id":"20160611-090029_1452697436","result":{"code":"SUCCESS","type":"TEXT","msg":"res0: org.apache.zeppelin.spark.dep.Dependency = org.apache.zeppelin.spark.dep.Dependency@5bb17353\n"},"dateCreated":"Jun 11, 2016 9:00:29 AM","dateStarted":"Jun 11, 2016 9:05:16 AM","dateFinished":"Jun 11, 2016 9:05:23 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1422"},{"text":"%md\n# Pretty Printing","dateUpdated":"Jun 11, 2016 7:13:10 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465629180502_386407317","id":"20160611-071300_456895248","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Pretty Printing</h1>\n"},"dateCreated":"Jun 11, 2016 7:13:00 AM","dateStarted":"Jun 11, 2016 7:13:08 AM","dateFinished":"Jun 11, 2016 7:13:08 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1423"},{"text":"import org.apache.spark.sql.DataFrame\n\nimplicit class ZeppelinOutput(df:DataFrame) {\n    def toZeppelin(limit:Int = -1)  = {\n        println(\"%table\")\n        println(df.schema.map(_.name).mkString(\"\\t\"))\n        val data = if (limit <= 0) df else df.limit(limit)\n        data.collect.foreach(row => println(row.mkString(\"\\t\")))\n    }\n}","dateUpdated":"Jun 11, 2016 9:06:36 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465629193390_-1334189764","id":"20160611-071313_747693540","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql.DataFrame\ndefined class ZeppelinOutput\n"},"dateCreated":"Jun 11, 2016 7:13:13 AM","dateStarted":"Jun 11, 2016 9:06:36 AM","dateFinished":"Jun 11, 2016 9:06:37 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1424"},{"text":"%md\n# 1. Option A: Load Names into Hive\nWe have some name lists from US Census 1990 and US Census 2000. We simply put them into Hive for easy access.","dateUpdated":"Jun 11, 2016 9:02:57 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465629673954_792034470","id":"20160611-072113_1665991785","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>1. Option A: Load Names into Hive</h1>\n<p>We have some name lists from US Census 1990 and US Census 2000. We simply put them into Hive for easy access.</p>\n"},"dateCreated":"Jun 11, 2016 7:21:13 AM","dateStarted":"Jun 11, 2016 9:02:57 AM","dateFinished":"Jun 11, 2016 9:02:57 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1425"},{"text":"%sql\ncreate database if not exists training","dateUpdated":"Jun 11, 2016 7:14:07 AM","config":{"colWidth":12,"graph":{"mode":"table","height":94,"optionOpen":false,"keys":[{"name":"result","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"result","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465629233102_-1922208677","id":"20160611-071353_321679255","result":{"code":"SUCCESS","type":"TABLE","msg":"result\n","comment":"","msgTable":[],"columnNames":[{"name":"result","index":0,"aggr":"sum"}],"rows":[]},"dateCreated":"Jun 11, 2016 7:13:53 AM","dateStarted":"Jun 11, 2016 7:13:59 AM","dateFinished":"Jun 11, 2016 7:13:59 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1426"},{"text":"%sql\ncreate external table if not exists training.last_names(\n    name string,\n    rank int,\n    count int,\n    prop100k double,\n    cum_prop100k double,\n    pctwhite string,\n    pctblack string,\n    pctapi string,\n    pctaian string,\n    pct2prace string,\n    pcthispanic string\n)\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nSTORED AS TEXTFILE\nlocation 's3://is24-data-dev-spark-training/data/names/last_all_c2000'","dateUpdated":"Jun 11, 2016 7:15:06 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465629295175_846130823","id":"20160611-071455_851596766","dateCreated":"Jun 11, 2016 7:14:55 AM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1427"},{"text":"%sql\nselect * from training.last_names limit 10","dateUpdated":"Jun 11, 2016 9:05:31 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635736157_248625575","id":"20160611-090216_266483336","result":{"code":"SUCCESS","type":"TABLE","msg":"name\trank\tcount\tprop100k\tcum_prop100k\tpctwhite\tpctblack\tpctapi\tpctaian\tpct2prace\tpcthispanic\nname\tnull\tnull\tnull\tnull\tnull\tnull\tnull\tnull\tnull\tnull\nSMITH\t1\t2376206\t880.85\t880.85\t73.35\t22.22\t0.4\t0.85\t1.63\t1.56\nJOHNSON\t2\t1857160\t688.44\t1569.3\t61.55\t33.8\t0.42\t0.91\t1.82\t1.5\nWILLIAMS\t3\t1534042\t568.66\t2137.96\t48.52\t46.72\t0.37\t0.78\t2.01\t1.6\nBROWN\t4\t1380145\t511.62\t2649.58\t60.71\t34.54\t0.41\t0.83\t1.86\t1.64\nJONES\t5\t1362755\t505.17\t3154.75\t57.69\t37.73\t0.35\t0.94\t1.85\t1.44\nMILLER\t6\t1127803\t418.07\t3572.82\t85.81\t10.41\t0.42\t0.63\t1.31\t1.43\nDAVIS\t7\t1072335\t397.51\t3970.33\t64.73\t30.77\t0.4\t0.79\t1.73\t1.58\nGARCIA\t8\t858289\t318.17\t4288.5\t6.17\t0.49\t1.43\t0.58\t0.51\t90.81\nRODRIGUEZ\t9\t804240\t298.13\t4586.62\t5.52\t0.54\t0.58\t0.24\t0.41\t92.7\n","comment":"","msgTable":[[{"key":"rank","value":"name"},{"key":"rank","value":"null"},{"key":"rank","value":"null"},{"key":"rank","value":"null"},{"key":"rank","value":"null"},{"key":"rank","value":"null"},{"key":"rank","value":"null"},{"key":"rank","value":"null"},{"key":"rank","value":"null"},{"key":"rank","value":"null"},{"key":"rank","value":"null"}],[{"key":"count","value":"SMITH"},{"key":"count","value":"1"},{"key":"count","value":"2376206"},{"key":"count","value":"880.85"},{"key":"count","value":"880.85"},{"key":"count","value":"73.35"},{"key":"count","value":"22.22"},{"key":"count","value":"0.4"},{"key":"count","value":"0.85"},{"key":"count","value":"1.63"},{"key":"count","value":"1.56"}],[{"key":"prop100k","value":"JOHNSON"},{"key":"prop100k","value":"2"},{"key":"prop100k","value":"1857160"},{"key":"prop100k","value":"688.44"},{"key":"prop100k","value":"1569.3"},{"key":"prop100k","value":"61.55"},{"key":"prop100k","value":"33.8"},{"key":"prop100k","value":"0.42"},{"key":"prop100k","value":"0.91"},{"key":"prop100k","value":"1.82"},{"key":"prop100k","value":"1.5"}],[{"key":"cum_prop100k","value":"WILLIAMS"},{"key":"cum_prop100k","value":"3"},{"key":"cum_prop100k","value":"1534042"},{"key":"cum_prop100k","value":"568.66"},{"key":"cum_prop100k","value":"2137.96"},{"key":"cum_prop100k","value":"48.52"},{"key":"cum_prop100k","value":"46.72"},{"key":"cum_prop100k","value":"0.37"},{"key":"cum_prop100k","value":"0.78"},{"key":"cum_prop100k","value":"2.01"},{"key":"cum_prop100k","value":"1.6"}],[{"key":"pctwhite","value":"BROWN"},{"key":"pctwhite","value":"4"},{"key":"pctwhite","value":"1380145"},{"key":"pctwhite","value":"511.62"},{"key":"pctwhite","value":"2649.58"},{"key":"pctwhite","value":"60.71"},{"key":"pctwhite","value":"34.54"},{"key":"pctwhite","value":"0.41"},{"key":"pctwhite","value":"0.83"},{"key":"pctwhite","value":"1.86"},{"key":"pctwhite","value":"1.64"}],[{"key":"pctblack","value":"JONES"},{"key":"pctblack","value":"5"},{"key":"pctblack","value":"1362755"},{"key":"pctblack","value":"505.17"},{"key":"pctblack","value":"3154.75"},{"key":"pctblack","value":"57.69"},{"key":"pctblack","value":"37.73"},{"key":"pctblack","value":"0.35"},{"key":"pctblack","value":"0.94"},{"key":"pctblack","value":"1.85"},{"key":"pctblack","value":"1.44"}],[{"key":"pctapi","value":"MILLER"},{"key":"pctapi","value":"6"},{"key":"pctapi","value":"1127803"},{"key":"pctapi","value":"418.07"},{"key":"pctapi","value":"3572.82"},{"key":"pctapi","value":"85.81"},{"key":"pctapi","value":"10.41"},{"key":"pctapi","value":"0.42"},{"key":"pctapi","value":"0.63"},{"key":"pctapi","value":"1.31"},{"key":"pctapi","value":"1.43"}],[{"key":"pctaian","value":"DAVIS"},{"key":"pctaian","value":"7"},{"key":"pctaian","value":"1072335"},{"key":"pctaian","value":"397.51"},{"key":"pctaian","value":"3970.33"},{"key":"pctaian","value":"64.73"},{"key":"pctaian","value":"30.77"},{"key":"pctaian","value":"0.4"},{"key":"pctaian","value":"0.79"},{"key":"pctaian","value":"1.73"},{"key":"pctaian","value":"1.58"}],[{"key":"pct2prace","value":"GARCIA"},{"key":"pct2prace","value":"8"},{"key":"pct2prace","value":"858289"},{"key":"pct2prace","value":"318.17"},{"key":"pct2prace","value":"4288.5"},{"key":"pct2prace","value":"6.17"},{"key":"pct2prace","value":"0.49"},{"key":"pct2prace","value":"1.43"},{"key":"pct2prace","value":"0.58"},{"key":"pct2prace","value":"0.51"},{"key":"pct2prace","value":"90.81"}],[{"key":"pcthispanic","value":"RODRIGUEZ"},{"key":"pcthispanic","value":"9"},{"key":"pcthispanic","value":"804240"},{"key":"pcthispanic","value":"298.13"},{"key":"pcthispanic","value":"4586.62"},{"key":"pcthispanic","value":"5.52"},{"key":"pcthispanic","value":"0.54"},{"key":"pcthispanic","value":"0.58"},{"key":"pcthispanic","value":"0.24"},{"key":"pcthispanic","value":"0.41"},{"key":"pcthispanic","value":"92.7"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"rank","index":1,"aggr":"sum"},{"name":"count","index":2,"aggr":"sum"},{"name":"prop100k","index":3,"aggr":"sum"},{"name":"cum_prop100k","index":4,"aggr":"sum"},{"name":"pctwhite","index":5,"aggr":"sum"},{"name":"pctblack","index":6,"aggr":"sum"},{"name":"pctapi","index":7,"aggr":"sum"},{"name":"pctaian","index":8,"aggr":"sum"},{"name":"pct2prace","index":9,"aggr":"sum"},{"name":"pcthispanic","index":10,"aggr":"sum"}],"rows":[["name","null","null","null","null","null","null","null","null","null","null"],["SMITH","1","2376206","880.85","880.85","73.35","22.22","0.4","0.85","1.63","1.56"],["JOHNSON","2","1857160","688.44","1569.3","61.55","33.8","0.42","0.91","1.82","1.5"],["WILLIAMS","3","1534042","568.66","2137.96","48.52","46.72","0.37","0.78","2.01","1.6"],["BROWN","4","1380145","511.62","2649.58","60.71","34.54","0.41","0.83","1.86","1.64"],["JONES","5","1362755","505.17","3154.75","57.69","37.73","0.35","0.94","1.85","1.44"],["MILLER","6","1127803","418.07","3572.82","85.81","10.41","0.42","0.63","1.31","1.43"],["DAVIS","7","1072335","397.51","3970.33","64.73","30.77","0.4","0.79","1.73","1.58"],["GARCIA","8","858289","318.17","4288.5","6.17","0.49","1.43","0.58","0.51","90.81"],["RODRIGUEZ","9","804240","298.13","4586.62","5.52","0.54","0.58","0.24","0.41","92.7"]]},"dateCreated":"Jun 11, 2016 9:02:16 AM","dateStarted":"Jun 11, 2016 9:05:31 AM","dateFinished":"Jun 11, 2016 9:06:07 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1428"},{"text":"%sql\ncreate external table if not exists training.first_names_male(\n    name string,\n    prop double,\n    cum_prop double,\n    rank int\n)\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nSTORED AS TEXTFILE\nlocation 's3://is24-data-dev-spark-training/data/names/first_male_c1990'","dateUpdated":"Jun 11, 2016 7:14:32 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465629249584_1617511852","id":"20160611-071409_1031345079","dateCreated":"Jun 11, 2016 7:14:09 AM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1429"},{"text":"%sql\nselect * from training.first_names_male limit 10","dateUpdated":"Jun 11, 2016 9:02:57 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635757914_-476995527","id":"20160611-090237_874224002","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tprop\tcum_prop\trank\nJAMES\t3.318\t3.318\t1\nJOHN\t3.271\t6.589\t2\nROBERT\t3.143\t9.732\t3\nMICHAEL\t2.629\t12.361\t4\nWILLIAM\t2.451\t14.812\t5\nDAVID\t2.363\t17.176\t6\nRICHARD\t1.703\t18.878\t7\nCHARLES\t1.523\t20.401\t8\nJOSEPH\t1.404\t21.805\t9\nTHOMAS\t1.38\t23.185\t10\n","comment":"","msgTable":[[{"key":"prop","value":"JAMES"},{"key":"prop","value":"3.318"},{"key":"prop","value":"3.318"},{"key":"prop","value":"1"}],[{"key":"cum_prop","value":"JOHN"},{"key":"cum_prop","value":"3.271"},{"key":"cum_prop","value":"6.589"},{"key":"cum_prop","value":"2"}],[{"key":"rank","value":"ROBERT"},{"key":"rank","value":"3.143"},{"key":"rank","value":"9.732"},{"key":"rank","value":"3"}],[{"value":"MICHAEL"},{"value":"2.629"},{"value":"12.361"},{"value":"4"}],[{"value":"WILLIAM"},{"value":"2.451"},{"value":"14.812"},{"value":"5"}],[{"value":"DAVID"},{"value":"2.363"},{"value":"17.176"},{"value":"6"}],[{"value":"RICHARD"},{"value":"1.703"},{"value":"18.878"},{"value":"7"}],[{"value":"CHARLES"},{"value":"1.523"},{"value":"20.401"},{"value":"8"}],[{"value":"JOSEPH"},{"value":"1.404"},{"value":"21.805"},{"value":"9"}],[{"value":"THOMAS"},{"value":"1.38"},{"value":"23.185"},{"value":"10"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"prop","index":1,"aggr":"sum"},{"name":"cum_prop","index":2,"aggr":"sum"},{"name":"rank","index":3,"aggr":"sum"}],"rows":[["JAMES","3.318","3.318","1"],["JOHN","3.271","6.589","2"],["ROBERT","3.143","9.732","3"],["MICHAEL","2.629","12.361","4"],["WILLIAM","2.451","14.812","5"],["DAVID","2.363","17.176","6"],["RICHARD","1.703","18.878","7"],["CHARLES","1.523","20.401","8"],["JOSEPH","1.404","21.805","9"],["THOMAS","1.38","23.185","10"]]},"dateCreated":"Jun 11, 2016 9:02:37 AM","dateStarted":"Jun 11, 2016 9:02:57 AM","dateFinished":"Jun 11, 2016 9:02:58 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1430"},{"text":"%sql\ncreate external table if not exists training.first_names_female(\n    name string,\n    prop double,\n    cum_prop double,\n    rank int\n)\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY ','\nSTORED AS TEXTFILE\nlocation 's3://is24-data-dev-spark-training/data/names/first_female_c1990'","dateUpdated":"Jun 11, 2016 7:14:46 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465629265310_-1416987398","id":"20160611-071425_54663654","dateCreated":"Jun 11, 2016 7:14:25 AM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1431"},{"text":"%sql\nselect * from training.first_names_female limit 10","dateUpdated":"Jun 11, 2016 9:03:04 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635696963_1020554462","id":"20160611-090136_8285786","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tprop\tcum_prop\trank\nMARY\t2.629\t2.629\t1\nPATRICIA\t1.073\t3.702\t2\nLINDA\t1.035\t4.736\t3\nBARBARA\t0.98\t5.716\t4\nELIZABETH\t0.937\t6.653\t5\nJENNIFER\t0.932\t7.586\t6\nMARIA\t0.828\t8.414\t7\nSUSAN\t0.794\t9.209\t8\nMARGARET\t0.768\t9.976\t9\nDOROTHY\t0.727\t10.703\t10\n","comment":"","msgTable":[[{"key":"prop","value":"MARY"},{"key":"prop","value":"2.629"},{"key":"prop","value":"2.629"},{"key":"prop","value":"1"}],[{"key":"cum_prop","value":"PATRICIA"},{"key":"cum_prop","value":"1.073"},{"key":"cum_prop","value":"3.702"},{"key":"cum_prop","value":"2"}],[{"key":"rank","value":"LINDA"},{"key":"rank","value":"1.035"},{"key":"rank","value":"4.736"},{"key":"rank","value":"3"}],[{"value":"BARBARA"},{"value":"0.98"},{"value":"5.716"},{"value":"4"}],[{"value":"ELIZABETH"},{"value":"0.937"},{"value":"6.653"},{"value":"5"}],[{"value":"JENNIFER"},{"value":"0.932"},{"value":"7.586"},{"value":"6"}],[{"value":"MARIA"},{"value":"0.828"},{"value":"8.414"},{"value":"7"}],[{"value":"SUSAN"},{"value":"0.794"},{"value":"9.209"},{"value":"8"}],[{"value":"MARGARET"},{"value":"0.768"},{"value":"9.976"},{"value":"9"}],[{"value":"DOROTHY"},{"value":"0.727"},{"value":"10.703"},{"value":"10"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"prop","index":1,"aggr":"sum"},{"name":"cum_prop","index":2,"aggr":"sum"},{"name":"rank","index":3,"aggr":"sum"}],"rows":[["MARY","2.629","2.629","1"],["PATRICIA","1.073","3.702","2"],["LINDA","1.035","4.736","3"],["BARBARA","0.98","5.716","4"],["ELIZABETH","0.937","6.653","5"],["JENNIFER","0.932","7.586","6"],["MARIA","0.828","8.414","7"],["SUSAN","0.794","9.209","8"],["MARGARET","0.768","9.976","9"],["DOROTHY","0.727","10.703","10"]]},"dateCreated":"Jun 11, 2016 9:01:36 AM","dateStarted":"Jun 11, 2016 9:03:05 AM","dateFinished":"Jun 11, 2016 9:03:05 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1432"},{"text":"%md\n# 1. Option B: Load Data from Files\n\nProbably the more realistic way to load data in this specific case is to read it directly as a CSV file. Moreover we specifically added a dependency at the beginning, so we can use spark-csv to load CSV data without much hassle.","dateUpdated":"Jun 11, 2016 9:07:27 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635808055_163519447","id":"20160611-090328_1681519857","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>1. Option B: Load Data from Files</h1>\n<p>Probably the more realistic way to load data in this specific case is to read it directly as a CSV file. Moreover we specifically added a dependency at the beginning, so we can use spark-csv to load CSV data without much hassle.</p>\n"},"dateCreated":"Jun 11, 2016 9:03:28 AM","dateStarted":"Jun 11, 2016 9:07:24 AM","dateFinished":"Jun 11, 2016 9:07:24 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1433"},{"text":"import org.apache.spark.sql.types._\n\nval lastNamesSchema = StructType(Array(\n    StructField(\"name\", StringType, true),\n    StructField(\"rank\", IntegerType, true),\n    StructField(\"count\", IntegerType, true),\n    StructField(\"prop100k\", DoubleType, true),\n    StructField(\"cum_prop100k\", DoubleType, true),\n    StructField(\"pctwhite\", StringType, true),\n    StructField(\"pctblack\", StringType, true),\n    StructField(\"pctapi\", StringType, true),\n    StructField(\"pctaian\", StringType, true),\n    StructField(\"pct2prace\", StringType, true),\n    StructField(\"pcthispanic\", StringType, true)\n    ))\nval lastNames = sqlContext.read\n    .format(\"com.databricks.spark.csv\") \n    .option(\"header\", \"true\")  // Use first line of all files as header\n    .option(\"inferSchema\", \"true\") // Automatically infer data types\n    .load(\"s3://is24-data-dev-spark-training/data/names/last_all_c2000\")","dateUpdated":"Jun 11, 2016 9:06:19 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635826308_-1100750115","id":"20160611-090346_1660255795","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql.types._\nlastNamesSchema: org.apache.spark.sql.types.StructType = StructType(StructField(name,StringType,true), StructField(rank,IntegerType,true), StructField(count,IntegerType,true), StructField(prop100k,DoubleType,true), StructField(cum_prop100k,DoubleType,true), StructField(pctwhite,StringType,true), StructField(pctblack,StringType,true), StructField(pctapi,StringType,true), StructField(pctaian,StringType,true), StructField(pct2prace,StringType,true), StructField(pcthispanic,StringType,true))\nlastNames: org.apache.spark.sql.DataFrame = [name: string, rank: int, count: int, prop100k: double, cum_prop100k: double, pctwhite: string, pctblack: string, pctapi: string, pctaian: string, pct2prace: string, pcthispanic: string]\n"},"dateCreated":"Jun 11, 2016 9:03:46 AM","dateStarted":"Jun 11, 2016 9:06:19 AM","dateFinished":"Jun 11, 2016 9:06:24 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1434"},{"text":"lastNames.toZeppelin(10)","dateUpdated":"Jun 11, 2016 9:06:44 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635856261_-1651913043","id":"20160611-090416_1548897248","result":{"code":"SUCCESS","type":"TABLE","msg":"name\trank\tcount\tprop100k\tcum_prop100k\tpctwhite\tpctblack\tpctapi\tpctaian\tpct2prace\tpcthispanic\nSMITH\t1\t2376206\t880.85\t880.85\t73.35\t22.22\t0.40\t0.85\t1.63\t1.56\nJOHNSON\t2\t1857160\t688.44\t1569.3\t61.55\t33.80\t0.42\t0.91\t1.82\t1.50\nWILLIAMS\t3\t1534042\t568.66\t2137.96\t48.52\t46.72\t0.37\t0.78\t2.01\t1.60\nBROWN\t4\t1380145\t511.62\t2649.58\t60.71\t34.54\t0.41\t0.83\t1.86\t1.64\nJONES\t5\t1362755\t505.17\t3154.75\t57.69\t37.73\t0.35\t0.94\t1.85\t1.44\nMILLER\t6\t1127803\t418.07\t3572.82\t85.81\t10.41\t0.42\t0.63\t1.31\t1.43\nDAVIS\t7\t1072335\t397.51\t3970.33\t64.73\t30.77\t0.40\t0.79\t1.73\t1.58\nGARCIA\t8\t858289\t318.17\t4288.5\t6.17\t0.49\t1.43\t0.58\t0.51\t90.81\nRODRIGUEZ\t9\t804240\t298.13\t4586.62\t5.52\t0.54\t0.58\t0.24\t0.41\t92.70\nWILSON\t10\t783051\t290.27\t4876.9\t69.72\t25.32\t0.46\t1.03\t1.74\t1.73\n","comment":"","msgTable":[[{"key":"rank","value":"SMITH"},{"key":"rank","value":"1"},{"key":"rank","value":"2376206"},{"key":"rank","value":"880.85"},{"key":"rank","value":"880.85"},{"key":"rank","value":"73.35"},{"key":"rank","value":"22.22"},{"key":"rank","value":"0.40"},{"key":"rank","value":"0.85"},{"key":"rank","value":"1.63"},{"key":"rank","value":"1.56"}],[{"key":"count","value":"JOHNSON"},{"key":"count","value":"2"},{"key":"count","value":"1857160"},{"key":"count","value":"688.44"},{"key":"count","value":"1569.3"},{"key":"count","value":"61.55"},{"key":"count","value":"33.80"},{"key":"count","value":"0.42"},{"key":"count","value":"0.91"},{"key":"count","value":"1.82"},{"key":"count","value":"1.50"}],[{"key":"prop100k","value":"WILLIAMS"},{"key":"prop100k","value":"3"},{"key":"prop100k","value":"1534042"},{"key":"prop100k","value":"568.66"},{"key":"prop100k","value":"2137.96"},{"key":"prop100k","value":"48.52"},{"key":"prop100k","value":"46.72"},{"key":"prop100k","value":"0.37"},{"key":"prop100k","value":"0.78"},{"key":"prop100k","value":"2.01"},{"key":"prop100k","value":"1.60"}],[{"key":"cum_prop100k","value":"BROWN"},{"key":"cum_prop100k","value":"4"},{"key":"cum_prop100k","value":"1380145"},{"key":"cum_prop100k","value":"511.62"},{"key":"cum_prop100k","value":"2649.58"},{"key":"cum_prop100k","value":"60.71"},{"key":"cum_prop100k","value":"34.54"},{"key":"cum_prop100k","value":"0.41"},{"key":"cum_prop100k","value":"0.83"},{"key":"cum_prop100k","value":"1.86"},{"key":"cum_prop100k","value":"1.64"}],[{"key":"pctwhite","value":"JONES"},{"key":"pctwhite","value":"5"},{"key":"pctwhite","value":"1362755"},{"key":"pctwhite","value":"505.17"},{"key":"pctwhite","value":"3154.75"},{"key":"pctwhite","value":"57.69"},{"key":"pctwhite","value":"37.73"},{"key":"pctwhite","value":"0.35"},{"key":"pctwhite","value":"0.94"},{"key":"pctwhite","value":"1.85"},{"key":"pctwhite","value":"1.44"}],[{"key":"pctblack","value":"MILLER"},{"key":"pctblack","value":"6"},{"key":"pctblack","value":"1127803"},{"key":"pctblack","value":"418.07"},{"key":"pctblack","value":"3572.82"},{"key":"pctblack","value":"85.81"},{"key":"pctblack","value":"10.41"},{"key":"pctblack","value":"0.42"},{"key":"pctblack","value":"0.63"},{"key":"pctblack","value":"1.31"},{"key":"pctblack","value":"1.43"}],[{"key":"pctapi","value":"DAVIS"},{"key":"pctapi","value":"7"},{"key":"pctapi","value":"1072335"},{"key":"pctapi","value":"397.51"},{"key":"pctapi","value":"3970.33"},{"key":"pctapi","value":"64.73"},{"key":"pctapi","value":"30.77"},{"key":"pctapi","value":"0.40"},{"key":"pctapi","value":"0.79"},{"key":"pctapi","value":"1.73"},{"key":"pctapi","value":"1.58"}],[{"key":"pctaian","value":"GARCIA"},{"key":"pctaian","value":"8"},{"key":"pctaian","value":"858289"},{"key":"pctaian","value":"318.17"},{"key":"pctaian","value":"4288.5"},{"key":"pctaian","value":"6.17"},{"key":"pctaian","value":"0.49"},{"key":"pctaian","value":"1.43"},{"key":"pctaian","value":"0.58"},{"key":"pctaian","value":"0.51"},{"key":"pctaian","value":"90.81"}],[{"key":"pct2prace","value":"RODRIGUEZ"},{"key":"pct2prace","value":"9"},{"key":"pct2prace","value":"804240"},{"key":"pct2prace","value":"298.13"},{"key":"pct2prace","value":"4586.62"},{"key":"pct2prace","value":"5.52"},{"key":"pct2prace","value":"0.54"},{"key":"pct2prace","value":"0.58"},{"key":"pct2prace","value":"0.24"},{"key":"pct2prace","value":"0.41"},{"key":"pct2prace","value":"92.70"}],[{"key":"pcthispanic","value":"WILSON"},{"key":"pcthispanic","value":"10"},{"key":"pcthispanic","value":"783051"},{"key":"pcthispanic","value":"290.27"},{"key":"pcthispanic","value":"4876.9"},{"key":"pcthispanic","value":"69.72"},{"key":"pcthispanic","value":"25.32"},{"key":"pcthispanic","value":"0.46"},{"key":"pcthispanic","value":"1.03"},{"key":"pcthispanic","value":"1.74"},{"key":"pcthispanic","value":"1.73"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"rank","index":1,"aggr":"sum"},{"name":"count","index":2,"aggr":"sum"},{"name":"prop100k","index":3,"aggr":"sum"},{"name":"cum_prop100k","index":4,"aggr":"sum"},{"name":"pctwhite","index":5,"aggr":"sum"},{"name":"pctblack","index":6,"aggr":"sum"},{"name":"pctapi","index":7,"aggr":"sum"},{"name":"pctaian","index":8,"aggr":"sum"},{"name":"pct2prace","index":9,"aggr":"sum"},{"name":"pcthispanic","index":10,"aggr":"sum"}],"rows":[["SMITH","1","2376206","880.85","880.85","73.35","22.22","0.40","0.85","1.63","1.56"],["JOHNSON","2","1857160","688.44","1569.3","61.55","33.80","0.42","0.91","1.82","1.50"],["WILLIAMS","3","1534042","568.66","2137.96","48.52","46.72","0.37","0.78","2.01","1.60"],["BROWN","4","1380145","511.62","2649.58","60.71","34.54","0.41","0.83","1.86","1.64"],["JONES","5","1362755","505.17","3154.75","57.69","37.73","0.35","0.94","1.85","1.44"],["MILLER","6","1127803","418.07","3572.82","85.81","10.41","0.42","0.63","1.31","1.43"],["DAVIS","7","1072335","397.51","3970.33","64.73","30.77","0.40","0.79","1.73","1.58"],["GARCIA","8","858289","318.17","4288.5","6.17","0.49","1.43","0.58","0.51","90.81"],["RODRIGUEZ","9","804240","298.13","4586.62","5.52","0.54","0.58","0.24","0.41","92.70"],["WILSON","10","783051","290.27","4876.9","69.72","25.32","0.46","1.03","1.74","1.73"]]},"dateCreated":"Jun 11, 2016 9:04:16 AM","dateStarted":"Jun 11, 2016 9:06:44 AM","dateFinished":"Jun 11, 2016 9:06:45 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1435"},{"text":"val firstNamesSchema = StructType(Array(\n    StructField(\"name\", StringType, true),\n    StructField(\"prop\", DoubleType, true),\n    StructField(\"cum_pro\", DoubleType, true),\n    StructField(\"rank\", IntegerType, true)\n    ))\nval firstNamesMale = sqlContext.read\n    .format(\"com.databricks.spark.csv\") \n    .option(\"header\", \"false\")\n    .schema(firstNamesSchema)\n    .load(\"s3://is24-data-dev-spark-training/data/names/first_male_c1990\")\nval firstNamesFemale = sqlContext.read\n    .format(\"com.databricks.spark.csv\") \n    .option(\"header\", \"false\")\n    .schema(firstNamesSchema)\n    .load(\"s3://is24-data-dev-spark-training/data/names/first_female_c1990\")    ","dateUpdated":"Jun 11, 2016 9:06:51 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635842800_190649440","id":"20160611-090402_2075590603","result":{"code":"SUCCESS","type":"TEXT","msg":"firstNamesSchema: org.apache.spark.sql.types.StructType = StructType(StructField(name,StringType,true), StructField(prop,DoubleType,true), StructField(cum_pro,DoubleType,true), StructField(rank,IntegerType,true))\nfirstNamesMale: org.apache.spark.sql.DataFrame = [name: string, prop: double, cum_pro: double, rank: int]\nfirstNamesFemale: org.apache.spark.sql.DataFrame = [name: string, prop: double, cum_pro: double, rank: int]\n"},"dateCreated":"Jun 11, 2016 9:04:02 AM","dateStarted":"Jun 11, 2016 9:06:51 AM","dateFinished":"Jun 11, 2016 9:06:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1436"},{"text":"firstNamesMale.toZeppelin(10)","dateUpdated":"Jun 11, 2016 9:06:54 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635870075_-37476010","id":"20160611-090430_130374012","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tprop\tcum_pro\trank\nJAMES\t3.318\t3.318\t1\nJOHN\t3.271\t6.589\t2\nROBERT\t3.143\t9.732\t3\nMICHAEL\t2.629\t12.361\t4\nWILLIAM\t2.451\t14.812\t5\nDAVID\t2.363\t17.176\t6\nRICHARD\t1.703\t18.878\t7\nCHARLES\t1.523\t20.401\t8\nJOSEPH\t1.404\t21.805\t9\nTHOMAS\t1.38\t23.185\t10\n","comment":"","msgTable":[[{"key":"prop","value":"JAMES"},{"key":"prop","value":"3.318"},{"key":"prop","value":"3.318"},{"key":"prop","value":"1"}],[{"key":"cum_pro","value":"JOHN"},{"key":"cum_pro","value":"3.271"},{"key":"cum_pro","value":"6.589"},{"key":"cum_pro","value":"2"}],[{"key":"rank","value":"ROBERT"},{"key":"rank","value":"3.143"},{"key":"rank","value":"9.732"},{"key":"rank","value":"3"}],[{"value":"MICHAEL"},{"value":"2.629"},{"value":"12.361"},{"value":"4"}],[{"value":"WILLIAM"},{"value":"2.451"},{"value":"14.812"},{"value":"5"}],[{"value":"DAVID"},{"value":"2.363"},{"value":"17.176"},{"value":"6"}],[{"value":"RICHARD"},{"value":"1.703"},{"value":"18.878"},{"value":"7"}],[{"value":"CHARLES"},{"value":"1.523"},{"value":"20.401"},{"value":"8"}],[{"value":"JOSEPH"},{"value":"1.404"},{"value":"21.805"},{"value":"9"}],[{"value":"THOMAS"},{"value":"1.38"},{"value":"23.185"},{"value":"10"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"prop","index":1,"aggr":"sum"},{"name":"cum_pro","index":2,"aggr":"sum"},{"name":"rank","index":3,"aggr":"sum"}],"rows":[["JAMES","3.318","3.318","1"],["JOHN","3.271","6.589","2"],["ROBERT","3.143","9.732","3"],["MICHAEL","2.629","12.361","4"],["WILLIAM","2.451","14.812","5"],["DAVID","2.363","17.176","6"],["RICHARD","1.703","18.878","7"],["CHARLES","1.523","20.401","8"],["JOSEPH","1.404","21.805","9"],["THOMAS","1.38","23.185","10"]]},"dateCreated":"Jun 11, 2016 9:04:30 AM","dateStarted":"Jun 11, 2016 9:06:54 AM","dateFinished":"Jun 11, 2016 9:06:55 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1437"},{"text":"%md\n# 2. Create Distribution for various Parameters\n\nNow we need to have some nice random distributions for three different use cases:\n\n* Number of CDKs per user\n* Number of Sessions per user\n* Number of CDKs used per session\n\nWe will use a lognormal distribution for that","dateUpdated":"Jun 11, 2016 7:22:07 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465590114691_-830020781","id":"20160610-202154_549406477","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>2. Create Distribution for various Parameters</h1>\n<p>Now we need to have some nice random distributions for three different use cases:</p>\n<ul>\n<li>Number of CDKs per user</li>\n<li>Number of Sessions per user</li>\n<li>Number of CDKs used per session</li>\n</ul>\n<p>We will use a lognormal distribution for that</p>\n"},"dateCreated":"Jun 10, 2016 8:21:54 PM","dateStarted":"Jun 11, 2016 7:22:04 AM","dateFinished":"Jun 11, 2016 7:22:04 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1438"},{"text":"%md\n## Lognormal Distribution\n\nThe following definition provides us with a lognormal distribution.","dateUpdated":"Jun 11, 2016 7:17:04 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465629387304_223930555","id":"20160611-071627_398009319","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Lognormal Distribution</h2>\n<p>The following definition provides us with a lognormal distribution.</p>\n"},"dateCreated":"Jun 11, 2016 7:16:27 AM","dateStarted":"Jun 11, 2016 7:17:02 AM","dateFinished":"Jun 11, 2016 7:17:02 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1439"},{"text":"val lognormal = sqlContext.udf.register(\"lognormal\", (a:Double) => scala.math.exp(a*scala.util.Random.nextGaussian()) )","dateUpdated":"Jun 11, 2016 8:36:39 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465629426772_-454889098","id":"20160611-071706_949405453","result":{"code":"SUCCESS","type":"TEXT","msg":"lognormal: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function1>,DoubleType,List(DoubleType))\n"},"dateCreated":"Jun 11, 2016 7:17:06 AM","dateStarted":"Jun 11, 2016 8:36:39 AM","dateFinished":"Jun 11, 2016 8:37:05 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1440"},{"text":"%md\n## Number of CDKs per User","dateUpdated":"Jun 11, 2016 7:17:35 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465629437168_1514655846","id":"20160611-071717_1832632178","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Number of CDKs per User</h2>\n"},"dateCreated":"Jun 11, 2016 7:17:17 AM","dateStarted":"Jun 11, 2016 7:17:32 AM","dateFinished":"Jun 11, 2016 7:17:32 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1441"},{"text":"import org.apache.spark.sql.Row\nimport org.apache.spark.sql.types._\n\nval src = sqlContext.createDataFrame(sc.parallelize(1 to 100000, 100).map(x => Row(x)), StructType(StructField(\"index\",IntegerType,false) :: Nil))\n\nsrc.select((lit(14.0)*lognormal(lit(0.3))) cast IntegerType  as \"count\")\n   .select(when($\"count\" < lit(200),$\"count\") otherwise lit(200) as \"count\" )\n   .groupBy($\"count\").count().toZeppelin()","dateUpdated":"Jun 11, 2016 8:36:43 AM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"count","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"count","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465497970917_-907396358","id":"20160609-184610_1177338345","result":{"code":"SUCCESS","type":"TABLE","msg":"count\tcount\n31\t111\n32\t82\n33\t49\n34\t36\n35\t34\n36\t22\n37\t16\n38\t11\n39\t7\n40\t8\n41\t7\n42\t3\n43\t4\n44\t1\n45\t2\n46\t2\n3\t3\n4\t27\n5\t219\n6\t802\n7\t2107\n8\t3878\n9\t6109\n10\t8083\n11\t9248\n12\t9985\n13\t9768\n14\t9065\n15\t8104\n16\t6887\n17\t5696\n18\t4741\n19\t3658\n20\t2806\n21\t2194\n22\t1669\n23\t1324\n24\t978\n25\t709\n26\t533\n27\t391\n28\t277\n29\t196\n30\t148\n","comment":"","msgTable":[[{"key":"count","value":"31"},{"key":"count","value":"111"}],[{"value":"32"},{"value":"82"}],[{"value":"33"},{"value":"49"}],[{"value":"34"},{"value":"36"}],[{"value":"35"},{"value":"34"}],[{"value":"36"},{"value":"22"}],[{"value":"37"},{"value":"16"}],[{"value":"38"},{"value":"11"}],[{"value":"39"},{"value":"7"}],[{"value":"40"},{"value":"8"}],[{"value":"41"},{"value":"7"}],[{"value":"42"},{"value":"3"}],[{"value":"43"},{"value":"4"}],[{"value":"44"},{"value":"1"}],[{"value":"45"},{"value":"2"}],[{"value":"46"},{"value":"2"}],[{"value":"3"},{"value":"3"}],[{"value":"4"},{"value":"27"}],[{"value":"5"},{"value":"219"}],[{"value":"6"},{"value":"802"}],[{"value":"7"},{"value":"2107"}],[{"value":"8"},{"value":"3878"}],[{"value":"9"},{"value":"6109"}],[{"value":"10"},{"value":"8083"}],[{"value":"11"},{"value":"9248"}],[{"value":"12"},{"value":"9985"}],[{"value":"13"},{"value":"9768"}],[{"value":"14"},{"value":"9065"}],[{"value":"15"},{"value":"8104"}],[{"value":"16"},{"value":"6887"}],[{"value":"17"},{"value":"5696"}],[{"value":"18"},{"value":"4741"}],[{"value":"19"},{"value":"3658"}],[{"value":"20"},{"value":"2806"}],[{"value":"21"},{"value":"2194"}],[{"value":"22"},{"value":"1669"}],[{"value":"23"},{"value":"1324"}],[{"value":"24"},{"value":"978"}],[{"value":"25"},{"value":"709"}],[{"value":"26"},{"value":"533"}],[{"value":"27"},{"value":"391"}],[{"value":"28"},{"value":"277"}],[{"value":"29"},{"value":"196"}],[{"value":"30"},{"value":"148"}]],"columnNames":[{"name":"count","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["31","111"],["32","82"],["33","49"],["34","36"],["35","34"],["36","22"],["37","16"],["38","11"],["39","7"],["40","8"],["41","7"],["42","3"],["43","4"],["44","1"],["45","2"],["46","2"],["3","3"],["4","27"],["5","219"],["6","802"],["7","2107"],["8","3878"],["9","6109"],["10","8083"],["11","9248"],["12","9985"],["13","9768"],["14","9065"],["15","8104"],["16","6887"],["17","5696"],["18","4741"],["19","3658"],["20","2806"],["21","2194"],["22","1669"],["23","1324"],["24","978"],["25","709"],["26","533"],["27","391"],["28","277"],["29","196"],["30","148"]]},"dateCreated":"Jun 9, 2016 6:46:10 PM","dateStarted":"Jun 11, 2016 8:37:04 AM","dateFinished":"Jun 11, 2016 8:37:41 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1442"},{"text":"%md\n# Create Distribution for Number of Sessions","dateUpdated":"Jun 10, 2016 8:22:48 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465590135689_-1463686896","id":"20160610-202215_1185091312","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Create Distribution for Number of Sessions</h1>\n"},"dateCreated":"Jun 10, 2016 8:22:15 PM","dateStarted":"Jun 10, 2016 8:22:44 PM","dateFinished":"Jun 10, 2016 8:22:44 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1443"},{"text":"val src = sqlContext.createDataFrame(sc.parallelize(1 to 100000, 100).map(x => Row(x)), StructType(StructField(\"index\",IntegerType,false) :: Nil))\n\nsrc.select((lit(50.0)*lognormal(lit(0.4))) cast IntegerType  as \"count\")\n   .select(when($\"count\" < lit(2000),$\"count\") otherwise lit(2000) as \"count\" )\n   .groupBy($\"count\").count().toZeppelin()","dateUpdated":"Jun 11, 2016 8:37:46 AM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"count","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"count","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465588927369_-775701144","id":"20160610-200207_1931802005","result":{"code":"SUCCESS","type":"TABLE","msg":"count\tcount\n31\t1665\n32\t1778\n33\t1783\n233\t1\n34\t1875\n35\t1911\n36\t2062\n236\t1\n37\t2060\n38\t2072\n238\t1\n39\t2101\n40\t2165\n41\t2122\n42\t2135\n43\t2182\n243\t1\n44\t2189\n244\t1\n45\t2178\n46\t2121\n47\t2095\n48\t2015\n248\t1\n49\t2018\n50\t2016\n51\t1944\n52\t1940\n53\t1869\n54\t1759\n55\t1727\n56\t1674\n57\t1632\n257\t1\n58\t1565\n59\t1590\n60\t1446\n260\t1\n61\t1393\n62\t1360\n63\t1249\n64\t1277\n65\t1235\n66\t1124\n67\t1101\n68\t1089\n69\t1065\n70\t937\n71\t959\n72\t877\n73\t820\n74\t794\n75\t724\n76\t747\n77\t716\n78\t678\n79\t677\n80\t600\n81\t572\n82\t543\n83\t531\n283\t1\n84\t469\n85\t500\n86\t437\n87\t413\n88\t381\n89\t353\n90\t376\n91\t306\n92\t326\n93\t294\n94\t294\n95\t250\n96\t277\n97\t265\n98\t241\n99\t213\n100\t215\n101\t215\n102\t178\n103\t204\n104\t185\n105\t160\n106\t149\n107\t146\n108\t139\n109\t127\n110\t114\n111\t123\n112\t108\n113\t104\n114\t83\n115\t97\n116\t90\n117\t75\n118\t68\n119\t81\n120\t58\n121\t82\n122\t53\n123\t56\n124\t62\n125\t52\n126\t49\n127\t47\n128\t48\n129\t53\n130\t42\n131\t48\n132\t38\n133\t44\n134\t35\n135\t38\n136\t36\n137\t32\n138\t37\n139\t23\n140\t32\n141\t27\n142\t22\n143\t17\n144\t19\n145\t22\n146\t20\n147\t16\n148\t16\n149\t10\n150\t13\n151\t18\n152\t16\n153\t20\n154\t17\n155\t5\n156\t8\n157\t5\n158\t11\n159\t12\n160\t8\n161\t7\n162\t11\n163\t8\n164\t9\n165\t5\n166\t7\n167\t1\n168\t13\n169\t4\n170\t5\n171\t8\n172\t8\n173\t5\n174\t6\n175\t3\n176\t7\n177\t1\n178\t5\n179\t4\n180\t10\n181\t3\n182\t2\n183\t5\n184\t1\n185\t5\n186\t1\n187\t3\n189\t1\n190\t2\n191\t5\n192\t3\n193\t4\n194\t1\n195\t1\n196\t2\n197\t2\n198\t2\n199\t2\n200\t1\n201\t1\n202\t1\n207\t1\n208\t1\n9\t1\n10\t6\n11\t12\n12\t23\n213\t1\n13\t50\n14\t58\n15\t84\n215\t1\n16\t128\n17\t182\n217\t1\n18\t241\n218\t2\n19\t359\n20\t430\n220\t1\n21\t498\n22\t623\n23\t712\n24\t867\n224\t1\n25\t954\n26\t1064\n27\t1168\n227\t1\n28\t1324\n29\t1436\n30\t1506\n","comment":"","msgTable":[[{"key":"count","value":"31"},{"key":"count","value":"1665"}],[{"value":"32"},{"value":"1778"}],[{"value":"33"},{"value":"1783"}],[{"value":"233"},{"value":"1"}],[{"value":"34"},{"value":"1875"}],[{"value":"35"},{"value":"1911"}],[{"value":"36"},{"value":"2062"}],[{"value":"236"},{"value":"1"}],[{"value":"37"},{"value":"2060"}],[{"value":"38"},{"value":"2072"}],[{"value":"238"},{"value":"1"}],[{"value":"39"},{"value":"2101"}],[{"value":"40"},{"value":"2165"}],[{"value":"41"},{"value":"2122"}],[{"value":"42"},{"value":"2135"}],[{"value":"43"},{"value":"2182"}],[{"value":"243"},{"value":"1"}],[{"value":"44"},{"value":"2189"}],[{"value":"244"},{"value":"1"}],[{"value":"45"},{"value":"2178"}],[{"value":"46"},{"value":"2121"}],[{"value":"47"},{"value":"2095"}],[{"value":"48"},{"value":"2015"}],[{"value":"248"},{"value":"1"}],[{"value":"49"},{"value":"2018"}],[{"value":"50"},{"value":"2016"}],[{"value":"51"},{"value":"1944"}],[{"value":"52"},{"value":"1940"}],[{"value":"53"},{"value":"1869"}],[{"value":"54"},{"value":"1759"}],[{"value":"55"},{"value":"1727"}],[{"value":"56"},{"value":"1674"}],[{"value":"57"},{"value":"1632"}],[{"value":"257"},{"value":"1"}],[{"value":"58"},{"value":"1565"}],[{"value":"59"},{"value":"1590"}],[{"value":"60"},{"value":"1446"}],[{"value":"260"},{"value":"1"}],[{"value":"61"},{"value":"1393"}],[{"value":"62"},{"value":"1360"}],[{"value":"63"},{"value":"1249"}],[{"value":"64"},{"value":"1277"}],[{"value":"65"},{"value":"1235"}],[{"value":"66"},{"value":"1124"}],[{"value":"67"},{"value":"1101"}],[{"value":"68"},{"value":"1089"}],[{"value":"69"},{"value":"1065"}],[{"value":"70"},{"value":"937"}],[{"value":"71"},{"value":"959"}],[{"value":"72"},{"value":"877"}],[{"value":"73"},{"value":"820"}],[{"value":"74"},{"value":"794"}],[{"value":"75"},{"value":"724"}],[{"value":"76"},{"value":"747"}],[{"value":"77"},{"value":"716"}],[{"value":"78"},{"value":"678"}],[{"value":"79"},{"value":"677"}],[{"value":"80"},{"value":"600"}],[{"value":"81"},{"value":"572"}],[{"value":"82"},{"value":"543"}],[{"value":"83"},{"value":"531"}],[{"value":"283"},{"value":"1"}],[{"value":"84"},{"value":"469"}],[{"value":"85"},{"value":"500"}],[{"value":"86"},{"value":"437"}],[{"value":"87"},{"value":"413"}],[{"value":"88"},{"value":"381"}],[{"value":"89"},{"value":"353"}],[{"value":"90"},{"value":"376"}],[{"value":"91"},{"value":"306"}],[{"value":"92"},{"value":"326"}],[{"value":"93"},{"value":"294"}],[{"value":"94"},{"value":"294"}],[{"value":"95"},{"value":"250"}],[{"value":"96"},{"value":"277"}],[{"value":"97"},{"value":"265"}],[{"value":"98"},{"value":"241"}],[{"value":"99"},{"value":"213"}],[{"value":"100"},{"value":"215"}],[{"value":"101"},{"value":"215"}],[{"value":"102"},{"value":"178"}],[{"value":"103"},{"value":"204"}],[{"value":"104"},{"value":"185"}],[{"value":"105"},{"value":"160"}],[{"value":"106"},{"value":"149"}],[{"value":"107"},{"value":"146"}],[{"value":"108"},{"value":"139"}],[{"value":"109"},{"value":"127"}],[{"value":"110"},{"value":"114"}],[{"value":"111"},{"value":"123"}],[{"value":"112"},{"value":"108"}],[{"value":"113"},{"value":"104"}],[{"value":"114"},{"value":"83"}],[{"value":"115"},{"value":"97"}],[{"value":"116"},{"value":"90"}],[{"value":"117"},{"value":"75"}],[{"value":"118"},{"value":"68"}],[{"value":"119"},{"value":"81"}],[{"value":"120"},{"value":"58"}],[{"value":"121"},{"value":"82"}],[{"value":"122"},{"value":"53"}],[{"value":"123"},{"value":"56"}],[{"value":"124"},{"value":"62"}],[{"value":"125"},{"value":"52"}],[{"value":"126"},{"value":"49"}],[{"value":"127"},{"value":"47"}],[{"value":"128"},{"value":"48"}],[{"value":"129"},{"value":"53"}],[{"value":"130"},{"value":"42"}],[{"value":"131"},{"value":"48"}],[{"value":"132"},{"value":"38"}],[{"value":"133"},{"value":"44"}],[{"value":"134"},{"value":"35"}],[{"value":"135"},{"value":"38"}],[{"value":"136"},{"value":"36"}],[{"value":"137"},{"value":"32"}],[{"value":"138"},{"value":"37"}],[{"value":"139"},{"value":"23"}],[{"value":"140"},{"value":"32"}],[{"value":"141"},{"value":"27"}],[{"value":"142"},{"value":"22"}],[{"value":"143"},{"value":"17"}],[{"value":"144"},{"value":"19"}],[{"value":"145"},{"value":"22"}],[{"value":"146"},{"value":"20"}],[{"value":"147"},{"value":"16"}],[{"value":"148"},{"value":"16"}],[{"value":"149"},{"value":"10"}],[{"value":"150"},{"value":"13"}],[{"value":"151"},{"value":"18"}],[{"value":"152"},{"value":"16"}],[{"value":"153"},{"value":"20"}],[{"value":"154"},{"value":"17"}],[{"value":"155"},{"value":"5"}],[{"value":"156"},{"value":"8"}],[{"value":"157"},{"value":"5"}],[{"value":"158"},{"value":"11"}],[{"value":"159"},{"value":"12"}],[{"value":"160"},{"value":"8"}],[{"value":"161"},{"value":"7"}],[{"value":"162"},{"value":"11"}],[{"value":"163"},{"value":"8"}],[{"value":"164"},{"value":"9"}],[{"value":"165"},{"value":"5"}],[{"value":"166"},{"value":"7"}],[{"value":"167"},{"value":"1"}],[{"value":"168"},{"value":"13"}],[{"value":"169"},{"value":"4"}],[{"value":"170"},{"value":"5"}],[{"value":"171"},{"value":"8"}],[{"value":"172"},{"value":"8"}],[{"value":"173"},{"value":"5"}],[{"value":"174"},{"value":"6"}],[{"value":"175"},{"value":"3"}],[{"value":"176"},{"value":"7"}],[{"value":"177"},{"value":"1"}],[{"value":"178"},{"value":"5"}],[{"value":"179"},{"value":"4"}],[{"value":"180"},{"value":"10"}],[{"value":"181"},{"value":"3"}],[{"value":"182"},{"value":"2"}],[{"value":"183"},{"value":"5"}],[{"value":"184"},{"value":"1"}],[{"value":"185"},{"value":"5"}],[{"value":"186"},{"value":"1"}],[{"value":"187"},{"value":"3"}],[{"value":"189"},{"value":"1"}],[{"value":"190"},{"value":"2"}],[{"value":"191"},{"value":"5"}],[{"value":"192"},{"value":"3"}],[{"value":"193"},{"value":"4"}],[{"value":"194"},{"value":"1"}],[{"value":"195"},{"value":"1"}],[{"value":"196"},{"value":"2"}],[{"value":"197"},{"value":"2"}],[{"value":"198"},{"value":"2"}],[{"value":"199"},{"value":"2"}],[{"value":"200"},{"value":"1"}],[{"value":"201"},{"value":"1"}],[{"value":"202"},{"value":"1"}],[{"value":"207"},{"value":"1"}],[{"value":"208"},{"value":"1"}],[{"value":"9"},{"value":"1"}],[{"value":"10"},{"value":"6"}],[{"value":"11"},{"value":"12"}],[{"value":"12"},{"value":"23"}],[{"value":"213"},{"value":"1"}],[{"value":"13"},{"value":"50"}],[{"value":"14"},{"value":"58"}],[{"value":"15"},{"value":"84"}],[{"value":"215"},{"value":"1"}],[{"value":"16"},{"value":"128"}],[{"value":"17"},{"value":"182"}],[{"value":"217"},{"value":"1"}],[{"value":"18"},{"value":"241"}],[{"value":"218"},{"value":"2"}],[{"value":"19"},{"value":"359"}],[{"value":"20"},{"value":"430"}],[{"value":"220"},{"value":"1"}],[{"value":"21"},{"value":"498"}],[{"value":"22"},{"value":"623"}],[{"value":"23"},{"value":"712"}],[{"value":"24"},{"value":"867"}],[{"value":"224"},{"value":"1"}],[{"value":"25"},{"value":"954"}],[{"value":"26"},{"value":"1064"}],[{"value":"27"},{"value":"1168"}],[{"value":"227"},{"value":"1"}],[{"value":"28"},{"value":"1324"}],[{"value":"29"},{"value":"1436"}],[{"value":"30"},{"value":"1506"}]],"columnNames":[{"name":"count","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["31","1665"],["32","1778"],["33","1783"],["233","1"],["34","1875"],["35","1911"],["36","2062"],["236","1"],["37","2060"],["38","2072"],["238","1"],["39","2101"],["40","2165"],["41","2122"],["42","2135"],["43","2182"],["243","1"],["44","2189"],["244","1"],["45","2178"],["46","2121"],["47","2095"],["48","2015"],["248","1"],["49","2018"],["50","2016"],["51","1944"],["52","1940"],["53","1869"],["54","1759"],["55","1727"],["56","1674"],["57","1632"],["257","1"],["58","1565"],["59","1590"],["60","1446"],["260","1"],["61","1393"],["62","1360"],["63","1249"],["64","1277"],["65","1235"],["66","1124"],["67","1101"],["68","1089"],["69","1065"],["70","937"],["71","959"],["72","877"],["73","820"],["74","794"],["75","724"],["76","747"],["77","716"],["78","678"],["79","677"],["80","600"],["81","572"],["82","543"],["83","531"],["283","1"],["84","469"],["85","500"],["86","437"],["87","413"],["88","381"],["89","353"],["90","376"],["91","306"],["92","326"],["93","294"],["94","294"],["95","250"],["96","277"],["97","265"],["98","241"],["99","213"],["100","215"],["101","215"],["102","178"],["103","204"],["104","185"],["105","160"],["106","149"],["107","146"],["108","139"],["109","127"],["110","114"],["111","123"],["112","108"],["113","104"],["114","83"],["115","97"],["116","90"],["117","75"],["118","68"],["119","81"],["120","58"],["121","82"],["122","53"],["123","56"],["124","62"],["125","52"],["126","49"],["127","47"],["128","48"],["129","53"],["130","42"],["131","48"],["132","38"],["133","44"],["134","35"],["135","38"],["136","36"],["137","32"],["138","37"],["139","23"],["140","32"],["141","27"],["142","22"],["143","17"],["144","19"],["145","22"],["146","20"],["147","16"],["148","16"],["149","10"],["150","13"],["151","18"],["152","16"],["153","20"],["154","17"],["155","5"],["156","8"],["157","5"],["158","11"],["159","12"],["160","8"],["161","7"],["162","11"],["163","8"],["164","9"],["165","5"],["166","7"],["167","1"],["168","13"],["169","4"],["170","5"],["171","8"],["172","8"],["173","5"],["174","6"],["175","3"],["176","7"],["177","1"],["178","5"],["179","4"],["180","10"],["181","3"],["182","2"],["183","5"],["184","1"],["185","5"],["186","1"],["187","3"],["189","1"],["190","2"],["191","5"],["192","3"],["193","4"],["194","1"],["195","1"],["196","2"],["197","2"],["198","2"],["199","2"],["200","1"],["201","1"],["202","1"],["207","1"],["208","1"],["9","1"],["10","6"],["11","12"],["12","23"],["213","1"],["13","50"],["14","58"],["15","84"],["215","1"],["16","128"],["17","182"],["217","1"],["18","241"],["218","2"],["19","359"],["20","430"],["220","1"],["21","498"],["22","623"],["23","712"],["24","867"],["224","1"],["25","954"],["26","1064"],["27","1168"],["227","1"],["28","1324"],["29","1436"],["30","1506"]]},"dateCreated":"Jun 10, 2016 8:02:07 PM","dateStarted":"Jun 11, 2016 8:37:47 AM","dateFinished":"Jun 11, 2016 8:37:58 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1444"},{"text":"%md\n# Create Distribution of Number of CDK per Session","dateUpdated":"Jun 10, 2016 8:36:38 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465590187172_-1536496383","id":"20160610-202307_2101754016","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Create Distribution of Number of CDK per Session</h1>\n"},"dateCreated":"Jun 10, 2016 8:23:07 PM","dateStarted":"Jun 10, 2016 8:36:34 PM","dateFinished":"Jun 10, 2016 8:36:34 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1445"},{"text":"val src = sqlContext.createDataFrame(sc.parallelize(1 to 100000, 100).map(x => Row(x)), StructType(StructField(\"index\",IntegerType,false) :: Nil))\n\nsrc.select((lit(2.7)*lognormal(lit(0.3))) cast IntegerType  as \"count\")\n   .select(when($\"count\" < lit(4),$\"count\") otherwise lit(4) as \"count\" )\n   .groupBy($\"count\").count().toZeppelin()","dateUpdated":"Jun 11, 2016 8:38:57 AM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"count","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"count","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465590994631_1403401364","id":"20160610-203634_1330406317","result":{"code":"SUCCESS","type":"TABLE","msg":"count\tcount\n0\t40\n1\t15912\n2\t47711\n3\t26810\n4\t9527\n","comment":"","msgTable":[[{"key":"count","value":"0"},{"key":"count","value":"40"}],[{"value":"1"},{"value":"15912"}],[{"value":"2"},{"value":"47711"}],[{"value":"3"},{"value":"26810"}],[{"value":"4"},{"value":"9527"}]],"columnNames":[{"name":"count","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["0","40"],["1","15912"],["2","47711"],["3","26810"],["4","9527"]]},"dateCreated":"Jun 10, 2016 8:36:34 PM","dateStarted":"Jun 11, 2016 8:38:57 AM","dateFinished":"Jun 11, 2016 8:39:04 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1446"},{"text":"%md\n# 3. Create a Random Hash Generator\n\nWe will need lots of unique session IDs and cross device keys. We will create pseudo random hashes for that. In order to create predictable results, we use an explicit seed for random number generation. Otherwise we might get different results everytime when the RDD is evaluated. And this might happen any time out of our control, even multiple times within a single action. And that would be really bad!","dateUpdated":"Jun 11, 2016 7:22:19 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465591944178_1880634496","id":"20160610-205224_57087976","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>3. Create a Random Hash Generator</h1>\n<p>We will need lots of unique session IDs and cross device keys. We will create pseudo random hashes for that. In order to create predictable results, we use an explicit seed for random number generation. Otherwise we might get different results everytime when the RDD is evaluated. And this might happen any time out of our control, even multiple times within a single action. And that would be really bad!</p>\n"},"dateCreated":"Jun 10, 2016 8:52:24 PM","dateStarted":"Jun 11, 2016 7:22:17 AM","dateFinished":"Jun 11, 2016 7:22:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1447"},{"text":"val random_hash = sqlContext.udf.register(\"random_hash\", (seed:Long) => new scala.util.Random(seed).alphanumeric.take(32).mkString(\"\"))","dateUpdated":"Jun 11, 2016 11:21:43 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465591013912_-1630161468","id":"20160610-203653_372271661","result":{"code":"SUCCESS","type":"TEXT","msg":"random_hash: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,List(LongType))\n"},"dateCreated":"Jun 10, 2016 8:36:53 PM","dateStarted":"Jun 11, 2016 11:21:44 AM","dateFinished":"Jun 11, 2016 11:21:45 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1448","focus":true},{"text":"%md\n## Test Hash Generator\nWe simple generate some data, and inspect the result. Hopefully we like it.","dateUpdated":"Jun 11, 2016 7:18:44 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465629491613_-446901316","id":"20160611-071811_1123157937","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Test Hash Generator</h2>\n<p>We simple generate some data, and inspect the result. Hopefully we like it.</p>\n"},"dateCreated":"Jun 11, 2016 7:18:11 AM","dateStarted":"Jun 11, 2016 7:18:40 AM","dateFinished":"Jun 11, 2016 7:18:40 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1449"},{"text":"val src = sqlContext.createDataFrame(sc.parallelize(1 to 10000000, 100).map(x => Row(x)), StructType(StructField(\"idx\",IntegerType,false) :: Nil))\nval hashes = src.select(random_hash($\"idx\") as \"hash\").cache()\nhashes.toZeppelin(10)","dateUpdated":"Jun 11, 2016 11:21:48 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465591742095_-1715703774","id":"20160610-204902_167725991","result":{"code":"SUCCESS","type":"TABLE","msg":"hash\nnGyyfLBf7IU85S2kIVJcSqzDe83EvzOm\n7SRyATf7O77Y7HY0LbIWst52DihbKcZM\ncWJAVwVpxIf9hbfknB5SqIl1LZBQU8I6\njvFIcGg37duQAtrNd2cmZjObm6W1A1SC\nNKU90GpP3YEe0zhm6eAVoiv6m3VvO2an\nQkN86Y3JS37Lde4q2GQnjIJsGEYKktrF\nU3o117LzmdmrfBQ7tE46FNMkiUzrrcWu\nsrAZ7MCWEe89cX2tt02Lkyx9RIGu6b9Y\nySjL6XUvmfAj6cWIz96zQuUYO40ZokjJ\nzOUpDXt8wxmenoBSrbImgKUECu7XF4KS\n","comment":"","msgTable":[[{"value":"nGyyfLBf7IU85S2kIVJcSqzDe83EvzOm"}],[{"value":"7SRyATf7O77Y7HY0LbIWst52DihbKcZM"}],[{"value":"cWJAVwVpxIf9hbfknB5SqIl1LZBQU8I6"}],[{"value":"jvFIcGg37duQAtrNd2cmZjObm6W1A1SC"}],[{"value":"NKU90GpP3YEe0zhm6eAVoiv6m3VvO2an"}],[{"value":"QkN86Y3JS37Lde4q2GQnjIJsGEYKktrF"}],[{"value":"U3o117LzmdmrfBQ7tE46FNMkiUzrrcWu"}],[{"value":"srAZ7MCWEe89cX2tt02Lkyx9RIGu6b9Y"}],[{"value":"ySjL6XUvmfAj6cWIz96zQuUYO40ZokjJ"}],[{"value":"zOUpDXt8wxmenoBSrbImgKUECu7XF4KS"}]],"columnNames":[{"name":"hash","index":0,"aggr":"sum"}],"rows":[["nGyyfLBf7IU85S2kIVJcSqzDe83EvzOm"],["7SRyATf7O77Y7HY0LbIWst52DihbKcZM"],["cWJAVwVpxIf9hbfknB5SqIl1LZBQU8I6"],["jvFIcGg37duQAtrNd2cmZjObm6W1A1SC"],["NKU90GpP3YEe0zhm6eAVoiv6m3VvO2an"],["QkN86Y3JS37Lde4q2GQnjIJsGEYKktrF"],["U3o117LzmdmrfBQ7tE46FNMkiUzrrcWu"],["srAZ7MCWEe89cX2tt02Lkyx9RIGu6b9Y"],["ySjL6XUvmfAj6cWIz96zQuUYO40ZokjJ"],["zOUpDXt8wxmenoBSrbImgKUECu7XF4KS"]]},"dateCreated":"Jun 10, 2016 8:49:02 PM","dateStarted":"Jun 11, 2016 11:21:48 AM","dateFinished":"Jun 11, 2016 11:21:50 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1450","focus":true},{"text":"%md\n## Check Quality of Randomness\n\nSince the hash values will serve us as unique IDs, they better should be unique. Let's check that.","dateUpdated":"Jun 11, 2016 7:19:14 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465591967606_-217755357","id":"20160610-205247_419442079","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Check Quality of Randomness</h2>\n<p>Since the hash values will serve us as unique IDs, they better should be unique. Let's check that.</p>\n"},"dateCreated":"Jun 10, 2016 8:52:47 PM","dateStarted":"Jun 11, 2016 7:19:11 AM","dateFinished":"Jun 11, 2016 7:19:11 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1451"},{"text":"hashes.groupBy(\"hash\").count().filter(col(\"count\") > 1).count()","dateUpdated":"Jun 11, 2016 8:39:10 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465591829024_851630402","id":"20160610-205029_467377335","result":{"code":"SUCCESS","type":"TEXT","msg":"res19: Long = 0\n"},"dateCreated":"Jun 10, 2016 8:50:29 PM","dateStarted":"Jun 11, 2016 8:39:10 AM","dateFinished":"Jun 11, 2016 8:39:41 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1452","focus":true},{"text":"%md\n# 4. Create Random Name Generator\n\nJust for convenience, we also want to have user names. This will help us checking the results. We create random user names by using some name lists from US Census 1990 and US Census 2000. We then combine random first names with random last names for generating names.","dateUpdated":"Jun 11, 2016 7:23:22 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465592516732_-772381025","id":"20160610-210156_2120151249","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>4. Create Random Name Generator</h1>\n<p>Just for convenience, we also want to have user names. This will help us checking the results. We create random user names by using some name lists from US Census 1990 and US Census 2000. We then combine random first names with random last names for generating names.</p>\n"},"dateCreated":"Jun 10, 2016 9:01:56 PM","dateStarted":"Jun 11, 2016 7:23:19 AM","dateFinished":"Jun 11, 2016 7:23:19 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1453"},{"text":"%md\n## Load Names\nNow we load names from previously registered Hive tables. We store the results in broadcast variables for later processing.","dateUpdated":"Jun 11, 2016 7:21:52 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465628765506_827115018","id":"20160611-070605_859155850","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Load Names</h2>\n<p>Now we load names from previously registered Hive tables. We store the results in broadcast variables for later processing.</p>\n"},"dateCreated":"Jun 11, 2016 7:06:05 AM","dateStarted":"Jun 11, 2016 7:21:52 AM","dateFinished":"Jun 11, 2016 7:21:52 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1454"},{"text":"val lastNames = sqlContext.table(\"training.last_names\")\nval firstNamesMale = sqlContext.table(\"training.first_names_male\")\nval firstNamesFemale = sqlContext.table(\"training.first_names_female\")\n\nval lastNamesBc = sc.broadcast(lastNames.select(\"name\").map(_.getString(0)).collect())\nval firstNamesMaleBc = sc.broadcast(firstNamesMale.select(\"name\").map(_.getString(0)).collect())\nval firstNamesFemaleBc = sc.broadcast(firstNamesFemale.select(\"name\").map(_.getString(0)).collect())\n","dateUpdated":"Jun 11, 2016 11:21:55 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465628076989_-2132156217","id":"20160611-065436_1713338353","result":{"code":"SUCCESS","type":"TEXT","msg":"lastNames: org.apache.spark.sql.DataFrame = [name: string, rank: int, count: int, prop100k: double, cum_prop100k: double, pctwhite: double, pctblack: double, pctapi: double, pctaian: double, pct2prace: double, pcthispanic: double]\nfirstNamesMale: org.apache.spark.sql.DataFrame = [name: string, prop: double, cum_prop: double, rank: int]\nfirstNamesFemale: org.apache.spark.sql.DataFrame = [name: string, prop: double, cum_prop: double, rank: int]\nlastNamesBc: org.apache.spark.broadcast.Broadcast[Array[String]] = Broadcast(7)\nfirstNamesMaleBc: org.apache.spark.broadcast.Broadcast[Array[String]] = Broadcast(10)\nfirstNamesFemaleBc: org.apache.spark.broadcast.Broadcast[Array[String]] = Broadcast(13)\n"},"dateCreated":"Jun 11, 2016 6:54:36 AM","dateStarted":"Jun 11, 2016 11:21:55 AM","dateFinished":"Jun 11, 2016 11:22:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1455","focus":true},{"text":"%md\n## Create Random Names\nNow we create random names from first names and last names. We could use a UNION of male and female first names. But since we have more female first names than male ones, this would result in skewed data with a significant overrepresentation of women. Not important, but we do care :) So we first roll a dice for selecting the gender, and then we randomly select a name from the appropriate list.","dateUpdated":"Jun 11, 2016 7:08:26 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465628793266_1999090816","id":"20160611-070633_493197002","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Create Random Names</h2>\n<p>Now we create random names from first names and last names. We could use a UNION of male and female first names. But since we have more female first names than male ones, this would result in skewed data with a significant overrepresentation of women. Not important, but we do care :) So we first roll a dice for selecting the gender, and then we randomly select a name from the appropriate list.</p>\n"},"dateCreated":"Jun 11, 2016 7:06:33 AM","dateStarted":"Jun 11, 2016 7:08:24 AM","dateFinished":"Jun 11, 2016 7:08:24 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1456"},{"text":"// Create a UDF for creating a pseudo random first name\nval randomFirstName = sqlContext.udf.register(\"randomFirstName\", (seed:Long) => {\n    val rnd = new scala.util.Random(100*seed)\n    val firstNamesMale = firstNamesMaleBc.value\n    val firstNamesFemale = firstNamesFemaleBc.value\n    val numFirstNamesMale = firstNamesMale.length\n    val numFirstNamesFemale = firstNamesFemale.length\n\n    if (rnd.nextBoolean()) \n        firstNamesMale(rnd.nextInt(numFirstNamesMale))\n    else\n        firstNamesFemale(rnd.nextInt(numFirstNamesFemale))\n})\n\n// Create a UDF for creating a pseudo random last name\nval randomLastName = sqlContext.udf.register(\"randomLastName\", (seed:Long) => {\n    val rnd = new scala.util.Random(100*seed + 1)\n    val lastNames = lastNamesBc.value\n    val numLastNames = lastNames.length\n\n    lastNames(rnd.nextInt(numLastNames))\n})\n\nval people = sqlContext.createDataFrame(\n    sc.parallelize(1 to 10000000, 100).map(Row(_)),\n    StructType(StructField(\"index\", IntegerType, false) :: Nil)\n).select($\"index\", randomFirstName($\"index\").as(\"first_name\"), randomLastName($\"index\").as(\"last_name\"))\n\n","dateUpdated":"Jun 11, 2016 11:23:00 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465628048361_-862915569","id":"20160611-065408_339835201","result":{"code":"SUCCESS","type":"TEXT","msg":"randomFirstName: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,List(LongType))\nrandomLastName: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,List(LongType))\npeople: org.apache.spark.sql.DataFrame = [index: int, first_name: string, last_name: string]\n"},"dateCreated":"Jun 11, 2016 6:54:08 AM","dateStarted":"Jun 11, 2016 11:23:00 AM","dateFinished":"Jun 11, 2016 11:23:01 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1457","focus":true},{"text":"people.toZeppelin(10)","dateUpdated":"Jun 11, 2016 7:05:43 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465628548241_1584379119","id":"20160611-070228_2114369793","result":{"code":"SUCCESS","type":"TABLE","msg":"index\tfirst_name\tlast_name\n1\tJESUS\tAWA\n2\tDEXTER\tGOODWATER\n3\tDUNCAN\tREDIC\n4\tSANTOS\tZADA\n5\tELTON\tZIMBARDI\n6\tCAMERON\tVASINA\n7\tSCOT\tNAVON\n8\tABRAM\tSCHOLL\n9\tWESLEY\tMECKER\n10\tRON\tESKRIDGE\n","comment":"","msgTable":[[{"key":"first_name","value":"1"},{"key":"first_name","value":"JESUS"},{"key":"first_name","value":"AWA"}],[{"key":"last_name","value":"2"},{"key":"last_name","value":"DEXTER"},{"key":"last_name","value":"GOODWATER"}],[{"value":"3"},{"value":"DUNCAN"},{"value":"REDIC"}],[{"value":"4"},{"value":"SANTOS"},{"value":"ZADA"}],[{"value":"5"},{"value":"ELTON"},{"value":"ZIMBARDI"}],[{"value":"6"},{"value":"CAMERON"},{"value":"VASINA"}],[{"value":"7"},{"value":"SCOT"},{"value":"NAVON"}],[{"value":"8"},{"value":"ABRAM"},{"value":"SCHOLL"}],[{"value":"9"},{"value":"WESLEY"},{"value":"MECKER"}],[{"value":"10"},{"value":"RON"},{"value":"ESKRIDGE"}]],"columnNames":[{"name":"index","index":0,"aggr":"sum"},{"name":"first_name","index":1,"aggr":"sum"},{"name":"last_name","index":2,"aggr":"sum"}],"rows":[["1","JESUS","AWA"],["2","DEXTER","GOODWATER"],["3","DUNCAN","REDIC"],["4","SANTOS","ZADA"],["5","ELTON","ZIMBARDI"],["6","CAMERON","VASINA"],["7","SCOT","NAVON"],["8","ABRAM","SCHOLL"],["9","WESLEY","MECKER"],["10","RON","ESKRIDGE"]]},"dateCreated":"Jun 11, 2016 7:02:28 AM","dateStarted":"Jun 11, 2016 7:05:43 AM","dateFinished":"Jun 11, 2016 7:05:47 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1458"},{"text":"%md\n# 5. Create Test Data\n\n1. Create a list of users (create a list of names)\n2. For every user, randomly create number of CDKs, number of Sessions\n3. For every session, randomly create number of used CDKs and select CDKs from user CDKs\n4. Store Data","dateUpdated":"Jun 11, 2016 7:25:00 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465628743117_-805187386","id":"20160611-070543_251913145","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>5. Create Test Data</h1>\n<ol>\n<li>Create a list of users (create a list of names)</li>\n<li>For every user, randomly create number of CDKs, number of Sessions</li>\n<li>For every session, randomly create number of used CDKs and select CDKs from user CDKs</li>\n<li>Store Data</li>\n</ol>\n"},"dateCreated":"Jun 11, 2016 7:05:43 AM","dateStarted":"Jun 11, 2016 7:24:54 AM","dateFinished":"Jun 11, 2016 7:24:54 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1459"},{"text":"val randomSessions = sqlContext.udf.register(\"randomSession\", (seed:Long) => {\n    // Create deterministic RNG using given seed\n    val rnd = new scala.util.Random(seed)\n    \n    // Locally define lognormal distribution using random number generator defined above\n    def lognormal(a:Double) : Double = scala.math.exp(a*rnd.nextGaussian()) \n    \n    // Generate CDKs for specific user. Make sure user has at least one CDK\n    val numCdks = scala.math.max((14.0*lognormal(0.3)).toInt, 1)\n    val cdks = 1 to numCdks map { i => \"cdk_\" + rnd.alphanumeric.take(32).mkString(\"\") }\n    \n    // Generate sessions for user\n    val numSessions = (50.0*lognormal(0.4)).toInt\n    1 to numSessions flatMap { i:Int => {\n        // Create random session ID\n        val session = \"sesn_\" + rnd.alphanumeric.take(32).mkString(\"\")\n        // Generate CDK entries for session\n        val usedCdks = (2.7*lognormal(0.3)).toInt\n        1 to usedCdks map { i => (session, cdks(rnd.nextInt(numCdks))) }\n    }}\n})\n\n","dateUpdated":"Jun 11, 2016 11:23:04 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465630542733_1003306468","id":"20160611-073542_554602526","result":{"code":"SUCCESS","type":"TEXT","msg":"randomSessions: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function1>,ArrayType(StructType(StructField(_1,StringType,true), StructField(_2,StringType,true)),true),List(LongType))\n"},"dateCreated":"Jun 11, 2016 7:35:42 AM","dateStarted":"Jun 11, 2016 11:23:04 AM","dateFinished":"Jun 11, 2016 11:23:05 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1460","focus":true},{"text":"val people = sqlContext.createDataFrame(\n    sc.parallelize(1 to 200000, 100).map(Row(_)),\n    StructType(StructField(\"index\", IntegerType, false) :: Nil)\n).select($\"index\", concat(randomFirstName($\"index\"), lit(\" \"), randomLastName($\"index\")).as(\"name\"))\n.groupBy($\"name\").max(\"index\")\n.select($\"name\",$\"max(index)\".as(\"index\"))\n\nval sessions = people.select($\"name\", explode(randomSessions($\"index\")) as \"session_data\")\n    .select($\"name\", $\"session_data._1\" as \"session\", $\"session_data._2\" as \"cdk\")\n    .cache()\nsessions.toZeppelin(12)","dateUpdated":"Jun 11, 2016 11:23:07 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465629894265_1176119497","id":"20160611-072454_1554728841","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tsession\tcdk\nBO VILLNAVE\tsesn_xxZb9kpHYUetZ2zhRiG4l94K2KxX5Nt1\tcdk_eU5BcbMkfZxW7mhb7o3FTLixP1ka0wOQ\nBO VILLNAVE\tsesn_xxZb9kpHYUetZ2zhRiG4l94K2KxX5Nt1\tcdk_PdXf8Tq5ydfguXAPOqSWF0II41M2ftaL\nBO VILLNAVE\tsesn_xxZb9kpHYUetZ2zhRiG4l94K2KxX5Nt1\tcdk_m9Orcswqe1n3MsbRQsa1QHMhvx6xwPM5\nBO VILLNAVE\tsesn_Mbx2q0mptUOSmsYvDfbAhtlwEEbX1uIV\tcdk_DoPE6Ryi00xN1nRbnHKC0khg6E9uagAU\nBO VILLNAVE\tsesn_Mbx2q0mptUOSmsYvDfbAhtlwEEbX1uIV\tcdk_gK6i29ZV4WNqKSxTKJXVwRdPsNjYsZd9\nBO VILLNAVE\tsesn_zLzT5oOo2XccQvmFqwsFPRaJXgCdIAto\tcdk_rg0SnKdiwfUB5KNTcwdA0tHxJmGE7ad1\nBO VILLNAVE\tsesn_zLzT5oOo2XccQvmFqwsFPRaJXgCdIAto\tcdk_A3rxGRsjlwazPoBARBaDUNiSg3Vv7m0W\nBO VILLNAVE\tsesn_zLzT5oOo2XccQvmFqwsFPRaJXgCdIAto\tcdk_gK6i29ZV4WNqKSxTKJXVwRdPsNjYsZd9\nBO VILLNAVE\tsesn_9CnS55FtqV3nKtoFNhUK5t00AGpV9oWR\tcdk_j8D65ngrVpuDN2FcxnggDnM27p5Ol98r\nBO VILLNAVE\tsesn_9CnS55FtqV3nKtoFNhUK5t00AGpV9oWR\tcdk_j8D65ngrVpuDN2FcxnggDnM27p5Ol98r\nBO VILLNAVE\tsesn_ABw7rN1JzKqepgPOrCDvzdpXakwiBe8G\tcdk_eU5BcbMkfZxW7mhb7o3FTLixP1ka0wOQ\nBO VILLNAVE\tsesn_ABw7rN1JzKqepgPOrCDvzdpXakwiBe8G\tcdk_DoPE6Ryi00xN1nRbnHKC0khg6E9uagAU\n","comment":"","msgTable":[[{"key":"session","value":"BO VILLNAVE"},{"key":"session","value":"sesn_xxZb9kpHYUetZ2zhRiG4l94K2KxX5Nt1"},{"key":"session","value":"cdk_eU5BcbMkfZxW7mhb7o3FTLixP1ka0wOQ"}],[{"key":"cdk","value":"BO VILLNAVE"},{"key":"cdk","value":"sesn_xxZb9kpHYUetZ2zhRiG4l94K2KxX5Nt1"},{"key":"cdk","value":"cdk_PdXf8Tq5ydfguXAPOqSWF0II41M2ftaL"}],[{"value":"BO VILLNAVE"},{"value":"sesn_xxZb9kpHYUetZ2zhRiG4l94K2KxX5Nt1"},{"value":"cdk_m9Orcswqe1n3MsbRQsa1QHMhvx6xwPM5"}],[{"value":"BO VILLNAVE"},{"value":"sesn_Mbx2q0mptUOSmsYvDfbAhtlwEEbX1uIV"},{"value":"cdk_DoPE6Ryi00xN1nRbnHKC0khg6E9uagAU"}],[{"value":"BO VILLNAVE"},{"value":"sesn_Mbx2q0mptUOSmsYvDfbAhtlwEEbX1uIV"},{"value":"cdk_gK6i29ZV4WNqKSxTKJXVwRdPsNjYsZd9"}],[{"value":"BO VILLNAVE"},{"value":"sesn_zLzT5oOo2XccQvmFqwsFPRaJXgCdIAto"},{"value":"cdk_rg0SnKdiwfUB5KNTcwdA0tHxJmGE7ad1"}],[{"value":"BO VILLNAVE"},{"value":"sesn_zLzT5oOo2XccQvmFqwsFPRaJXgCdIAto"},{"value":"cdk_A3rxGRsjlwazPoBARBaDUNiSg3Vv7m0W"}],[{"value":"BO VILLNAVE"},{"value":"sesn_zLzT5oOo2XccQvmFqwsFPRaJXgCdIAto"},{"value":"cdk_gK6i29ZV4WNqKSxTKJXVwRdPsNjYsZd9"}],[{"value":"BO VILLNAVE"},{"value":"sesn_9CnS55FtqV3nKtoFNhUK5t00AGpV9oWR"},{"value":"cdk_j8D65ngrVpuDN2FcxnggDnM27p5Ol98r"}],[{"value":"BO VILLNAVE"},{"value":"sesn_9CnS55FtqV3nKtoFNhUK5t00AGpV9oWR"},{"value":"cdk_j8D65ngrVpuDN2FcxnggDnM27p5Ol98r"}],[{"value":"BO VILLNAVE"},{"value":"sesn_ABw7rN1JzKqepgPOrCDvzdpXakwiBe8G"},{"value":"cdk_eU5BcbMkfZxW7mhb7o3FTLixP1ka0wOQ"}],[{"value":"BO VILLNAVE"},{"value":"sesn_ABw7rN1JzKqepgPOrCDvzdpXakwiBe8G"},{"value":"cdk_DoPE6Ryi00xN1nRbnHKC0khg6E9uagAU"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"session","index":1,"aggr":"sum"},{"name":"cdk","index":2,"aggr":"sum"}],"rows":[["BO VILLNAVE","sesn_xxZb9kpHYUetZ2zhRiG4l94K2KxX5Nt1","cdk_eU5BcbMkfZxW7mhb7o3FTLixP1ka0wOQ"],["BO VILLNAVE","sesn_xxZb9kpHYUetZ2zhRiG4l94K2KxX5Nt1","cdk_PdXf8Tq5ydfguXAPOqSWF0II41M2ftaL"],["BO VILLNAVE","sesn_xxZb9kpHYUetZ2zhRiG4l94K2KxX5Nt1","cdk_m9Orcswqe1n3MsbRQsa1QHMhvx6xwPM5"],["BO VILLNAVE","sesn_Mbx2q0mptUOSmsYvDfbAhtlwEEbX1uIV","cdk_DoPE6Ryi00xN1nRbnHKC0khg6E9uagAU"],["BO VILLNAVE","sesn_Mbx2q0mptUOSmsYvDfbAhtlwEEbX1uIV","cdk_gK6i29ZV4WNqKSxTKJXVwRdPsNjYsZd9"],["BO VILLNAVE","sesn_zLzT5oOo2XccQvmFqwsFPRaJXgCdIAto","cdk_rg0SnKdiwfUB5KNTcwdA0tHxJmGE7ad1"],["BO VILLNAVE","sesn_zLzT5oOo2XccQvmFqwsFPRaJXgCdIAto","cdk_A3rxGRsjlwazPoBARBaDUNiSg3Vv7m0W"],["BO VILLNAVE","sesn_zLzT5oOo2XccQvmFqwsFPRaJXgCdIAto","cdk_gK6i29ZV4WNqKSxTKJXVwRdPsNjYsZd9"],["BO VILLNAVE","sesn_9CnS55FtqV3nKtoFNhUK5t00AGpV9oWR","cdk_j8D65ngrVpuDN2FcxnggDnM27p5Ol98r"],["BO VILLNAVE","sesn_9CnS55FtqV3nKtoFNhUK5t00AGpV9oWR","cdk_j8D65ngrVpuDN2FcxnggDnM27p5Ol98r"],["BO VILLNAVE","sesn_ABw7rN1JzKqepgPOrCDvzdpXakwiBe8G","cdk_eU5BcbMkfZxW7mhb7o3FTLixP1ka0wOQ"],["BO VILLNAVE","sesn_ABw7rN1JzKqepgPOrCDvzdpXakwiBe8G","cdk_DoPE6Ryi00xN1nRbnHKC0khg6E9uagAU"]]},"dateCreated":"Jun 11, 2016 7:24:54 AM","dateStarted":"Jun 11, 2016 11:23:07 AM","dateFinished":"Jun 11, 2016 11:23:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1461","focus":true},{"text":"%md\n# Check Uniqueness of Session IDs","dateUpdated":"Jun 11, 2016 8:52:05 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635048579_1389780945","id":"20160611-085048_1983995929","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Check Uniqueness of Session IDs</h1>\n"},"dateCreated":"Jun 11, 2016 8:50:48 AM","dateStarted":"Jun 11, 2016 8:52:05 AM","dateFinished":"Jun 11, 2016 8:52:05 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1462"},{"text":"sessions.select($\"name\",$\"session\").distinct().groupBy($\"session\").count().filter($\"count\">1).count()\n","dateUpdated":"Jun 11, 2016 11:23:13 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465630980377_1114294752","id":"20160611-074300_1949463897","result":{"code":"SUCCESS","type":"TEXT","msg":"res32: Long = 0\n"},"dateCreated":"Jun 11, 2016 7:43:00 AM","dateStarted":"Jun 11, 2016 11:23:13 AM","dateFinished":"Jun 11, 2016 11:24:09 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1463","focus":true},{"text":"sessions.count()","dateUpdated":"Jun 11, 2016 11:23:15 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465631812958_-1934832059","id":"20160611-075652_881962885","result":{"code":"SUCCESS","type":"TEXT","msg":"res34: Long = 24950997\n"},"dateCreated":"Jun 11, 2016 7:56:52 AM","dateStarted":"Jun 11, 2016 11:23:18 AM","dateFinished":"Jun 11, 2016 11:24:10 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1464","focus":true},{"text":"%md\n# Save Result","dateUpdated":"Jun 11, 2016 9:00:45 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635395098_1590911031","id":"20160611-085635_445219987","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Save Result</h1>\n"},"dateCreated":"Jun 11, 2016 8:56:35 AM","dateStarted":"Jun 11, 2016 9:00:45 AM","dateFinished":"Jun 11, 2016 9:00:45 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1465"},{"text":"sessions.write.mode(\"overwrite\").parquet(\"data/sessions\")","dateUpdated":"Jun 11, 2016 11:23:18 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635081273_1607979544","id":"20160611-085121_1797782377","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jun 11, 2016 8:51:21 AM","dateStarted":"Jun 11, 2016 11:24:09 AM","dateFinished":"Jun 11, 2016 11:24:33 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1466","focus":true},{"text":"%md\n# Cleanup Memory","dateUpdated":"Jun 11, 2016 8:56:46 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635369754_-236123578","id":"20160611-085609_516211283","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Cleanup Memory</h1>\n"},"dateCreated":"Jun 11, 2016 8:56:09 AM","dateStarted":"Jun 11, 2016 8:56:46 AM","dateFinished":"Jun 11, 2016 8:56:46 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1467"},{"text":"sc.getPersistentRDDs.foreach { entry => entry._2.unpersist() }","dateUpdated":"Jun 11, 2016 11:23:23 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465632100030_-1924614049","id":"20160611-080140_239855178","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jun 11, 2016 8:01:40 AM","dateStarted":"Jun 11, 2016 11:24:11 AM","dateFinished":"Jun 11, 2016 11:24:34 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1468","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635200175_-169774913","id":"20160611-085320_898645245","dateCreated":"Jun 11, 2016 8:53:20 AM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1469"}],"name":"GraphX Test Data Generation","id":"2BQCC8B12","angularObjects":{"2B44YVSN1":[],"2AJXGMUUJ":[],"2AK8P7CPX":[],"2AM1YV5CU":[],"2AKK3QQXU":[],"2ANGGHHMQ":[]},"config":{"looknfeel":"default"},"info":{}}