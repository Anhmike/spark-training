{"paragraphs":[{"text":"%md\n# Creating DataSets","dateUpdated":"2017-01-05T00:16:04-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164577_1380048660","id":"20160617-201427_857258739","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Creating DataSets</h1>\n"},"dateCreated":"2017-01-05T00:16:04-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11606"},{"text":"case class Person(\n    name:String,\n    sex:String,\n    age:Int)\n{\n}","dateUpdated":"2017-01-05T01:09:37-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164577_1380048660","id":"20160617-200218_1910498306","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class Person\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:09:37-0800","dateFinished":"2017-01-05T01:09:55-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11607","focus":true},{"text":"val persons = Seq(\n        Person(\"Alice\", \"female\", 32), \n        Person(\"Bob\", \"male\", 24),\n        Person(\"Christine\", \"female\", 42), \n        Person(\"Dale\", \"male\", 19),\n        Person(\"Eve\", \"female\", 33)\n    ).toDS","dateUpdated":"2017-01-05T01:09:42-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164578_1381202907","id":"20160617-200626_1254551091","result":{"code":"SUCCESS","type":"TEXT","msg":"\npersons: org.apache.spark.sql.Dataset[Person] = [name: string, sex: string ... 1 more field]\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:09:42-0800","dateFinished":"2017-01-05T01:10:00-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11608","focus":true},{"text":"persons.collect().foreach(println)","dateUpdated":"2017-01-05T01:09:45-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604593688_1458549471","id":"20170105-002313_1230126684","result":{"code":"SUCCESS","type":"TEXT","msg":"Person(Alice,female,32)\nPerson(Bob,male,24)\nPerson(Christine,female,42)\nPerson(Dale,male,19)\nPerson(Eve,female,33)\n"},"dateCreated":"2017-01-05T00:23:13-0800","dateStarted":"2017-01-05T01:09:55-0800","dateFinished":"2017-01-05T01:10:01-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11609","focus":true},{"text":"%md\n## Inspect Schema","dateUpdated":"2017-01-05T00:16:04-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164578_1381202907","id":"20160617-205347_1951340760","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Inspect Schema</h2>\n"},"dateCreated":"2017-01-05T00:16:04-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11610"},{"text":"persons.schema","dateUpdated":"2017-01-05T01:09:48-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164578_1381202907","id":"20160617-201326_798645553","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres5: org.apache.spark.sql.types.StructType = StructType(StructField(name,StringType,true), StructField(sex,StringType,true), StructField(age,IntegerType,false))\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:10:00-0800","dateFinished":"2017-01-05T01:10:02-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11611","focus":true},{"text":"persons.printSchema()","dateUpdated":"2017-01-05T01:09:55-0800","config":{"colWidth":12,"graph":{"mode":"table","height":124.60000610351562,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483606805058_-1190473542","id":"20170105-010005_1268070331","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- name: string (nullable = true)\n |-- sex: string (nullable = true)\n |-- age: integer (nullable = false)\n\n"},"dateCreated":"2017-01-05T01:00:05-0800","dateStarted":"2017-01-05T01:10:01-0800","dateFinished":"2017-01-05T01:10:02-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11612","focus":true},{"text":"%md\n# Loading Data","dateUpdated":"2017-01-05T01:04:12-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483606841897_670987609","id":"20170105-010041_2117356113","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Loading Data</h1>\n"},"dateCreated":"2017-01-05T01:00:41-0800","dateStarted":"2017-01-05T01:04:12-0800","dateFinished":"2017-01-05T01:04:12-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11613"},{"text":"import org.apache.spark.sql.types.IntegerType\nval persons = sqlContext.read.json(\"/user/training/data/persons.json\").withColumn(\"age\", $\"age\".cast(IntegerType)).as[Person]","dateUpdated":"2017-01-05T01:10:06-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483606857140_1162494200","id":"20170105-010057_986098899","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.types.IntegerType\n\npersons: org.apache.spark.sql.Dataset[Person] = [age: int, height: bigint ... 2 more fields]\n"},"dateCreated":"2017-01-05T01:00:57-0800","dateStarted":"2017-01-05T01:10:06-0800","dateFinished":"2017-01-05T01:10:08-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11614","focus":true},{"text":"%md\n## Note Schema vs Class Definition","dateUpdated":"2017-01-05T01:10:26-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483607241437_-1396330649","id":"20170105-010721_139087314","dateCreated":"2017-01-05T01:07:21-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11615","dateFinished":"2017-01-05T01:10:23-0800","dateStarted":"2017-01-05T01:10:23-0800","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Note Schema vs Class Definition</h2>\n"},"focus":true},{"text":"persons.printSchema()","dateUpdated":"2017-01-05T01:10:29-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483607219705_148020788","id":"20170105-010659_1991798171","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- age: integer (nullable = true)\n |-- height: long (nullable = true)\n |-- name: string (nullable = true)\n |-- sex: string (nullable = true)\n\n"},"dateCreated":"2017-01-05T01:06:59-0800","dateStarted":"2017-01-05T01:10:29-0800","dateFinished":"2017-01-05T01:10:30-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11616","focus":true},{"text":"%md\n# Pretty Printing","dateUpdated":"2017-01-05T00:16:04-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164579_1380818158","id":"20160618-054348_706632489","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Pretty Printing</h1>\n"},"dateCreated":"2017-01-05T00:16:04-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11617"},{"text":"import org.apache.spark.sql.Dataset\n\nimplicit class DataSetZeppelinOutput[T](ds:org.apache.spark.sql.Dataset[T]) {\n    def toZeppelin(limit:Int = -1)  = {\n        val df = ds.toDF\n        println(\"%table\")\n        println(df.schema.map(_.name).mkString(\"\\t\"))\n        val data = if (limit <= 0) df else df.limit(limit)\n        data.collect.foreach(row => println(row.mkString(\"\\t\")))\n    }\n}","dateUpdated":"2017-01-05T01:10:36-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164579_1380818158","id":"20160618-054059_1129017124","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.Dataset\n\ndefined class DataSetZeppelinOutput\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:10:36-0800","dateFinished":"2017-01-05T01:10:37-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11618","focus":true},{"text":"persons.toZeppelin()","dateUpdated":"2017-01-05T01:10:40-0800","config":{"enabled":true,"graph":{"mode":"table","height":204,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164580_1378894413","id":"20160618-054337_2135335309","result":{"code":"SUCCESS","type":"TABLE","msg":"age\theight\tname\tsex\n23\t156\tAlice\tfemale\n21\t181\tBob\tmale\n27\t176\tCharlie\tmale\n24\t167\tEve\tfemale\n19\t172\tFrances\tfemale\n31\t191\tGeorge\tfemale\n","comment":"","msgTable":[[{"key":"height","value":"23"},{"key":"height","value":"156"},{"key":"height","value":"Alice"},{"key":"height","value":"female"}],[{"key":"name","value":"21"},{"key":"name","value":"181"},{"key":"name","value":"Bob"},{"key":"name","value":"male"}],[{"key":"sex","value":"27"},{"key":"sex","value":"176"},{"key":"sex","value":"Charlie"},{"key":"sex","value":"male"}],[{"value":"24"},{"value":"167"},{"value":"Eve"},{"value":"female"}],[{"value":"19"},{"value":"172"},{"value":"Frances"},{"value":"female"}],[{"value":"31"},{"value":"191"},{"value":"George"},{"value":"female"}]],"columnNames":[{"name":"age","index":0,"aggr":"sum"},{"name":"height","index":1,"aggr":"sum"},{"name":"name","index":2,"aggr":"sum"},{"name":"sex","index":3,"aggr":"sum"}],"rows":[["23","156","Alice","female"],["21","181","Bob","male"],["27","176","Charlie","male"],["24","167","Eve","female"],["19","172","Frances","female"],["31","191","George","female"]]},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:10:40-0800","dateFinished":"2017-01-05T01:10:41-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11619","focus":true},{"text":"%md\n## Use DataFrame-Like API","dateUpdated":"2017-01-05T00:16:04-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164580_1378894413","id":"20160617-205415_2045240993","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Use DataFrame-Like API</h2>\n"},"dateCreated":"2017-01-05T00:16:04-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11620"},{"text":"val result = persons.select($\"name\".as[String], $\"age\".as[String])\nresult.toZeppelin()","dateUpdated":"2017-01-05T01:10:54-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164581_1378509665","id":"20160618-055305_406692908","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tage\nAlice\t23\nBob\t21\nCharlie\t27\nEve\t24\nFrances\t19\nGeorge\t31\n","comment":"","msgTable":[[{"key":"age","value":"Alice"},{"key":"age","value":"23"}],[{"value":"Bob"},{"value":"21"}],[{"value":"Charlie"},{"value":"27"}],[{"value":"Eve"},{"value":"24"}],[{"value":"Frances"},{"value":"19"}],[{"value":"George"},{"value":"31"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"age","index":1,"aggr":"sum"}],"rows":[["Alice","23"],["Bob","21"],["Charlie","27"],["Eve","24"],["Frances","19"],["George","31"]]},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:10:54-0800","dateFinished":"2017-01-05T01:10:56-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11621","focus":true},{"text":"%md\n## Comapre Dataset Types\n\nInput data type is \"Person\", while the result of the select operation is a tuple","dateUpdated":"2017-01-05T01:11:44-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604990352_394117830","id":"20170105-002950_381594314","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Comapre Dataset Types</h2>\n<p>Input data type is &ldquo;Person&rdquo;, while the result of the select operation is a tuple</p>\n"},"dateCreated":"2017-01-05T00:29:50-0800","dateStarted":"2017-01-05T01:11:41-0800","dateFinished":"2017-01-05T01:11:41-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11622","focus":true},{"text":"persons","dateUpdated":"2017-01-05T01:11:02-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483605038565_1342170292","id":"20170105-003038_78931382","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres17: org.apache.spark.sql.Dataset[Person] = [age: int, height: bigint ... 2 more fields]\n"},"dateCreated":"2017-01-05T00:30:38-0800","dateStarted":"2017-01-05T01:11:02-0800","dateFinished":"2017-01-05T01:11:02-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11623","focus":true},{"text":"result","dateUpdated":"2017-01-05T01:11:05-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483605042807_571533569","id":"20170105-003042_32233686","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres19: org.apache.spark.sql.Dataset[(String, String)] = [name: string, age: int]\n"},"dateCreated":"2017-01-05T00:30:42-0800","dateStarted":"2017-01-05T01:11:05-0800","dateFinished":"2017-01-05T01:11:06-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11624","focus":true},{"text":"%md\n## Dataset Joining\n\nDatasets  also support join operations, the result is a tuple.","dateUpdated":"2017-01-05T01:12:28-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164582_1379663911","id":"20160618-064756_323624134","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Dataset Joining</h2>\n<p>Datasets  also support join operations, the result is a tuple.</p>\n"},"dateCreated":"2017-01-05T00:16:04-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11625","dateFinished":"2017-01-05T01:12:24-0800","dateStarted":"2017-01-05T01:12:24-0800","focus":true},{"text":"case class PersonAddress (\n    name:String,\n    city:String\n) { }\n\nval addresses = Seq(\n    PersonAddress(\"Alice\", \"Frankfurt\"),\n    PersonAddress(\"Bob\", \"Berlin\")\n    ).toDS","dateUpdated":"2017-01-05T01:11:49-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164583_1379279162","id":"20160618-064806_552944470","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class PersonAddress\n\naddresses: org.apache.spark.sql.Dataset[PersonAddress] = [name: string, city: string]\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:11:49-0800","dateFinished":"2017-01-05T01:11:50-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11626","focus":true},{"text":"val result = persons.as(\"person\").joinWith(addresses.as(\"address\"), $\"person.name\" === $\"address.name\")\nresult.toZeppelin()","dateUpdated":"2017-01-05T01:12:33-0800","config":{"enabled":true,"graph":{"mode":"table","height":124,"optionOpen":false,"keys":[{"name":"_1","index":0,"aggr":"sum"}],"values":[{"name":"_2","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"_1","index":0,"aggr":"sum"},"yAxis":{"name":"_2","index":1,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164583_1379279162","id":"20160618-065315_531175389","result":{"code":"SUCCESS","type":"TABLE","msg":"_1\t_2\n[23,156,Alice,female]\t[Alice,Frankfurt]\n[21,181,Bob,male]\t[Bob,Berlin]\n","comment":"","msgTable":[[{"key":"_2","value":"[23,156,Alice,female]"},{"key":"_2","value":"[Alice,Frankfurt]"}],[{"value":"[21,181,Bob,male]"},{"value":"[Bob,Berlin]"}]],"columnNames":[{"name":"_1","index":0,"aggr":"sum"},{"name":"_2","index":1,"aggr":"sum"}],"rows":[["[23,156,Alice,female]","[Alice,Frankfurt]"],["[21,181,Bob,male]","[Bob,Berlin]"]]},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:12:33-0800","dateFinished":"2017-01-05T01:12:35-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11627","focus":true},{"text":"result","dateUpdated":"2017-01-05T01:12:53-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483605205782_268983016","id":"20170105-003325_556063070","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres24: org.apache.spark.sql.Dataset[(Person, PersonAddress)] = [_1: struct<age: int, height: bigint ... 2 more fields>, _2: struct<name: string, city: string>]\n"},"dateCreated":"2017-01-05T00:33:25-0800","dateStarted":"2017-01-05T01:12:53-0800","dateFinished":"2017-01-05T01:12:53-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11628","focus":true},{"text":"%md\n## DataFrame like Joining\n\nYou can also use traditional DataFrame join methods, these will return a DataFrame instead of a Dataset","dateUpdated":"2017-01-05T01:13:29-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483605278596_1726319905","id":"20170105-003438_1163697573","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>DataFrame like Joining</h2>\n<p>You can also use traditional DataFrame join methods, these will return a DataFrame instead of a Dataset</p>\n"},"dateCreated":"2017-01-05T00:34:38-0800","dateStarted":"2017-01-05T01:13:26-0800","dateFinished":"2017-01-05T01:13:26-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11629","focus":true},{"text":"val result = persons.as(\"person\").join(addresses.as(\"address\"), $\"person.name\" === $\"address.name\")\nresult.toZeppelin()","dateUpdated":"2017-01-05T01:13:31-0800","config":{"colWidth":12,"graph":{"mode":"table","height":129,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{"xAxis":null,"yAxis":null}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483605296427_1960444806","id":"20170105-003456_603691475","result":{"code":"SUCCESS","type":"TABLE","msg":"age\theight\tname\tsex\tname\tcity\n23\t156\tAlice\tfemale\tAlice\tFrankfurt\n21\t181\tBob\tmale\tBob\tBerlin\n","comment":"","msgTable":[[{"key":"height","value":"23"},{"key":"height","value":"156"},{"key":"height","value":"Alice"},{"key":"height","value":"female"},{"key":"height","value":"Alice"},{"key":"height","value":"Frankfurt"}],[{"key":"name","value":"21"},{"key":"name","value":"181"},{"key":"name","value":"Bob"},{"key":"name","value":"male"},{"key":"name","value":"Bob"},{"key":"name","value":"Berlin"}]],"columnNames":[{"name":"age","index":0,"aggr":"sum"},{"name":"height","index":1,"aggr":"sum"},{"name":"name","index":2,"aggr":"sum"},{"name":"sex","index":3,"aggr":"sum"},{"name":"name","index":4,"aggr":"sum"},{"name":"city","index":5,"aggr":"sum"}],"rows":[["23","156","Alice","female","Alice","Frankfurt"],["21","181","Bob","male","Bob","Berlin"]]},"dateCreated":"2017-01-05T00:34:56-0800","dateStarted":"2017-01-05T01:13:31-0800","dateFinished":"2017-01-05T01:13:32-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11630","focus":true},{"text":"result","dateUpdated":"2017-01-05T01:13:36-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483605338050_-1070561057","id":"20170105-003538_2088315656","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres28: org.apache.spark.sql.DataFrame = [age: int, height: bigint ... 4 more fields]\n"},"dateCreated":"2017-01-05T00:35:38-0800","dateStarted":"2017-01-05T01:13:36-0800","dateFinished":"2017-01-05T01:13:36-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11631","focus":true},{"text":"%md\n## Dataset Grouping\n\nAlso grouping operations are supported, returning the special type \"GroupedData\".","dateUpdated":"2017-01-05T01:14:37-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164584_1377355418","id":"20160618-060107_408877976","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Dataset Grouping</h2>\n<p>Also grouping operations are supported, returning the special type &ldquo;GroupedData&rdquo;.</p>\n"},"dateCreated":"2017-01-05T00:16:04-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11632","dateFinished":"2017-01-05T01:14:34-0800","dateStarted":"2017-01-05T01:14:34-0800","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483607681123_658255837","id":"20170105-011441_1643155245","dateCreated":"2017-01-05T01:14:41-0800","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:15185","text":"persons.groupByKey(_.sex)","dateUpdated":"2017-01-05T01:14:52-0800","dateFinished":"2017-01-05T01:14:53-0800","dateStarted":"2017-01-05T01:14:53-0800","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres31: org.apache.spark.sql.KeyValueGroupedDataset[String,Person] = org.apache.spark.sql.KeyValueGroupedDataset@6689b0bd\n"}},{"text":"val result = persons.groupByKey(_.sex).agg(sum($\"age\").as(\"sum_age\").as[Long])\nresult.toZeppelin()","dateUpdated":"2017-01-05T01:14:59-0800","config":{"enabled":true,"graph":{"mode":"table","height":159,"optionOpen":false,"keys":[{"name":"value","index":0,"aggr":"sum"}],"values":[{"name":"sum_age","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"value","index":0,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164584_1377355418","id":"20160617-205426_874417461","result":{"code":"SUCCESS","type":"TABLE","msg":"value\tsum_age\nfemale\t97\nmale\t48\n","comment":"","msgTable":[[{"key":"sum_age","value":"female"},{"key":"sum_age","value":"97"}],[{"value":"male"},{"value":"48"}]],"columnNames":[{"name":"value","index":0,"aggr":"sum"},{"name":"sum_age","index":1,"aggr":"sum"}],"rows":[["female","97"],["male","48"]]},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:14:59-0800","dateFinished":"2017-01-05T01:15:02-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11633","focus":true},{"text":"result","dateUpdated":"2017-01-05T01:15:09-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483605493451_37193968","id":"20170105-003813_1445330503","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres35: org.apache.spark.sql.Dataset[(String, Long)] = [value: string, sum_age: bigint]\n"},"dateCreated":"2017-01-05T00:38:13-0800","dateStarted":"2017-01-05T01:15:09-0800","dateFinished":"2017-01-05T01:15:10-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11634","focus":true},{"text":"%md\n## DataFrame groupBy","dateUpdated":"2017-01-05T00:40:36-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483605591083_64031157","id":"20170105-003951_1649173549","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>DataFrame groupBy</h2>\n"},"dateCreated":"2017-01-05T00:39:51-0800","dateStarted":"2017-01-05T00:40:34-0800","dateFinished":"2017-01-05T00:40:34-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11635"},{"text":"val result = persons.groupBy($\"sex\").agg(sum($\"age\").as(\"sum_age\"))\nresult.toZeppelin()","dateUpdated":"2017-01-05T01:15:14-0800","config":{"colWidth":12,"graph":{"mode":"table","height":134,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483605605776_-555029823","id":"20170105-004005_1889169884","result":{"code":"SUCCESS","type":"TABLE","msg":"sex\tsum_age\nfemale\t97\nmale\t48\n","comment":"","msgTable":[[{"key":"sum_age","value":"female"},{"key":"sum_age","value":"97"}],[{"value":"male"},{"value":"48"}]],"columnNames":[{"name":"sex","index":0,"aggr":"sum"},{"name":"sum_age","index":1,"aggr":"sum"}],"rows":[["female","97"],["male","48"]]},"dateCreated":"2017-01-05T00:40:05-0800","dateStarted":"2017-01-05T01:15:14-0800","dateFinished":"2017-01-05T01:15:15-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11636","focus":true},{"text":"result","dateUpdated":"2017-01-05T01:15:19-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483605646970_-628254708","id":"20170105-004046_233218812","result":{"code":"SUCCESS","type":"TEXT","msg":"\nres39: org.apache.spark.sql.DataFrame = [sex: string, sum_age: bigint]\n"},"dateCreated":"2017-01-05T00:40:46-0800","dateStarted":"2017-01-05T01:15:19-0800","dateFinished":"2017-01-05T01:15:20-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11637","focus":true},{"text":"%md\n## Use groupByKey with mapGroups","dateUpdated":"2017-01-05T00:40:24-0800","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483605609784_2132672751","id":"20170105-004009_780928702","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Use groupByKey with mapGroups</h2>\n"},"dateCreated":"2017-01-05T00:40:09-0800","dateStarted":"2017-01-05T00:40:21-0800","dateFinished":"2017-01-05T00:40:21-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11638"},{"text":"def avg_age(persons:Iterator[Person]) = {\n    val (age,count) = persons\n        .map(p => (p.age,1))\n        .reduce((l,r) => (l._1 + r._1, l._2 + r._2))\n        \n    age.toFloat / count.toFloat\n}\n\npersons.groupByKey(_.sex)\n  .mapGroups { case (key,values) => (key, avg_age(values)) }\n  .toZeppelin()","dateUpdated":"2017-01-05T01:15:28-0800","config":{"enabled":true,"graph":{"mode":"table","height":154,"optionOpen":false,"keys":[{"name":"_1","index":0,"aggr":"sum"}],"values":[{"name":"_2","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"_1","index":0,"aggr":"sum"},"yAxis":{"name":"_2","index":1,"aggr":"sum"}}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164585_1376970669","id":"20160618-060120_1186022942","result":{"code":"SUCCESS","type":"TABLE","msg":"_1\t_2\nfemale\t24.25\nmale\t24.0\n","comment":"","msgTable":[[{"key":"_2","value":"female"},{"key":"_2","value":"24.25"}],[{"value":"male"},{"value":"24.0"}]],"columnNames":[{"name":"_1","index":0,"aggr":"sum"},{"name":"_2","index":1,"aggr":"sum"}],"rows":[["female","24.25"],["male","24.0"]]},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:15:28-0800","dateFinished":"2017-01-05T01:15:30-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11639","focus":true},{"text":"%md\n## Convert to RDD\n\nYou can convert a Dataset to a simpler RDD. This will finally drop unused columns.","dateUpdated":"2017-01-05T01:16:16-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164585_1376970669","id":"20160617-201355_1310344176","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Convert to RDD</h2>\n<p>You can convert a Dataset to a simpler RDD. This will finally drop unused columns.</p>\n"},"dateCreated":"2017-01-05T00:16:04-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11640","dateFinished":"2017-01-05T01:16:12-0800","dateStarted":"2017-01-05T01:16:12-0800","focus":true},{"text":"val rdd = persons.rdd\n\nrdd.collect().foreach(println)","dateUpdated":"2017-01-05T01:15:39-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164586_1378124916","id":"20160618-053912_1439030409","result":{"code":"SUCCESS","type":"TEXT","msg":"\nrdd: org.apache.spark.rdd.RDD[Person] = MapPartitionsRDD[45] at rdd at <console>:34\nPerson(Alice,female,23)\nPerson(Bob,male,21)\nPerson(Charlie,male,27)\nPerson(Eve,female,24)\nPerson(Frances,female,19)\nPerson(George,female,31)\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:15:39-0800","dateFinished":"2017-01-05T01:15:40-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11641","focus":true},{"text":"%md\n## Convert back RDD to Dataset\n\nNote that the Dataset will not contain the unused column \"height\" any more.","dateUpdated":"2017-01-05T01:16:47-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164586_1378124916","id":"20160618-053953_1578828210","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Convert back RDD to Dataset</h2>\n<p>Note that the Dataset will not contain the unused column &ldquo;height&rdquo; any more.</p>\n"},"dateCreated":"2017-01-05T00:16:04-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11642","dateFinished":"2017-01-05T01:16:43-0800","dateStarted":"2017-01-05T01:16:43-0800","focus":true},{"text":"val ds = rdd.toDS","dateUpdated":"2017-01-05T01:16:19-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164587_1377740167","id":"20160618-053926_647385200","result":{"code":"SUCCESS","type":"TEXT","msg":"\nds: org.apache.spark.sql.Dataset[Person] = [name: string, sex: string ... 1 more field]\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:16:19-0800","dateFinished":"2017-01-05T01:16:20-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11643","focus":true},{"text":"%md\n## Write to Parquet\n\n1. Get DataFrame writer\n2. Write Dataset to Parquet\n\nNote that this will also write unused columns!","dateUpdated":"2017-01-05T01:17:48-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164587_1377740167","id":"20160617-201512_1954263996","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Write to Parquet</h2>\n<ol>\n<li>Get DataFrame writer</li>\n<li>Write Dataset to Parquet</li>\n</ol>\n<p>Note that this will also write unused columns!</p>\n"},"dateCreated":"2017-01-05T00:16:04-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11644","dateFinished":"2017-01-05T01:17:45-0800","dateStarted":"2017-01-05T01:17:45-0800","focus":true},{"text":"import org.apache.spark.sql.SaveMode\n\npersons.write.mode(SaveMode.Overwrite).parquet(\"persons.parquet\")","dateUpdated":"2017-01-05T01:16:54-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164587_1377740167","id":"20160617-201343_563402997","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.SaveMode\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:16:54-0800","dateFinished":"2017-01-05T01:16:55-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11645","focus":true},{"text":"%md\n## Read from Parquet\n1. Read DataFrame from Parquet\n2. Convert DataFrame to DataSet\n\nSee the unused column \"height\" reappear aggain.","dateUpdated":"2017-01-05T01:18:17-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164588_1375816422","id":"20160617-204919_1431109393","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Read from Parquet</h2>\n<ol>\n<li>Read DataFrame from Parquet</li>\n<li>Convert DataFrame to DataSet</li>\n</ol>\n<p>See the unused column &ldquo;height&rdquo; reappear aggain.</p>\n"},"dateCreated":"2017-01-05T00:16:04-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11646","dateFinished":"2017-01-05T01:18:13-0800","dateStarted":"2017-01-05T01:18:13-0800","focus":true},{"text":"val df = sqlContext.read.parquet(\"persons.parquet\")\nval ds = df.as[Person]\n\nds.toZeppelin()","dateUpdated":"2017-01-05T01:17:00-0800","config":{"enabled":true,"graph":{"mode":"table","height":244,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{"xAxis":null,"yAxis":null}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164588_1375816422","id":"20160617-204932_794634446","result":{"code":"SUCCESS","type":"TABLE","msg":"age\theight\tname\tsex\n23\t156\tAlice\tfemale\n21\t181\tBob\tmale\n27\t176\tCharlie\tmale\n24\t167\tEve\tfemale\n19\t172\tFrances\tfemale\n31\t191\tGeorge\tfemale\n","comment":"","msgTable":[[{"key":"height","value":"23"},{"key":"height","value":"156"},{"key":"height","value":"Alice"},{"key":"height","value":"female"}],[{"key":"name","value":"21"},{"key":"name","value":"181"},{"key":"name","value":"Bob"},{"key":"name","value":"male"}],[{"key":"sex","value":"27"},{"key":"sex","value":"176"},{"key":"sex","value":"Charlie"},{"key":"sex","value":"male"}],[{"value":"24"},{"value":"167"},{"value":"Eve"},{"value":"female"}],[{"value":"19"},{"value":"172"},{"value":"Frances"},{"value":"female"}],[{"value":"31"},{"value":"191"},{"value":"George"},{"value":"female"}]],"columnNames":[{"name":"age","index":0,"aggr":"sum"},{"name":"height","index":1,"aggr":"sum"},{"name":"name","index":2,"aggr":"sum"},{"name":"sex","index":3,"aggr":"sum"}],"rows":[["23","156","Alice","female"],["21","181","Bob","male"],["27","176","Charlie","male"],["24","167","Eve","female"],["19","172","Frances","female"],["31","191","George","female"]]},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:17:00-0800","dateFinished":"2017-01-05T01:17:02-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11647","focus":true},{"text":"%md\n# Nested Classes","dateUpdated":"2017-01-05T00:16:04-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164589_1375431673","id":"20160617-202215_225550959","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Nested Classes</h1>\n"},"dateCreated":"2017-01-05T00:16:04-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11648"},{"text":"case class Address(\n    city:String,\n    street:String\n)\n    \ncase class Person(\n    name:String,\n    sex:String,\n    addresses:Array[Address]\n)\n","dateUpdated":"2017-01-05T01:18:24-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164589_1375431673","id":"20160618-093335_468111792","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class Address\n\ndefined class Person\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:18:24-0800","dateFinished":"2017-01-05T01:18:24-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11649","focus":true},{"text":"val ds = Seq(\n    Person(\"Alice\",\"female\",Array(Address(\"Berlin\",\"Hauptstraße 2\"),Address(\"Stuttgart\",\"Am Anger 13\"))),\n    Person(\"Bob\",\"male\",Array(Address(\"Mainz\",\"Kellergasse 23\")))\n).toDS","dateUpdated":"2017-01-05T01:18:27-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164590_1376585920","id":"20160618-093452_1868521561","result":{"code":"SUCCESS","type":"TEXT","msg":"\nds: org.apache.spark.sql.Dataset[Person] = [name: string, sex: string ... 1 more field]\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:18:28-0800","dateFinished":"2017-01-05T01:18:28-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11650","focus":true},{"text":"ds.printSchema()","dateUpdated":"2017-01-05T01:18:32-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164590_1376585920","id":"20160618-093933_727106056","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- name: string (nullable = true)\n |-- sex: string (nullable = true)\n |-- addresses: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- city: string (nullable = true)\n |    |    |-- street: string (nullable = true)\n\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:18:32-0800","dateFinished":"2017-01-05T01:18:33-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11651","focus":true},{"text":"import org.apache.spark.sql.SaveMode\n\nds.write.mode(SaveMode.Overwrite).parquet(\"persons2.parquet\")","dateUpdated":"2017-01-05T01:18:38-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164591_1376201171","id":"20160618-093622_1119250452","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.SaveMode\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:18:38-0800","dateFinished":"2017-01-05T01:18:40-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11652","focus":true},{"text":"val ds = sqlContext.read.parquet(\"persons2.parquet\").as[Person]\n\nds.collect().map(p => p.addresses.size).reduce(_ + _)","dateUpdated":"2017-01-05T01:18:43-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164591_1376201171","id":"20160618-093745_1829082972","result":{"code":"SUCCESS","type":"TEXT","msg":"\nds: org.apache.spark.sql.Dataset[Person] = [name: string, sex: string ... 1 more field]\n\nres56: Int = 3\n"},"dateCreated":"2017-01-05T00:16:04-0800","dateStarted":"2017-01-05T01:18:43-0800","dateFinished":"2017-01-05T01:18:45-0800","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:11653","focus":true},{"text":"","dateUpdated":"2017-01-05T00:22:42-0800","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"colWidth":12,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1483604164592_1386589391","id":"20160618-093840_324274912","dateCreated":"2017-01-05T00:16:04-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:11654"}],"name":"Spark DataSet Snippets","id":"2C6MBMXC2","angularObjects":{"2C7PVCCMW:shared_process":[],"2C7N8FNUK:shared_process":[],"2C4ZABBYG:shared_process":[],"2C7NHPHKH:shared_process":[],"2C4ACPMVH:shared_process":[],"2C5JAXWD8:shared_process":[],"2C68PFPBP:shared_process":[],"2C6BVC9ES:shared_process":[],"2C66FR28V:shared_process":[],"2C4Y5MV3V:shared_process":[],"2C6KQ2GNT:shared_process":[],"2C78K3BRW:shared_process":[],"2C81FGN7P:shared_process":[],"2C5BQGTGT:shared_process":[],"2C7VFSCFR:shared_process":[],"2C5MXJ5D6:shared_process":[],"2C44EB781:shared_process":[],"2C4JS2HDQ:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}