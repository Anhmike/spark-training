{"paragraphs":[{"text":"%md\n# Load Dependencies\nFirst we have to load additional dependencies that we want to use. In this case we want to use a CSV parser.","dateUpdated":"Jun 12, 2016 1:00:01 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635508675_-1094466082","id":"20160611-085828_627004083","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Load Dependencies</h1>\n<p>First we have to load additional dependencies that we want to use. In this case we want to use a CSV parser.</p>\n"},"dateCreated":"Jun 11, 2016 8:58:28 AM","dateStarted":"Jun 12, 2016 1:00:01 PM","dateFinished":"Jun 12, 2016 1:00:01 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:86"},{"text":"%dep\nz.load(\"com.databricks:spark-csv_2.10:1.4.0\")","dateUpdated":"Jun 11, 2016 8:59:08 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635524984_1132875949","id":"20160611-085844_953887614","dateCreated":"Jun 11, 2016 8:58:44 AM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:87"},{"text":"%md\n# Creating a DataFrame","dateUpdated":"Jun 12, 2016 1:00:04 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465736388622_-509647808","id":"20160612-125948_2027140278","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Creating a DataFrame</h1>\n"},"dateCreated":"Jun 12, 2016 12:59:48 PM","dateStarted":"Jun 12, 2016 1:00:01 PM","dateFinished":"Jun 12, 2016 1:00:01 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:88"},{"text":"val df = sqlContext.createDataFrame(Array((\"Alice\", 13), (\"Bob\", 12)))\ndf.collect().foreach(println)","dateUpdated":"Jun 12, 2016 3:07:42 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465736406178_1424130812","id":"20160612-130006_416625952","result":{"code":"SUCCESS","type":"TEXT","msg":"df: org.apache.spark.sql.DataFrame = [_1: string, _2: int]\n[Alice,13]\n[Bob,12]\n"},"dateCreated":"Jun 12, 2016 1:00:06 PM","dateStarted":"Jun 12, 2016 3:07:42 PM","dateFinished":"Jun 12, 2016 3:07:42 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:89"},{"text":"df.printSchema()","dateUpdated":"Jun 12, 2016 3:07:46 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744053468_-1115778702","id":"20160612-150733_816863585","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- _1: string (nullable = true)\n |-- _2: integer (nullable = false)\n\n"},"dateCreated":"Jun 12, 2016 3:07:33 PM","dateStarted":"Jun 12, 2016 3:07:46 PM","dateFinished":"Jun 12, 2016 3:07:46 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:90"},{"text":"case class Person(\n    name:String,\n    age:Int\n) { }\n\nval df = sqlContext.createDataFrame(Array(Person(\"Alice\", 13), Person(\"Bob\", 12)))\n\ndf.collect().foreach(println)","dateUpdated":"Jun 12, 2016 3:17:52 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465743909564_1779255912","id":"20160612-150509_1437708850","result":{"code":"SUCCESS","type":"TEXT","msg":"defined class Person\ndf: org.apache.spark.sql.DataFrame = [name: string, age: int]\n[Alice,13]\n[Bob,12]\n"},"dateCreated":"Jun 12, 2016 3:05:09 PM","dateStarted":"Jun 12, 2016 3:17:52 PM","dateFinished":"Jun 12, 2016 3:17:52 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:91"},{"text":"df.printSchema()","dateUpdated":"Jun 12, 2016 3:17:54 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744660730_1499012049","id":"20160612-151740_420873295","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- name: string (nullable = true)\n |-- age: integer (nullable = false)\n\n"},"dateCreated":"Jun 12, 2016 3:17:40 PM","dateStarted":"Jun 12, 2016 3:17:54 PM","dateFinished":"Jun 12, 2016 3:17:55 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:92"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466194640746_-1929604116","id":"20160617-201720_142048293","dateCreated":"Jun 17, 2016 8:17:20 PM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1327","text":"val df = Seq(Person(\"Alice\", 13), Person(\"Bob\", 12)).toDF","dateUpdated":"Jun 17, 2016 8:17:47 PM","dateFinished":"Jun 17, 2016 8:17:48 PM","dateStarted":"Jun 17, 2016 8:17:48 PM","result":{"code":"SUCCESS","type":"TEXT","msg":"df: org.apache.spark.sql.DataFrame = [name: string, age: int]\n"}},{"text":"%md\n## Create DataFrame from RDD","dateUpdated":"Jun 12, 2016 3:14:47 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744475224_-1207937837","id":"20160612-151435_1007185367","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Create DataFrame from RDD</h2>\n"},"dateCreated":"Jun 12, 2016 3:14:35 PM","dateStarted":"Jun 12, 2016 3:14:44 PM","dateFinished":"Jun 12, 2016 3:14:44 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:93"},{"text":"val rdd = sc.parallelize(Array(Person(\"Alice\", 13), Person(\"Bob\", 12)))\nval df = sqlContext.createDataFrame(rdd)\n\ndf.collect().foreach(println)","dateUpdated":"Jun 12, 2016 3:07:13 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465743998697_1155886073","id":"20160612-150638_1523664879","result":{"code":"SUCCESS","type":"TEXT","msg":"rdd: org.apache.spark.rdd.RDD[Person] = ParallelCollectionRDD[232] at parallelize at <console>:31\ndf: org.apache.spark.sql.DataFrame = [name: string, age: int]\n[Alice,13]\n[Bob,12]\n"},"dateCreated":"Jun 12, 2016 3:06:38 PM","dateStarted":"Jun 12, 2016 3:07:13 PM","dateFinished":"Jun 12, 2016 3:07:21 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:94"},{"text":"val rdd = sc.parallelize(Array(Person(\"Alice\", 13), Person(\"Bob\", 12)))\nval df = rdd.toDF()\n\ndf.collect().foreach(println)","dateUpdated":"Jun 12, 2016 3:28:24 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465745288575_-523491970","id":"20160612-152808_868719593","result":{"code":"SUCCESS","type":"TEXT","msg":"rdd: org.apache.spark.rdd.RDD[Person] = ParallelCollectionRDD[242] at parallelize at <console>:81\ndf: org.apache.spark.sql.DataFrame = [name: string, age: int]\n[Alice,13]\n[Bob,12]\n"},"dateCreated":"Jun 12, 2016 3:28:08 PM","dateStarted":"Jun 12, 2016 3:28:24 PM","dateFinished":"Jun 12, 2016 3:28:31 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:95"},{"text":"import org.apache.spark.sql.Row\nimport org.apache.spark.sql.types._\n\nval rdd = sc.parallelize(\n    Array(\n        Row(\"Alice\", 13), \n        Row(\"Bob\", 12)\n    ))\nval schema = StructType(\n    StructField(\"name\", StringType, true) ::\n    StructField(\"age\", IntegerType, true) ::\n    Nil\n)\nval df = sqlContext.createDataFrame(rdd, schema)\n\ndf.collect().foreach(println)","dateUpdated":"Jun 12, 2016 3:18:13 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744068760_1590575709","id":"20160612-150748_776002189","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql.Row\nimport org.apache.spark.sql.types._\nrdd: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = ParallelCollectionRDD[239] at parallelize at <console>:58\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(name,StringType,true), StructField(age,IntegerType,true))\ndf: org.apache.spark.sql.DataFrame = [name: string, age: int]\n[Alice,13]\n[Bob,12]\n"},"dateCreated":"Jun 12, 2016 3:07:48 PM","dateStarted":"Jun 12, 2016 3:18:13 PM","dateFinished":"Jun 12, 2016 3:18:21 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:96"},{"text":"df.printSchema()","dateUpdated":"Jun 12, 2016 3:18:22 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744691317_-170166597","id":"20160612-151811_1726581061","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- name: string (nullable = true)\n |-- age: integer (nullable = true)\n\n"},"dateCreated":"Jun 12, 2016 3:18:11 PM","dateStarted":"Jun 12, 2016 3:18:22 PM","dateFinished":"Jun 12, 2016 3:18:22 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:97"},{"text":"%md\n## Accessing the RDD in the DataFrame","dateUpdated":"Jun 12, 2016 3:16:33 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744402376_-1851546126","id":"20160612-151322_1187613408","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Accessing the RDD in the DataFrame</h2>\n"},"dateCreated":"Jun 12, 2016 3:13:22 PM","dateStarted":"Jun 12, 2016 3:16:33 PM","dateFinished":"Jun 12, 2016 3:16:33 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98"},{"text":"val rdd = df.rdd\n\nrdd.collect().foreach(println)","dateUpdated":"Jun 12, 2016 3:14:06 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744413607_1275708258","id":"20160612-151333_943343452","result":{"code":"SUCCESS","type":"TEXT","msg":"rdd: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[238] at rdd at <console>:60\n[Alice,13]\n[Bob,12]\n"},"dateCreated":"Jun 12, 2016 3:13:33 PM","dateStarted":"Jun 12, 2016 3:14:06 PM","dateFinished":"Jun 12, 2016 3:14:06 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:99"},{"text":"%md\n# Pretty Printing","dateUpdated":"Jun 11, 2016 8:59:20 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635540345_-2058216104","id":"20160611-085900_116012142","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Pretty Printing</h1>\n"},"dateCreated":"Jun 11, 2016 8:59:00 AM","dateStarted":"Jun 11, 2016 8:59:18 AM","dateFinished":"Jun 11, 2016 8:59:18 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:100"},{"text":"import org.apache.spark.sql.DataFrame\n\nimplicit class ZeppelinOutput(df:DataFrame) {\n    def toZeppelin(limit:Int = -1)  = {\n        println(\"%table\")\n        println(df.schema.map(_.name).mkString(\"\\t\"))\n        val data = if (limit <= 0) df else df.limit(limit)\n        data.collect.foreach(row => println(row.mkString(\"\\t\")))\n    }\n}","dateUpdated":"Jun 12, 2016 3:20:51 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465635558182_1234110883","id":"20160611-085918_1891664968","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql.DataFrame\ndefined class ZeppelinOutput\n"},"dateCreated":"Jun 11, 2016 8:59:18 AM","dateStarted":"Jun 12, 2016 3:20:51 PM","dateFinished":"Jun 12, 2016 3:20:51 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:101"},{"text":"%md\n# Selecting Columns","dateUpdated":"Jun 12, 2016 3:16:38 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744581193_-1261632473","id":"20160612-151621_251190447","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Selecting Columns</h1>\n"},"dateCreated":"Jun 12, 2016 3:16:21 PM","dateStarted":"Jun 12, 2016 3:16:33 PM","dateFinished":"Jun 12, 2016 3:16:33 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:102"},{"text":"import org.apache.spark.sql.functions._\n\nval df = sqlContext.createDataFrame(Array(Person(\"Alice\", 13), Person(\"Bob\", 12)))\nval result = df.select(\"name\")\n\nresult.toZeppelin()\n","dateUpdated":"Jun 12, 2016 3:34:54 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744593728_1559361787","id":"20160612-151633_1423873011","result":{"code":"SUCCESS","type":"TABLE","msg":"name\nAlice\nBob\n","comment":"","msgTable":[[{"value":"Alice"}],[{"value":"Bob"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"}],"rows":[["Alice"],["Bob"]]},"dateCreated":"Jun 12, 2016 3:16:33 PM","dateStarted":"Jun 12, 2016 3:21:11 PM","dateFinished":"Jun 12, 2016 3:21:12 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:103"},{"text":"val df = sqlContext.createDataFrame(Array(Person(\"Alice\", 13), Person(\"Bob\", 12)))\nval result = df.select($\"age\", col(\"name\"), 'age)\n\nresult.toZeppelin()\n","dateUpdated":"Jun 12, 2016 3:34:54 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744801762_1036760054","id":"20160612-152001_527472554","result":{"code":"SUCCESS","type":"TABLE","msg":"age\tname\tage\n13\tAlice\t13\n12\tBob\t12\n","comment":"","msgTable":[[{"key":"name","value":"13"},{"key":"name","value":"Alice"},{"key":"name","value":"13"}],[{"key":"age","value":"12"},{"key":"age","value":"Bob"},{"key":"age","value":"12"}]],"columnNames":[{"name":"age","index":0,"aggr":"sum"},{"name":"name","index":1,"aggr":"sum"},{"name":"age","index":2,"aggr":"sum"}],"rows":[["13","Alice","13"],["12","Bob","12"]]},"dateCreated":"Jun 12, 2016 3:20:01 PM","dateStarted":"Jun 12, 2016 3:21:40 PM","dateFinished":"Jun 12, 2016 3:21:41 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:104"},{"text":"val df = sqlContext.createDataFrame(Array(Person(\"Alice\", 13), Person(\"Bob\", 12)))\nval result = df.select(df(\"age\"), df(\"name\"))\n\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:35:08 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465745686827_2076594004","id":"20160612-153446_1336055587","result":{"code":"SUCCESS","type":"TABLE","msg":"age\tname\n13\tAlice\n12\tBob\n","comment":"","msgTable":[[{"key":"name","value":"13"},{"key":"name","value":"Alice"}],[{"value":"12"},{"value":"Bob"}]],"columnNames":[{"name":"age","index":0,"aggr":"sum"},{"name":"name","index":1,"aggr":"sum"}],"rows":[["13","Alice"],["12","Bob"]]},"dateCreated":"Jun 12, 2016 3:34:46 PM","dateStarted":"Jun 12, 2016 3:35:08 PM","dateFinished":"Jun 12, 2016 3:35:09 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:105"},{"text":"%md\n# Injecting Literals","dateUpdated":"Jun 12, 2016 3:22:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744900304_-916873912","id":"20160612-152140_1844336454","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Injecting Literals</h1>\n"},"dateCreated":"Jun 12, 2016 3:21:40 PM","dateStarted":"Jun 12, 2016 3:22:00 PM","dateFinished":"Jun 12, 2016 3:22:00 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:106"},{"text":"val df = sqlContext.createDataFrame(Array(Person(\"Alice\", 13), Person(\"Bob\", 12)))\nval result = df.select(concat(lit(\"Name:\"), col(\"name\"), lit(\" Age:\"), $\"age\") as \"description\")\n\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:34:54 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744920160_1498610331","id":"20160612-152200_1663756389","result":{"code":"SUCCESS","type":"TABLE","msg":"description\nName:Alice Age:13\nName:Bob Age:12\n","comment":"","msgTable":[[{"value":"Name:Alice Age:13"}],[{"value":"Name:Bob Age:12"}]],"columnNames":[{"name":"description","index":0,"aggr":"sum"}],"rows":[["Name:Alice Age:13"],["Name:Bob Age:12"]]},"dateCreated":"Jun 12, 2016 3:22:00 PM","dateStarted":"Jun 12, 2016 3:23:29 PM","dateFinished":"Jun 12, 2016 3:23:30 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:107"},{"text":"%md\n# Simple Transformations","dateUpdated":"Jun 12, 2016 3:24:02 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465744974153_-289040328","id":"20160612-152254_458521436","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Simple Transformations</h1>\n"},"dateCreated":"Jun 12, 2016 3:22:54 PM","dateStarted":"Jun 12, 2016 3:23:58 PM","dateFinished":"Jun 12, 2016 3:23:58 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:108"},{"text":"val df = sqlContext.createDataFrame(Array(Person(\"Alice\", 13), Person(\"Bob\", 12)))\nval result = df.select('name, upper('name).alias(\"upper_name\"))\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:24:51 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465745038486_-32904829","id":"20160612-152358_839240513","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tupper_name\nAlice\tALICE\nBob\tBOB\n","comment":"","msgTable":[[{"key":"upper_name","value":"Alice"},{"key":"upper_name","value":"ALICE"}],[{"value":"Bob"},{"value":"BOB"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"upper_name","index":1,"aggr":"sum"}],"rows":[["Alice","ALICE"],["Bob","BOB"]]},"dateCreated":"Jun 12, 2016 3:23:58 PM","dateStarted":"Jun 12, 2016 3:24:51 PM","dateFinished":"Jun 12, 2016 3:24:52 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:109"},{"text":"val df = sqlContext.createDataFrame(Array(Person(\"Alice\", 13), Person(\"Bob\", 12)))\nval result = df.select('name, ($\"age\" * 2).alias(\"double_age\"))\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:31:44 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"name","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"name","index":0,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465745075788_-469148785","id":"20160612-152435_1333366716","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tdouble_age\nAlice\t26\nBob\t24\n","comment":"","msgTable":[[{"key":"double_age","value":"Alice"},{"key":"double_age","value":"26"}],[{"value":"Bob"},{"value":"24"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"double_age","index":1,"aggr":"sum"}],"rows":[["Alice","26"],["Bob","24"]]},"dateCreated":"Jun 12, 2016 3:24:35 PM","dateStarted":"Jun 12, 2016 3:31:44 PM","dateFinished":"Jun 12, 2016 3:31:45 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:110"},{"text":"val df = sc.parallelize(1 to 10).toDF.select($\"_1\" as \"number\")\nval result = df.select(\n        $\"number\",\n        when($\"number\" % 2 === 0, \"even\").otherwise(\"odd\").alias(\"text\")\n    )\n    \nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:30:49 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465745124773_1344450260","id":"20160612-152524_1040140298","result":{"code":"SUCCESS","type":"TABLE","msg":"number\ttext\n1\todd\n2\teven\n3\todd\n4\teven\n5\todd\n6\teven\n7\todd\n8\teven\n9\todd\n10\teven\n","comment":"","msgTable":[[{"key":"text","value":"1"},{"key":"text","value":"odd"}],[{"value":"2"},{"value":"even"}],[{"value":"3"},{"value":"odd"}],[{"value":"4"},{"value":"even"}],[{"value":"5"},{"value":"odd"}],[{"value":"6"},{"value":"even"}],[{"value":"7"},{"value":"odd"}],[{"value":"8"},{"value":"even"}],[{"value":"9"},{"value":"odd"}],[{"value":"10"},{"value":"even"}]],"columnNames":[{"name":"number","index":0,"aggr":"sum"},{"name":"text","index":1,"aggr":"sum"}],"rows":[["1","odd"],["2","even"],["3","odd"],["4","even"],["5","odd"],["6","even"],["7","odd"],["8","even"],["9","odd"],["10","even"]]},"dateCreated":"Jun 12, 2016 3:25:24 PM","dateStarted":"Jun 12, 2016 3:30:49 PM","dateFinished":"Jun 12, 2016 3:30:56 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:111"},{"text":"%md\n# Adding Columns","dateUpdated":"Jun 17, 2016 4:26:07 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180757459_-923931565","id":"20160617-162557_838805065","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Adding Columns</h1>\n"},"dateCreated":"Jun 17, 2016 4:25:57 PM","dateStarted":"Jun 17, 2016 4:26:04 PM","dateFinished":"Jun 17, 2016 4:26:04 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:112"},{"text":"val df = sqlContext.range(1, 10).select($\"id\" as \"number\")\nval result = df.withColumn(\"text\", when($\"number\" % 2 === 0, \"even\").otherwise(\"odd\"))\n\nresult.toZeppelin()","dateUpdated":"Jun 17, 2016 4:31:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"number","index":0,"aggr":"sum"}],"values":[{"name":"text","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"number","index":0,"aggr":"sum"},"yAxis":{"name":"text","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180770170_1999991510","id":"20160617-162610_764186088","result":{"code":"SUCCESS","type":"TABLE","msg":"number\ttext\n1\todd\n2\teven\n3\todd\n4\teven\n5\todd\n6\teven\n7\todd\n8\teven\n9\todd\n","comment":"","msgTable":[[{"key":"text","value":"1"},{"key":"text","value":"odd"}],[{"value":"2"},{"value":"even"}],[{"value":"3"},{"value":"odd"}],[{"value":"4"},{"value":"even"}],[{"value":"5"},{"value":"odd"}],[{"value":"6"},{"value":"even"}],[{"value":"7"},{"value":"odd"}],[{"value":"8"},{"value":"even"}],[{"value":"9"},{"value":"odd"}]],"columnNames":[{"name":"number","index":0,"aggr":"sum"},{"name":"text","index":1,"aggr":"sum"}],"rows":[["1","odd"],["2","even"],["3","odd"],["4","even"],["5","odd"],["6","even"],["7","odd"],["8","even"],["9","odd"]]},"dateCreated":"Jun 17, 2016 4:26:10 PM","dateStarted":"Jun 17, 2016 4:31:03 PM","dateFinished":"Jun 17, 2016 4:31:04 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:113"},{"text":"%md\n# Dropping Columns","dateUpdated":"Jun 17, 2016 4:27:48 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180853442_-1627349957","id":"20160617-162733_380188317","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Dropping Columns</h1>\n"},"dateCreated":"Jun 17, 2016 4:27:33 PM","dateStarted":"Jun 17, 2016 4:27:44 PM","dateFinished":"Jun 17, 2016 4:27:44 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:114"},{"text":"val result2 = result.drop(\"number\")\nresult2.toZeppelin()","dateUpdated":"Jun 17, 2016 4:29:29 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{"xAxis":null,"yAxis":null}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180870774_-224894243","id":"20160617-162750_466208521","result":{"code":"SUCCESS","type":"TABLE","msg":"text\nodd\neven\nodd\neven\nodd\neven\nodd\neven\nodd\n","comment":"","msgTable":[[{"value":"odd"}],[{"value":"even"}],[{"value":"odd"}],[{"value":"even"}],[{"value":"odd"}],[{"value":"even"}],[{"value":"odd"}],[{"value":"even"}],[{"value":"odd"}]],"columnNames":[{"name":"text","index":0,"aggr":"sum"}],"rows":[["odd"],["even"],["odd"],["even"],["odd"],["even"],["odd"],["even"],["odd"]]},"dateCreated":"Jun 17, 2016 4:27:50 PM","dateStarted":"Jun 17, 2016 4:29:29 PM","dateFinished":"Jun 17, 2016 4:29:29 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:115"},{"text":"%md\n# Filtering","dateUpdated":"Jun 12, 2016 3:32:13 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465745431847_1251521628","id":"20160612-153031_659656525","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Filtering</h1>\n"},"dateCreated":"Jun 12, 2016 3:30:31 PM","dateStarted":"Jun 12, 2016 3:32:09 PM","dateFinished":"Jun 12, 2016 3:32:09 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:116"},{"text":"val df = sqlContext.createDataFrame(Array(Person(\"Alice\", 13), Person(\"Bob\", 12)))\nval result = df.filter($\"age\" > 12)\n\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:36:06 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465745748258_1957984073","id":"20160612-153548_1115248994","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tage\nAlice\t13\n","comment":"","msgTable":[[{"key":"age","value":"Alice"},{"key":"age","value":"13"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"age","index":1,"aggr":"sum"}],"rows":[["Alice","13"]]},"dateCreated":"Jun 12, 2016 3:35:48 PM","dateStarted":"Jun 12, 2016 3:36:06 PM","dateFinished":"Jun 12, 2016 3:36:14 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:117"},{"text":"val df = sqlContext.createDataFrame(Array(Person(\"Alice\", 13), Person(\"Bob\", 12)))\nval result = df.filter(\"age > 12\")\n\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:32:53 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465745529871_884809953","id":"20160612-153209_1553421093","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tage\nAlice\t13\n","comment":"","msgTable":[[{"key":"age","value":"Alice"},{"key":"age","value":"13"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"age","index":1,"aggr":"sum"}],"rows":[["Alice","13"]]},"dateCreated":"Jun 12, 2016 3:32:09 PM","dateStarted":"Jun 12, 2016 3:32:53 PM","dateFinished":"Jun 12, 2016 3:33:00 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:118"},{"text":"%md\n# Aggregations","dateUpdated":"Jun 12, 2016 3:37:52 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465745573244_42102593","id":"20160612-153253_1859986543","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Aggregations</h1>\n"},"dateCreated":"Jun 12, 2016 3:32:53 PM","dateStarted":"Jun 12, 2016 3:37:47 PM","dateFinished":"Jun 12, 2016 3:37:47 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:119"},{"text":"val df = sc.parallelize(1 to 100).toDF.select($\"_1\" as \"value\")\nval result = df.select(\n    sum('value).alias(\"sum\"), \n    avg('value).alias(\"avg\"), \n    min('value).alias(\"min\"), \n    max('value).alias(\"max\"), \n    count('value).alias(\"count\")\n)\n\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:40:04 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465745867656_-2010130548","id":"20160612-153747_1650442270","result":{"code":"SUCCESS","type":"TABLE","msg":"sum\tavg\tmin\tmax\tcount\n5050\t50.5\t1\t100\t100\n","comment":"","msgTable":[[{"key":"avg","value":"5050"},{"key":"avg","value":"50.5"},{"key":"avg","value":"1"},{"key":"avg","value":"100"},{"key":"avg","value":"100"}]],"columnNames":[{"name":"sum","index":0,"aggr":"sum"},{"name":"avg","index":1,"aggr":"sum"},{"name":"min","index":2,"aggr":"sum"},{"name":"max","index":3,"aggr":"sum"},{"name":"count","index":4,"aggr":"sum"}],"rows":[["5050","50.5","1","100","100"]]},"dateCreated":"Jun 12, 2016 3:37:47 PM","dateStarted":"Jun 12, 2016 3:40:04 PM","dateFinished":"Jun 12, 2016 3:40:11 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:120"},{"text":"df.count()","dateUpdated":"Jun 12, 2016 3:40:30 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746004057_-581406285","id":"20160612-154004_869347895","result":{"code":"SUCCESS","type":"TEXT","msg":"res207: Long = 100\n"},"dateCreated":"Jun 12, 2016 3:40:04 PM","dateStarted":"Jun 12, 2016 3:40:30 PM","dateFinished":"Jun 12, 2016 3:40:31 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:121"},{"text":"%md\n# Making Data Distinct","dateUpdated":"Jun 12, 2016 3:41:01 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746030349_-1922610302","id":"20160612-154030_610244901","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Making Data Distinct</h1>\n"},"dateCreated":"Jun 12, 2016 3:40:30 PM","dateStarted":"Jun 12, 2016 3:40:58 PM","dateFinished":"Jun 12, 2016 3:40:58 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:122"},{"text":"val df = sc.parallelize(Array(\"Alice\",\"Bob\",\"Alice\")).toDF\nval result = df.distinct()\n\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:42:53 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746035180_-963800719","id":"20160612-154035_439876147","result":{"code":"SUCCESS","type":"TABLE","msg":"_1\nAlice\nBob\n","comment":"","msgTable":[[{"value":"Alice"}],[{"value":"Bob"}]],"columnNames":[{"name":"_1","index":0,"aggr":"sum"}],"rows":[["Alice"],["Bob"]]},"dateCreated":"Jun 12, 2016 3:40:35 PM","dateStarted":"Jun 12, 2016 3:42:53 PM","dateFinished":"Jun 12, 2016 3:43:01 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123"},{"text":"%md\n# Grouping and Aggregating","dateUpdated":"Jun 12, 2016 3:43:32 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746122515_-257447711","id":"20160612-154202_1946092920","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Grouping and Aggregating</h1>\n"},"dateCreated":"Jun 12, 2016 3:42:02 PM","dateStarted":"Jun 12, 2016 3:43:28 PM","dateFinished":"Jun 12, 2016 3:43:28 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:124"},{"text":"case class Person(\n    name:String,\n    gender:String,\n    age:Int,\n    height:Int) \n{ }\n\nval persons = sqlContext.createDataFrame(\n    Array(\n        Person(\"Bob\",\"male\",13,146),\n        Person(\"Alive\",\"female\",42,159),\n        Person(\"Eve\",\"female\",19,169),\n        Person(\"Cyrus\",\"male\",27,178),\n        Person(\"Dan\",\"male\",32,186),\n        Person(\"Fiona\",\"female\",23,166)\n    )\n)\n\npersons.toZeppelin()","dateUpdated":"Jun 17, 2016 4:17:31 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"name","index":0,"aggr":"sum"}],"values":[{"name":"gender","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"name","index":0,"aggr":"sum"},"yAxis":{"name":"gender","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746208709_2100383850","id":"20160612-154328_1170395865","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tgender\tage\theight\nBob\tmale\t13\t146\nAlive\tfemale\t42\t159\nEve\tfemale\t19\t169\nCyrus\tmale\t27\t178\nDan\tmale\t32\t186\nFiona\tfemale\t23\t166\n","comment":"","msgTable":[[{"key":"gender","value":"Bob"},{"key":"gender","value":"male"},{"key":"gender","value":"13"},{"key":"gender","value":"146"}],[{"key":"age","value":"Alive"},{"key":"age","value":"female"},{"key":"age","value":"42"},{"key":"age","value":"159"}],[{"key":"height","value":"Eve"},{"key":"height","value":"female"},{"key":"height","value":"19"},{"key":"height","value":"169"}],[{"value":"Cyrus"},{"value":"male"},{"value":"27"},{"value":"178"}],[{"value":"Dan"},{"value":"male"},{"value":"32"},{"value":"186"}],[{"value":"Fiona"},{"value":"female"},{"value":"23"},{"value":"166"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"gender","index":1,"aggr":"sum"},{"name":"age","index":2,"aggr":"sum"},{"name":"height","index":3,"aggr":"sum"}],"rows":[["Bob","male","13","146"],["Alive","female","42","159"],["Eve","female","19","169"],["Cyrus","male","27","178"],["Dan","male","32","186"],["Fiona","female","23","166"]]},"dateCreated":"Jun 12, 2016 3:43:28 PM","dateStarted":"Jun 17, 2016 4:17:31 PM","dateFinished":"Jun 17, 2016 4:17:33 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:125"},{"text":"val result = persons.select('gender,'age).groupBy('gender).avg()\n\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:57:12 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"gender","index":0,"aggr":"sum"}],"values":[{"name":"avg(age)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"gender","index":0,"aggr":"sum"},"yAxis":{"name":"avg(age)","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746357517_-60919288","id":"20160612-154557_888346984","result":{"code":"SUCCESS","type":"TABLE","msg":"gender\tavg(age)\nfemale\t28.0\nmale\t24.0\n","comment":"","msgTable":[[{"key":"avg(age)","value":"female"},{"key":"avg(age)","value":"28.0"}],[{"value":"male"},{"value":"24.0"}]],"columnNames":[{"name":"gender","index":0,"aggr":"sum"},{"name":"avg(age)","index":1,"aggr":"sum"}],"rows":[["female","28.0"],["male","24.0"]]},"dateCreated":"Jun 12, 2016 3:45:57 PM","dateStarted":"Jun 12, 2016 3:57:12 PM","dateFinished":"Jun 12, 2016 3:57:14 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:126"},{"text":"val result = persons.groupBy('gender).agg({\"age\" -> \"max\"}).withColumnRenamed(\"max(age)\",\"max_age\")\n\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:57:18 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746409745_1364868191","id":"20160612-154649_674961350","result":{"code":"SUCCESS","type":"TABLE","msg":"gender\tmax_age\nfemale\t42\nmale\t32\n","comment":"","msgTable":[[{"key":"max_age","value":"female"},{"key":"max_age","value":"42"}],[{"value":"male"},{"value":"32"}]],"columnNames":[{"name":"gender","index":0,"aggr":"sum"},{"name":"max_age","index":1,"aggr":"sum"}],"rows":[["female","42"],["male","32"]]},"dateCreated":"Jun 12, 2016 3:46:49 PM","dateStarted":"Jun 12, 2016 3:57:18 PM","dateFinished":"Jun 12, 2016 3:57:19 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:127"},{"text":"val result = persons.groupBy('gender)\n    .agg(\n        avg('age) as \"avg_age\",\n        min('height) as \"min_height\",\n        max('height) as \"max_height\"\n    )\n\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:57:22 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746444794_-1854295208","id":"20160612-154724_579125114","result":{"code":"SUCCESS","type":"TABLE","msg":"gender\tavg_age\tmin_height\tmax_height\nfemale\t28.0\t159\t169\nmale\t24.0\t146\t186\n","comment":"","msgTable":[[{"key":"avg_age","value":"female"},{"key":"avg_age","value":"28.0"},{"key":"avg_age","value":"159"},{"key":"avg_age","value":"169"}],[{"key":"min_height","value":"male"},{"key":"min_height","value":"24.0"},{"key":"min_height","value":"146"},{"key":"min_height","value":"186"}]],"columnNames":[{"name":"gender","index":0,"aggr":"sum"},{"name":"avg_age","index":1,"aggr":"sum"},{"name":"min_height","index":2,"aggr":"sum"},{"name":"max_height","index":3,"aggr":"sum"}],"rows":[["female","28.0","159","169"],["male","24.0","146","186"]]},"dateCreated":"Jun 12, 2016 3:47:24 PM","dateStarted":"Jun 12, 2016 3:57:22 PM","dateFinished":"Jun 12, 2016 3:57:24 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:128"},{"text":"%md\n# Sorting Data","dateUpdated":"Jun 12, 2016 3:49:43 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746543372_979886139","id":"20160612-154903_648261643","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Sorting Data</h1>\n"},"dateCreated":"Jun 12, 2016 3:49:03 PM","dateStarted":"Jun 12, 2016 3:49:39 PM","dateFinished":"Jun 12, 2016 3:49:39 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129"},{"text":"val result = persons.orderBy('name)\n\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:57:27 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746579891_1069593929","id":"20160612-154939_820007544","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tgender\tage\theight\nAlive\tfemale\t42\t159\nBob\tmale\t13\t146\nCyrus\tmale\t27\t178\nDan\tmale\t32\t186\nEve\tfemale\t19\t169\nFiona\tfemale\t23\t166\n","comment":"","msgTable":[[{"key":"gender","value":"Alive"},{"key":"gender","value":"female"},{"key":"gender","value":"42"},{"key":"gender","value":"159"}],[{"key":"age","value":"Bob"},{"key":"age","value":"male"},{"key":"age","value":"13"},{"key":"age","value":"146"}],[{"key":"height","value":"Cyrus"},{"key":"height","value":"male"},{"key":"height","value":"27"},{"key":"height","value":"178"}],[{"value":"Dan"},{"value":"male"},{"value":"32"},{"value":"186"}],[{"value":"Eve"},{"value":"female"},{"value":"19"},{"value":"169"}],[{"value":"Fiona"},{"value":"female"},{"value":"23"},{"value":"166"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"gender","index":1,"aggr":"sum"},{"name":"age","index":2,"aggr":"sum"},{"name":"height","index":3,"aggr":"sum"}],"rows":[["Alive","female","42","159"],["Bob","male","13","146"],["Cyrus","male","27","178"],["Dan","male","32","186"],["Eve","female","19","169"],["Fiona","female","23","166"]]},"dateCreated":"Jun 12, 2016 3:49:39 PM","dateStarted":"Jun 12, 2016 3:57:27 PM","dateFinished":"Jun 12, 2016 3:57:28 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:130"},{"text":"val result = persons.orderBy($\"age\".desc, $\"age\".asc)\n\nresult.toZeppelin()","dateUpdated":"Jun 17, 2016 4:17:40 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746756420_1147154508","id":"20160612-155236_301979744","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tgender\tage\theight\nAlive\tfemale\t42\t159\nDan\tmale\t32\t186\nCyrus\tmale\t27\t178\nFiona\tfemale\t23\t166\nEve\tfemale\t19\t169\nBob\tmale\t13\t146\n","comment":"","msgTable":[[{"key":"gender","value":"Alive"},{"key":"gender","value":"female"},{"key":"gender","value":"42"},{"key":"gender","value":"159"}],[{"key":"age","value":"Dan"},{"key":"age","value":"male"},{"key":"age","value":"32"},{"key":"age","value":"186"}],[{"key":"height","value":"Cyrus"},{"key":"height","value":"male"},{"key":"height","value":"27"},{"key":"height","value":"178"}],[{"value":"Fiona"},{"value":"female"},{"value":"23"},{"value":"166"}],[{"value":"Eve"},{"value":"female"},{"value":"19"},{"value":"169"}],[{"value":"Bob"},{"value":"male"},{"value":"13"},{"value":"146"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"gender","index":1,"aggr":"sum"},{"name":"age","index":2,"aggr":"sum"},{"name":"height","index":3,"aggr":"sum"}],"rows":[["Alive","female","42","159"],["Dan","male","32","186"],["Cyrus","male","27","178"],["Fiona","female","23","166"],["Eve","female","19","169"],["Bob","male","13","146"]]},"dateCreated":"Jun 12, 2016 3:52:36 PM","dateStarted":"Jun 17, 2016 4:17:40 PM","dateFinished":"Jun 17, 2016 4:17:42 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:131"},{"text":"%md\n# Joining Data","dateUpdated":"Jun 12, 2016 3:53:37 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746787123_-452769336","id":"20160612-155307_1442775029","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Joining Data</h1>\n"},"dateCreated":"Jun 12, 2016 3:53:07 PM","dateStarted":"Jun 12, 2016 3:53:32 PM","dateFinished":"Jun 12, 2016 3:53:32 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:132"},{"text":"case class PersonDetails(\n    name:String,\n    city:String\n) { }\n\nval details = sqlContext.createDataFrame(Array(\n        PersonDetails(\"Alice\", \"Frankfurt\"),\n        PersonDetails(\"Bob\", \"Berlin\")\n    ))\n\nval result = persons.join(details, persons(\"name\") === details(\"name\"))\n\nresult.toZeppelin()","dateUpdated":"Jun 12, 2016 3:59:02 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465746812068_-1572742736","id":"20160612-155332_1943504111","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tgender\tage\theight\tname\tcity\nBob\tmale\t13\t146\tBob\tBerlin\n","comment":"","msgTable":[[{"key":"gender","value":"Bob"},{"key":"gender","value":"male"},{"key":"gender","value":"13"},{"key":"gender","value":"146"},{"key":"gender","value":"Bob"},{"key":"gender","value":"Berlin"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"gender","index":1,"aggr":"sum"},{"name":"age","index":2,"aggr":"sum"},{"name":"height","index":3,"aggr":"sum"},{"name":"name","index":4,"aggr":"sum"},{"name":"city","index":5,"aggr":"sum"}],"rows":[["Bob","male","13","146","Bob","Berlin"]]},"dateCreated":"Jun 12, 2016 3:53:32 PM","dateStarted":"Jun 12, 2016 3:59:02 PM","dateFinished":"Jun 12, 2016 3:59:11 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:133"},{"text":"%md\n# Interacting with SQL","dateUpdated":"Jun 17, 2016 4:18:28 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180292084_-1795445831","id":"20160617-161812_1127220850","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Interacting with SQL</h1>\n"},"dateCreated":"Jun 17, 2016 4:18:12 PM","dateStarted":"Jun 17, 2016 4:18:25 PM","dateFinished":"Jun 17, 2016 4:18:25 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:134"},{"text":"persons.registerTempTable(\"persons\")\n\nval result = sqlContext.sql(\"SELECT * FROM persons\")\n\nresult.toZeppelin()","dateUpdated":"Jun 17, 2016 4:19:29 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180323339_2087268213","id":"20160617-161843_1855518036","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tgender\tage\theight\nBob\tmale\t13\t146\nAlive\tfemale\t42\t159\nEve\tfemale\t19\t169\nCyrus\tmale\t27\t178\nDan\tmale\t32\t186\nFiona\tfemale\t23\t166\n","comment":"","msgTable":[[{"key":"gender","value":"Bob"},{"key":"gender","value":"male"},{"key":"gender","value":"13"},{"key":"gender","value":"146"}],[{"key":"age","value":"Alive"},{"key":"age","value":"female"},{"key":"age","value":"42"},{"key":"age","value":"159"}],[{"key":"height","value":"Eve"},{"key":"height","value":"female"},{"key":"height","value":"19"},{"key":"height","value":"169"}],[{"value":"Cyrus"},{"value":"male"},{"value":"27"},{"value":"178"}],[{"value":"Dan"},{"value":"male"},{"value":"32"},{"value":"186"}],[{"value":"Fiona"},{"value":"female"},{"value":"23"},{"value":"166"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"gender","index":1,"aggr":"sum"},{"name":"age","index":2,"aggr":"sum"},{"name":"height","index":3,"aggr":"sum"}],"rows":[["Bob","male","13","146"],["Alive","female","42","159"],["Eve","female","19","169"],["Cyrus","male","27","178"],["Dan","male","32","186"],["Fiona","female","23","166"]]},"dateCreated":"Jun 17, 2016 4:18:43 PM","dateStarted":"Jun 17, 2016 4:19:29 PM","dateFinished":"Jun 17, 2016 4:19:30 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135"},{"text":"%md\n# User Defined Functions","dateUpdated":"Jun 12, 2016 3:59:36 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465747142944_2112658065","id":"20160612-155902_920718644","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>User Defined Functions</h1>\n"},"dateCreated":"Jun 12, 2016 3:59:02 PM","dateStarted":"Jun 12, 2016 3:59:32 PM","dateFinished":"Jun 12, 2016 3:59:32 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:136"},{"text":"val funny = sqlContext.udf.register(\"funny\", {s:String => s.zipWithIndex.map(kv => if (kv._2 % 2 == 1) kv._1.toLower else kv._1.toUpper).mkString(\"\")})\n\nval result = persons.select(funny('name) as \"funny_name\")\n\nresult.toZeppelin()","dateUpdated":"Jun 17, 2016 4:20:37 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465747171979_577555926","id":"20160612-155931_1503875483","result":{"code":"SUCCESS","type":"TABLE","msg":"funny_name\nBoB\nAlIvE\nEvE\nCyRuS\nDaN\nFiOnA\n","comment":"","msgTable":[[{"value":"BoB"}],[{"value":"AlIvE"}],[{"value":"EvE"}],[{"value":"CyRuS"}],[{"value":"DaN"}],[{"value":"FiOnA"}]],"columnNames":[{"name":"funny_name","index":0,"aggr":"sum"}],"rows":[["BoB"],["AlIvE"],["EvE"],["CyRuS"],["DaN"],["FiOnA"]]},"dateCreated":"Jun 12, 2016 3:59:31 PM","dateStarted":"Jun 17, 2016 4:20:37 PM","dateFinished":"Jun 17, 2016 4:20:39 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:137"},{"text":"val result = sqlContext.sql(\"select funny(name) as funny_name from persons\")\n\nresult.toZeppelin()","dateUpdated":"Jun 17, 2016 4:20:28 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{"xAxis":null}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180380615_-865017366","id":"20160617-161940_1666377443","result":{"code":"SUCCESS","type":"TABLE","msg":"funny_name\nBoB\nAlIvE\nEvE\nCyRuS\nDaN\nFiOnA\n","comment":"","msgTable":[[{"value":"BoB"}],[{"value":"AlIvE"}],[{"value":"EvE"}],[{"value":"CyRuS"}],[{"value":"DaN"}],[{"value":"FiOnA"}]],"columnNames":[{"name":"funny_name","index":0,"aggr":"sum"}],"rows":[["BoB"],["AlIvE"],["EvE"],["CyRuS"],["DaN"],["FiOnA"]]},"dateCreated":"Jun 17, 2016 4:19:40 PM","dateStarted":"Jun 17, 2016 4:20:28 PM","dateFinished":"Jun 17, 2016 4:20:29 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:138"},{"text":"%md\n# Caching Data","dateUpdated":"Jun 17, 2016 4:23:33 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180600558_1324309500","id":"20160617-162320_1495447774","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Caching Data</h1>\n"},"dateCreated":"Jun 17, 2016 4:23:20 PM","dateStarted":"Jun 17, 2016 4:23:30 PM","dateFinished":"Jun 17, 2016 4:23:30 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:139"},{"text":"persons.cache()\npersons.count()","dateUpdated":"Jun 17, 2016 4:25:40 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180616844_-648282787","id":"20160617-162336_1875131146","result":{"code":"SUCCESS","type":"TEXT","msg":"res221: persons.type = [name: string, gender: string, age: int, height: int]\nres222: Long = 6\n"},"dateCreated":"Jun 17, 2016 4:23:36 PM","dateStarted":"Jun 17, 2016 4:25:40 PM","dateFinished":"Jun 17, 2016 4:25:41 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:140"},{"text":"persons.unpersist()","dateUpdated":"Jun 17, 2016 4:24:28 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180649522_-1530649932","id":"20160617-162409_876463061","result":{"code":"SUCCESS","type":"TEXT","msg":"res215: persons.type = [name: string, gender: string, age: int, height: int]\n"},"dateCreated":"Jun 17, 2016 4:24:09 PM","dateStarted":"Jun 17, 2016 4:24:28 PM","dateFinished":"Jun 17, 2016 4:24:29 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:141"},{"text":"%md\n# Reading and Writing Data","dateUpdated":"Jun 12, 2016 4:07:08 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465747243045_-451572406","id":"20160612-160043_427568179","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Reading and Writing Data</h1>\n"},"dateCreated":"Jun 12, 2016 4:00:43 PM","dateStarted":"Jun 12, 2016 4:07:02 PM","dateFinished":"Jun 12, 2016 4:07:02 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:142"},{"text":"val df = sqlContext.read.text(\"s3://is24-data-dev-spark-training/data/alice\")\n\ndf.toZeppelin(3)","dateUpdated":"Jun 12, 2016 4:08:59 PM","config":{"colWidth":12,"graph":{"mode":"table","height":194,"optionOpen":false,"keys":[{"name":"value","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"value","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465747622696_170134200","id":"20160612-160702_744208944","result":{"code":"SUCCESS","type":"TABLE","msg":"value\nProject Gutenberg's Alice's Adventures in Wonderland, by Lewis Carroll\n\nThis eBook is for the use of anyone anywhere at no cost and with\n","comment":"This eBook is for the use of anyone anywhere at no cost and with","msgTable":[[{"value":"Project Gutenberg's Alice's Adventures in Wonderland, by Lewis Carroll"}]],"columnNames":[{"name":"value","index":0,"aggr":"sum"}],"rows":[["Project Gutenberg's Alice's Adventures in Wonderland, by Lewis Carroll"]]},"dateCreated":"Jun 12, 2016 4:07:02 PM","dateStarted":"Jun 12, 2016 4:08:59 PM","dateFinished":"Jun 12, 2016 4:09:00 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:143"},{"text":"val result = persons.select(concat('name, lit(\",\"), 'age))\n\nresult.write.mode(\"overwrite\").text(\"persons\")","dateUpdated":"Jun 12, 2016 4:10:56 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465747688911_-545975448","id":"20160612-160808_277383298","result":{"code":"SUCCESS","type":"TEXT","msg":"result: org.apache.spark.sql.DataFrame = [concat(name,,,age): string]\n"},"dateCreated":"Jun 12, 2016 4:08:08 PM","dateStarted":"Jun 12, 2016 4:10:56 PM","dateFinished":"Jun 12, 2016 4:11:03 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:144"},{"text":"%sh\nhdfs dfs -getmerge /user/zeppelin/persons /tmp/persons\ncat /tmp/persons","dateUpdated":"Jun 12, 2016 4:11:31 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465747778890_1892471659","id":"20160612-160938_1466157130","result":{"code":"SUCCESS","type":"TEXT","msg":"Bob,13\nAlive,42\nEve,19\nCyrus,27\nDan,32\nFiona,23\n"},"dateCreated":"Jun 12, 2016 4:09:38 PM","dateStarted":"Jun 12, 2016 4:11:31 PM","dateFinished":"Jun 12, 2016 4:11:34 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:145"},{"text":"%md\n# WordCount Revisited","dateUpdated":"Jun 12, 2016 4:11:51 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465747891601_-1099751185","id":"20160612-161131_370663008","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>WordCount Revisited</h1>\n"},"dateCreated":"Jun 12, 2016 4:11:31 PM","dateStarted":"Jun 12, 2016 4:11:47 PM","dateFinished":"Jun 12, 2016 4:11:47 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:146"},{"text":"val text = sqlContext.read.text(\"s3://is24-data-dev-spark-training/data/alice\")\nval words = text.select(explode(split('value,\" \")).alias(\"word\")).filter('word !== lit(\"\"))\nval counts = words.groupBy($\"word\").count().sort($\"count\".desc)\n\ncounts.toZeppelin(20)","dateUpdated":"Jun 12, 2016 4:25:38 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"word","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"word","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465747907857_27409850","id":"20160612-161147_839240215","result":{"code":"SUCCESS","type":"TABLE","msg":"word\tcount\nthe\t1664\nand\t780\nto\t773\na\t662\nof\t596\nshe\t484\nsaid\t416\nin\t401\nit\t356\nwas\t329\nyou\t301\nI\t260\nas\t246\nthat\t226\nAlice\t221\nwith\t214\nat\t211\nher\t203\nhad\t175\nall\t168\n","comment":"","msgTable":[[{"key":"count","value":"the"},{"key":"count","value":"1664"}],[{"value":"and"},{"value":"780"}],[{"value":"to"},{"value":"773"}],[{"value":"a"},{"value":"662"}],[{"value":"of"},{"value":"596"}],[{"value":"she"},{"value":"484"}],[{"value":"said"},{"value":"416"}],[{"value":"in"},{"value":"401"}],[{"value":"it"},{"value":"356"}],[{"value":"was"},{"value":"329"}],[{"value":"you"},{"value":"301"}],[{"value":"I"},{"value":"260"}],[{"value":"as"},{"value":"246"}],[{"value":"that"},{"value":"226"}],[{"value":"Alice"},{"value":"221"}],[{"value":"with"},{"value":"214"}],[{"value":"at"},{"value":"211"}],[{"value":"her"},{"value":"203"}],[{"value":"had"},{"value":"175"}],[{"value":"all"},{"value":"168"}]],"columnNames":[{"name":"word","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["the","1664"],["and","780"],["to","773"],["a","662"],["of","596"],["she","484"],["said","416"],["in","401"],["it","356"],["was","329"],["you","301"],["I","260"],["as","246"],["that","226"],["Alice","221"],["with","214"],["at","211"],["her","203"],["had","175"],["all","168"]]},"dateCreated":"Jun 12, 2016 4:11:47 PM","dateStarted":"Jun 12, 2016 4:25:38 PM","dateFinished":"Jun 12, 2016 4:25:44 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:147"},{"text":"%md\n# Interacting with Hive Tables","dateUpdated":"Jun 17, 2016 4:21:37 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465748004937_11589173","id":"20160612-161324_149756750","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Interacting with Hive Tables</h1>\n"},"dateCreated":"Jun 12, 2016 4:13:24 PM","dateStarted":"Jun 17, 2016 4:21:33 PM","dateFinished":"Jun 17, 2016 4:21:33 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:148"},{"text":"val tables = sqlContext.tables(\"training\")\n\ntables.toZeppelin()","dateUpdated":"Jun 17, 2016 4:22:15 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"tableName","index":0,"aggr":"sum"}],"values":[{"name":"isTemporary","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"tableName","index":0,"aggr":"sum"},"yAxis":{"name":"isTemporary","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180493231_-1921199070","id":"20160617-162133_1601511180","result":{"code":"SUCCESS","type":"TABLE","msg":"tableName\tisTemporary\npersons\ttrue\nbike_sharing\tfalse\nfirst_names_female\tfalse\nfirst_names_male\tfalse\nlast_names\tfalse\nstations\tfalse\nweather\tfalse\nweather_raw\tfalse\n","comment":"","msgTable":[[{"key":"isTemporary","value":"persons"},{"key":"isTemporary","value":"true"}],[{"value":"bike_sharing"},{"value":"false"}],[{"value":"first_names_female"},{"value":"false"}],[{"value":"first_names_male"},{"value":"false"}],[{"value":"last_names"},{"value":"false"}],[{"value":"stations"},{"value":"false"}],[{"value":"weather"},{"value":"false"}],[{"value":"weather_raw"},{"value":"false"}]],"columnNames":[{"name":"tableName","index":0,"aggr":"sum"},{"name":"isTemporary","index":1,"aggr":"sum"}],"rows":[["persons","true"],["bike_sharing","false"],["first_names_female","false"],["first_names_male","false"],["last_names","false"],["stations","false"],["weather","false"],["weather_raw","false"]]},"dateCreated":"Jun 17, 2016 4:21:33 PM","dateStarted":"Jun 17, 2016 4:22:15 PM","dateFinished":"Jun 17, 2016 4:22:16 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:149"},{"text":"val df = sqlContext.table(\"training.stations\")\n\ndf.limit(10).toZeppelin()","dateUpdated":"Jun 17, 2016 4:22:53 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180522591_993536004","id":"20160617-162202_491733601","result":{"code":"SUCCESS","type":"TABLE","msg":"usaf\twban\tname\tcountry\tstate\ticao\tlatitude\tlongitude\televation\tdate_begin\tdate_end\nUSAF\tWBAN\tSTATION NAME\tCTRY\tSTATE\tICAO\tLAT\tLON\tELEV(M)\tBEGIN\tEND\n007005\t99999\tCWOS 07005\t\t\t\t\t\t\t20120127\t20120127\n007011\t99999\tCWOS 07011\t\t\t\t\t\t\t20111025\t20121129\n007018\t99999\tWXPOD 7018\t\t\t\t+00.000\t+000.000\t+7018.0\t20110309\t20130730\n007025\t99999\tCWOS 07025\t\t\t\t\t\t\t20120127\t20120127\n007026\t99999\tWXPOD 7026\tAF\t\t\t+00.000\t+000.000\t+7026.0\t20120713\t20141120\n007034\t99999\tCWOS 07034\t\t\t\t\t\t\t20121024\t20121106\n007037\t99999\tCWOS 07037\t\t\t\t\t\t\t20111202\t20121125\n007044\t99999\tCWOS 07044\t\t\t\t\t\t\t20120127\t20120127\n007047\t99999\tCWOS 07047\t\t\t\t\t\t\t20120613\t20120717\n","comment":"","msgTable":[[{"key":"wban","value":"USAF"},{"key":"wban","value":"WBAN"},{"key":"wban","value":"STATION NAME"},{"key":"wban","value":"CTRY"},{"key":"wban","value":"STATE"},{"key":"wban","value":"ICAO"},{"key":"wban","value":"LAT"},{"key":"wban","value":"LON"},{"key":"wban","value":"ELEV(M)"},{"key":"wban","value":"BEGIN"},{"key":"wban","value":"END"}],[{"key":"name","value":"007005"},{"key":"name","value":"99999"},{"key":"name","value":"CWOS 07005"},{"key":"name","value":""},{"key":"name","value":""},{"key":"name","value":""},{"key":"name","value":""},{"key":"name","value":""},{"key":"name","value":""},{"key":"name","value":"20120127"},{"key":"name","value":"20120127"}],[{"key":"country","value":"007011"},{"key":"country","value":"99999"},{"key":"country","value":"CWOS 07011"},{"key":"country","value":""},{"key":"country","value":""},{"key":"country","value":""},{"key":"country","value":""},{"key":"country","value":""},{"key":"country","value":""},{"key":"country","value":"20111025"},{"key":"country","value":"20121129"}],[{"key":"state","value":"007018"},{"key":"state","value":"99999"},{"key":"state","value":"WXPOD 7018"},{"key":"state","value":""},{"key":"state","value":""},{"key":"state","value":""},{"key":"state","value":"+00.000"},{"key":"state","value":"+000.000"},{"key":"state","value":"+7018.0"},{"key":"state","value":"20110309"},{"key":"state","value":"20130730"}],[{"key":"icao","value":"007025"},{"key":"icao","value":"99999"},{"key":"icao","value":"CWOS 07025"},{"key":"icao","value":""},{"key":"icao","value":""},{"key":"icao","value":""},{"key":"icao","value":""},{"key":"icao","value":""},{"key":"icao","value":""},{"key":"icao","value":"20120127"},{"key":"icao","value":"20120127"}],[{"key":"latitude","value":"007026"},{"key":"latitude","value":"99999"},{"key":"latitude","value":"WXPOD 7026"},{"key":"latitude","value":"AF"},{"key":"latitude","value":""},{"key":"latitude","value":""},{"key":"latitude","value":"+00.000"},{"key":"latitude","value":"+000.000"},{"key":"latitude","value":"+7026.0"},{"key":"latitude","value":"20120713"},{"key":"latitude","value":"20141120"}],[{"key":"longitude","value":"007034"},{"key":"longitude","value":"99999"},{"key":"longitude","value":"CWOS 07034"},{"key":"longitude","value":""},{"key":"longitude","value":""},{"key":"longitude","value":""},{"key":"longitude","value":""},{"key":"longitude","value":""},{"key":"longitude","value":""},{"key":"longitude","value":"20121024"},{"key":"longitude","value":"20121106"}],[{"key":"elevation","value":"007037"},{"key":"elevation","value":"99999"},{"key":"elevation","value":"CWOS 07037"},{"key":"elevation","value":""},{"key":"elevation","value":""},{"key":"elevation","value":""},{"key":"elevation","value":""},{"key":"elevation","value":""},{"key":"elevation","value":""},{"key":"elevation","value":"20111202"},{"key":"elevation","value":"20121125"}],[{"key":"date_begin","value":"007044"},{"key":"date_begin","value":"99999"},{"key":"date_begin","value":"CWOS 07044"},{"key":"date_begin","value":""},{"key":"date_begin","value":""},{"key":"date_begin","value":""},{"key":"date_begin","value":""},{"key":"date_begin","value":""},{"key":"date_begin","value":""},{"key":"date_begin","value":"20120127"},{"key":"date_begin","value":"20120127"}],[{"key":"date_end","value":"007047"},{"key":"date_end","value":"99999"},{"key":"date_end","value":"CWOS 07047"},{"key":"date_end","value":""},{"key":"date_end","value":""},{"key":"date_end","value":""},{"key":"date_end","value":""},{"key":"date_end","value":""},{"key":"date_end","value":""},{"key":"date_end","value":"20120613"},{"key":"date_end","value":"20120717"}]],"columnNames":[{"name":"usaf","index":0,"aggr":"sum"},{"name":"wban","index":1,"aggr":"sum"},{"name":"name","index":2,"aggr":"sum"},{"name":"country","index":3,"aggr":"sum"},{"name":"state","index":4,"aggr":"sum"},{"name":"icao","index":5,"aggr":"sum"},{"name":"latitude","index":6,"aggr":"sum"},{"name":"longitude","index":7,"aggr":"sum"},{"name":"elevation","index":8,"aggr":"sum"},{"name":"date_begin","index":9,"aggr":"sum"},{"name":"date_end","index":10,"aggr":"sum"}],"rows":[["USAF","WBAN","STATION NAME","CTRY","STATE","ICAO","LAT","LON","ELEV(M)","BEGIN","END"],["007005","99999","CWOS 07005","","","","","","","20120127","20120127"],["007011","99999","CWOS 07011","","","","","","","20111025","20121129"],["007018","99999","WXPOD 7018","","","","+00.000","+000.000","+7018.0","20110309","20130730"],["007025","99999","CWOS 07025","","","","","","","20120127","20120127"],["007026","99999","WXPOD 7026","AF","","","+00.000","+000.000","+7026.0","20120713","20141120"],["007034","99999","CWOS 07034","","","","","","","20121024","20121106"],["007037","99999","CWOS 07037","","","","","","","20111202","20121125"],["007044","99999","CWOS 07044","","","","","","","20120127","20120127"],["007047","99999","CWOS 07047","","","","","","","20120613","20120717"]]},"dateCreated":"Jun 17, 2016 4:22:02 PM","dateStarted":"Jun 17, 2016 4:22:53 PM","dateFinished":"Jun 17, 2016 4:23:02 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:150"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466180573142_-1946117448","id":"20160617-162253_1296143013","dateCreated":"Jun 17, 2016 4:22:53 PM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:151"}],"name":"Spark DataFrame Snippets","id":"2BQFGTTP6","angularObjects":{"2B44YVSN1":[],"2AJXGMUUJ":[],"2AK8P7CPX":[],"2AM1YV5CU":[],"2AKK3QQXU":[],"2ANGGHHMQ":[]},"config":{"looknfeel":"default"},"info":{}}