{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465238657202_1736266965","id":"20160606-114417_1695294284","dateCreated":"Jun 6, 2016 11:44:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3705","text":"%md\n# Using Broadcast Variables and Accumulators\n\nThis small tutorial enhances the WordCount exmaple by stop words, i.e. words that should be ignored. We will apply two techniques in this example:\n1. Broadcast Variables. As the name already suggests, data will be transported to all workers in the cluster.\n2. Accumulators. Those are handy counter variables which can be used to derive some processing metrics","dateUpdated":"Jun 6, 2016 11:46:58 AM","dateFinished":"Jun 6, 2016 11:46:26 AM","dateStarted":"Jun 6, 2016 11:46:26 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Using Broadcast Variables and Accumulators</h1>\n<p>This small tutorial enhances the WordCount exmaple by stop words, i.e. words that should be ignored. We will apply two techniques in this example:</p>\n<ol>\n<li>Broadcast Variables. As the name already suggests, data will be transported to all workers in the cluster.</li>\n<li>Accumulators. Those are handy counter variables which can be used to derive some processing metrics</li>\n</ol>\n"}},{"text":"%pyspark\n\n# First define a list of uninteresting words, the stop words\nstopwords = frozenset(['a','the','an','it','is','are'])\n\n# Broadcast this list to all worker processes in the cluster\nstopwords_bc = sc.broadcast(stopwords)\n\n# Create two accumulators for counting processed words\nstopword_count = sc.accumulator(0)\nregular_count = sc.accumulator(0)\n\n# Define a filter function\ndef filter_word(w):\n    # Check if a given word is in the list of stopwords\n    if w in stopwords_bc.value:\n        stopword_count.add(1)\n        return False\n    else:\n        regular_count.add(1)\n        return True","dateUpdated":"Jun 6, 2016 11:48:47 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464894802807_1409361700","id":"20160602-121322_1103353066","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jun 2, 2016 12:13:22 PM","dateStarted":"Jun 6, 2016 11:48:47 AM","dateFinished":"Jun 6, 2016 11:48:47 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3634","focus":true},{"text":"%pyspark\ntext = sc.textFile('/user/cloudera/alice.txt')\nwords = text.flatMap(lambda x: x.split()) \\\n    .filter(filter_word) \\\n    .map(lambda x: (x,1)) \\\n    .reduceByKey(lambda x,y: x+y) \\\n    .sortBy(lambda x: x[1], ascending=False) \\\n    .map(lambda (k,v): k + ':' + str(v))\nwords.saveAsTextFile('/user/cloudera/alice_counts3')","dateUpdated":"Jun 2, 2016 12:20:26 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464894842991_1809377963","id":"20160602-121402_773248031","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jun 2, 2016 12:14:02 PM","dateStarted":"Jun 2, 2016 12:20:26 PM","dateFinished":"Jun 2, 2016 12:20:28 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3635"},{"text":"%pyspark\n# Print processing metrics\nprint stopword_count.value\nprint regular_count.value","dateUpdated":"Jun 6, 2016 11:50:27 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464895193424_1941653319","id":"20160602-121953_1607929726","result":{"code":"SUCCESS","type":"TEXT","msg":"6978\n81405\n"},"dateCreated":"Jun 2, 2016 12:19:53 PM","dateStarted":"Jun 2, 2016 12:22:11 PM","dateFinished":"Jun 2, 2016 12:22:11 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3636"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464895310574_-1367638725","id":"20160602-122150_1272673033","dateCreated":"Jun 2, 2016 12:21:50 PM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3637"}],"name":"PySpark WordCount with Stop Words","id":"2BMVBM9KP","angularObjects":{"2BKGW8Q6E":[],"2BP2JWUVF":[],"2BM4Z6DBF":[],"2BJUEKW1N":[],"2BNG99EDF":[],"2BM6V6VQG":[],"2BKHCUTH5":[],"2BJGUFRFB":[],"2BM4XH3S9":[],"2BKRDB8F5":[],"2BJDKPSX9":[],"2BN3H3JME":[],"2BMJC3KG9":[],"2BM79W2EN":[]},"config":{"looknfeel":"default"},"info":{}}