{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464894802807_1409361700","id":"20160602-121322_1103353066","dateCreated":"Jun 2, 2016 12:13:22 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:44","dateUpdated":"Jun 2, 2016 12:19:17 PM","dateFinished":"Jun 2, 2016 12:19:17 PM","dateStarted":"Jun 2, 2016 12:19:17 PM","result":{"code":"SUCCESS","type":"TEXT","msg":""},"text":"%pyspark\nstopwords = frozenset(['a','the'])\nstopwords_bc = sc.broadcast(stopwords)\n\nstopword_count = sc.accumulator(0)\nregular_count = sc.accumulator(0)\n\ndef filter_word(w):\n    if w in stopwords_bc.value:\n        stopword_count.add(1)\n        return False\n    else:\n        regular_count.add(1)\n        return True","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464894842991_1809377963","id":"20160602-121402_773248031","dateCreated":"Jun 2, 2016 12:14:02 PM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:91","text":"%pyspark\ntext = sc.textFile('/user/cloudera/alice.txt')\nwords = text.flatMap(lambda x: x.split()) \\\n    .filter(filter_word) \\\n    .map(lambda x: (x,1)) \\\n    .reduceByKey(lambda x,y: x+y) \\\n    .sortBy(lambda x: x[1], ascending=False) \\\n    .map(lambda (k,v): k + ':' + str(v))\nwords.saveAsTextFile('/user/cloudera/alice_counts3')","dateUpdated":"Jun 2, 2016 12:20:26 PM","dateFinished":"Jun 2, 2016 12:20:28 PM","dateStarted":"Jun 2, 2016 12:20:26 PM","result":{"code":"SUCCESS","type":"TEXT","msg":""}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464895193424_1941653319","id":"20160602-121953_1607929726","dateCreated":"Jun 2, 2016 12:19:53 PM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:119","dateUpdated":"Jun 2, 2016 12:22:11 PM","dateFinished":"Jun 2, 2016 12:22:11 PM","dateStarted":"Jun 2, 2016 12:22:11 PM","result":{"code":"SUCCESS","type":"TEXT","msg":"6978\n81405\n"},"text":"%pyspark\nprint stopword_count.value\nprint regular_count.value"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464895310574_-1367638725","id":"20160602-122150_1272673033","dateCreated":"Jun 2, 2016 12:21:50 PM","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:149"}],"name":"PySpark WordCount with Stop Words","id":"2BMVBM9KP","angularObjects":{"2BKGW8Q6E":[],"2BP2JWUVF":[],"2BM4Z6DBF":[],"2BJUEKW1N":[],"2BNG99EDF":[],"2BM6V6VQG":[],"2BKHCUTH5":[],"2BJGUFRFB":[],"2BM4XH3S9":[],"2BKRDB8F5":[],"2BJDKPSX9":[],"2BN3H3JME":[],"2BMJC3KG9":[],"2BM79W2EN":[]},"config":{"looknfeel":"default"},"info":{}}