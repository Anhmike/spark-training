{"paragraphs":[{"text":"%md\n# Creating a DataFrame","dateUpdated":"May 29, 2016 5:34:57 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464525250084_23460446","id":"20160529-053410_1168260895","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Creating a DataFrame</h1>\n"},"dateCreated":"May 29, 2016 5:34:10 AM","dateStarted":"May 29, 2016 5:34:53 AM","dateFinished":"May 29, 2016 5:34:53 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1105"},{"text":"%pyspark\ndf = sqlContext.createDataFrame([('Alice', 13), ('Bob', 12)], ['name', 'age'])\nprint df.collect()","dateUpdated":"May 29, 2016 6:00:21 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464525293831_603554518","id":"20160529-053453_1256285310","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Alice', age=13), Row(name=u'Bob', age=12)]\n"},"dateCreated":"May 29, 2016 5:34:53 AM","dateStarted":"May 29, 2016 6:00:21 AM","dateFinished":"May 29, 2016 6:00:22 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1106","focus":true},{"text":"%pyspark\nrdd = sc.parallelize([('Alice', 13), ('Bob', 12)])\ndf = sqlContext.createDataFrame(rdd, ['name', 'age'])\nprint df.collect()","dateUpdated":"May 29, 2016 6:00:26 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464525358472_-1085969847","id":"20160529-053558_460539770","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Alice', age=13), Row(name=u'Bob', age=12)]\n"},"dateCreated":"May 29, 2016 5:35:58 AM","dateStarted":"May 29, 2016 6:00:26 AM","dateFinished":"May 29, 2016 6:00:26 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1107","focus":true},{"text":"%pyspark\ndf.printSchema()","dateUpdated":"May 29, 2016 6:00:27 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464525549187_1041366474","id":"20160529-053909_733688529","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- name: string (nullable = true)\n |-- age: long (nullable = true)\n\n"},"dateCreated":"May 29, 2016 5:39:09 AM","dateStarted":"May 29, 2016 6:00:27 AM","dateFinished":"May 29, 2016 6:00:27 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1108","focus":true},{"text":"%pyspark\nfrom pyspark.sql.types import *\n\ndata = [('Alice', 13), ('Bob', 12)]\nschema = StructType([\n    StructField('name', StringType(), True),\n    StructField('age', IntegerType(), True),\n    ])\n    \nrdd = sc.parallelize(data)\ndf = sqlContext.createDataFrame(rdd, schema)\nprint df.collect()","dateUpdated":"May 29, 2016 6:00:30 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464525415555_1560191881","id":"20160529-053655_725652713","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Alice', age=13), Row(name=u'Bob', age=12)]\n"},"dateCreated":"May 29, 2016 5:36:55 AM","dateStarted":"May 29, 2016 6:00:30 AM","dateFinished":"May 29, 2016 6:00:30 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1109","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464527454308_-298201146","id":"20160529-061054_654456267","dateCreated":"May 29, 2016 6:10:54 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1402","text":"%md\n# Selecting Columns","dateUpdated":"May 29, 2016 6:11:06 AM","dateFinished":"May 29, 2016 6:11:03 AM","dateStarted":"May 29, 2016 6:11:03 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Selecting Columns</h1>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464527468021_-2114600703","id":"20160529-061108_920350376","dateCreated":"May 29, 2016 6:11:08 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1428","text":"%pyspark\ndf = sqlContext.createDataFrame([('Alice', 13), ('Bob', 12)], ['name', 'age'])\nresult = df.select('name')\nprint result.collect()","dateUpdated":"May 29, 2016 6:11:36 AM","dateFinished":"May 29, 2016 6:11:36 AM","dateStarted":"May 29, 2016 6:11:36 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Alice'), Row(name=u'Bob')]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464527500622_1447232759","id":"20160529-061140_1021668714","dateCreated":"May 29, 2016 6:11:40 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1448","text":"%pyspark\ndf = sqlContext.createDataFrame([('Alice', 13), ('Bob', 12)], ['name', 'age'])\nresult = df.select(df.name)\nprint result.collect()","dateUpdated":"May 29, 2016 6:11:52 AM","dateFinished":"May 29, 2016 6:11:53 AM","dateStarted":"May 29, 2016 6:11:52 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Alice'), Row(name=u'Bob')]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464527584808_-610865729","id":"20160529-061304_1982035519","dateCreated":"May 29, 2016 6:13:04 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1485","text":"%md\n# Transformations","dateUpdated":"May 29, 2016 6:13:14 AM","dateFinished":"May 29, 2016 6:13:11 AM","dateStarted":"May 29, 2016 6:13:11 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Transformations</h1>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464527521703_-1127091483","id":"20160529-061201_795418099","dateCreated":"May 29, 2016 6:12:01 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1468","text":"%pyspark\nfrom pyspark.sql.functions import *\ndf = sqlContext.createDataFrame([('Alice', 13), ('Bob', 12)], ['name', 'age'])\nresult = df.select(df.name, upper(df.name).alias('upper_name'))\nprint result.collect()","dateUpdated":"May 29, 2016 6:16:32 AM","dateFinished":"May 29, 2016 6:16:32 AM","dateStarted":"May 29, 2016 6:16:32 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Alice', upper_name=u'ALICE'), Row(name=u'Bob', upper_name=u'BOB')]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464527799388_-876621594","id":"20160529-061639_111763826","dateCreated":"May 29, 2016 6:16:39 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1526","text":"%pyspark\nfrom pyspark.sql.functions import *\ndf = sqlContext.createDataFrame([('Alice', 13), ('Bob', 12)], ['name', 'age'])\nresult = df.select(df.name, (df.age**2).alias('age_sqr'))\nprint result.collect()","dateUpdated":"May 29, 2016 6:17:47 AM","dateFinished":"May 29, 2016 6:17:47 AM","dateStarted":"May 29, 2016 6:17:47 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Alice', age_sqr=169.0), Row(name=u'Bob', age_sqr=144.0)]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464528054291_1411447822","id":"20160529-062054_665832088","dateCreated":"May 29, 2016 6:20:54 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1558","text":"%pyspark\nfrom pyspark.sql.functions import *\ndf = sqlContext.createDataFrame([('Alice', 13), ('Bob', 12)], ['name', 'age'])\nresult = df.select(\n        concat(\n            df.name,\n            lit('_'),\n            df.age.cast('string')\n        ).alias('name_age')\n    )\nprint result.collect()","dateUpdated":"May 29, 2016 6:23:18 AM","dateFinished":"May 29, 2016 6:23:18 AM","dateStarted":"May 29, 2016 6:23:18 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name_age=u'Alice_13'), Row(name_age=u'Bob_12')]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464527342576_-450747245","id":"20160529-060902_2055244831","dateCreated":"May 29, 2016 6:09:02 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1356","text":"%md\n# Filtering","dateUpdated":"May 29, 2016 6:09:19 AM","dateFinished":"May 29, 2016 6:09:16 AM","dateStarted":"May 29, 2016 6:09:16 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Filtering</h1>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464527362807_-2093024117","id":"20160529-060922_883191739","dateCreated":"May 29, 2016 6:09:22 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1378","text":"%pyspark\ndf = sqlContext.createDataFrame([('Alice', 13), ('Bob', 12)], ['name', 'age'])\nresult = df.filter(\"age > 12\")\nprint result.collect()","dateUpdated":"May 29, 2016 6:10:27 AM","dateFinished":"May 29, 2016 6:10:28 AM","dateStarted":"May 29, 2016 6:10:28 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Alice', age=13)]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464529176505_463833183","id":"20160529-063936_583577451","dateCreated":"May 29, 2016 6:39:36 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1584","text":"%md\n# Aggregations","dateUpdated":"May 29, 2016 6:39:52 AM","dateFinished":"May 29, 2016 6:39:49 AM","dateStarted":"May 29, 2016 6:39:49 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Aggregations</h1>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464529193620_-1557036606","id":"20160529-063953_635546796","dateCreated":"May 29, 2016 6:39:53 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1606","text":"%pyspark\nfrom pyspark.sql.functions import *\nrdd = sc.range(1,100).map(lambda x: [x])\ndf = sqlContext.createDataFrame(rdd, ['value'])\nresult = df.select(sum(df.value).alias('sum'), avg(df.value).alias('avg'), min(df.value).alias('min'), max(df.value).alias('max'), count(df.value).alias('count'))\nprint result.collect()","dateUpdated":"May 29, 2016 6:44:10 AM","dateFinished":"May 29, 2016 6:44:11 AM","dateStarted":"May 29, 2016 6:44:10 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(sum=4950, avg=50.0, min=1, max=99, count=99)]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464529983766_-1088306297","id":"20160529-065303_1282545029","dateCreated":"May 29, 2016 6:53:03 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1634","text":"%md\n# Making Data Distinct","dateUpdated":"May 29, 2016 6:53:15 AM","dateFinished":"May 29, 2016 6:53:12 AM","dateStarted":"May 29, 2016 6:53:12 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Making Data Distinct</h1>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464529997373_-1084043411","id":"20160529-065317_1897656836","dateCreated":"May 29, 2016 6:53:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1656","text":"%pyspark\nfrom pyspark.sql.functions import *\ndf = sqlContext.createDataFrame([('Bob',),('Alice',),('Bob',)], ['name'])\nresult = df.distinct()\nprint result.collect()","dateUpdated":"May 29, 2016 6:55:02 AM","dateFinished":"May 29, 2016 6:55:03 AM","dateStarted":"May 29, 2016 6:55:02 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Alice'), Row(name=u'Bob')]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464530142966_-522512520","id":"20160529-065542_977346734","dateCreated":"May 29, 2016 6:55:42 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1684","text":"%md \n# Grouping & Aggregating","dateUpdated":"May 29, 2016 6:55:58 AM","dateFinished":"May 29, 2016 6:55:55 AM","dateStarted":"May 29, 2016 6:55:55 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Grouping &amp; Aggregating</h1>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464530160090_-1043062458","id":"20160529-065600_765109293","dateCreated":"May 29, 2016 6:56:00 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1704","text":"%pyspark\ndf = sqlContext.createDataFrame([(\"male\",13,146), (\"male\",17,173), (\"female\", 9,121), (\"male\", 23,187), (\"female\",33,165)],['gender','age','height'])\nresult = df.select(df.gender,df.age).groupBy(df.gender).avg()\nprint result.collect()","dateUpdated":"May 29, 2016 7:06:39 AM","dateFinished":"May 29, 2016 7:06:40 AM","dateStarted":"May 29, 2016 7:06:39 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(gender=u'female', avg(age)=21.0), Row(gender=u'male', avg(age)=17.666666666666668)]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464530258814_1604564934","id":"20160529-065738_495858537","dateCreated":"May 29, 2016 6:57:38 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1725","text":"%pyspark\ndf = sqlContext.createDataFrame([(\"male\",13,146), (\"male\",17,173), (\"female\", 9,121), (\"male\", 23,187), (\"female\",33,165)],['gender','age','height'])\nresult = df.groupBy(df.gender).agg({'age':'max'}).withColumnRenamed('max(age)','max_age')\nprint result.collect()","dateUpdated":"May 29, 2016 7:07:15 AM","dateFinished":"May 29, 2016 7:07:16 AM","dateStarted":"May 29, 2016 7:07:15 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(gender=u'female', max_age=33), Row(gender=u'male', max_age=23)]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464530598987_828229786","id":"20160529-070318_974109145","dateCreated":"May 29, 2016 7:03:18 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1755","text":"%pyspark\ndf = sqlContext.createDataFrame([(\"male\",13,146), (\"male\",17,173), (\"female\", 9,121), (\"male\", 23,187), (\"female\",33,165)],['gender','age','height'])\ndf = df.withColumn('min_height', df.height).withColumn('max_height',df.height)\nresult = df.groupBy(df.gender).agg({'age':'avg','min_height':'min','max_height':'max'})\nprint result.collect()\n","dateUpdated":"May 29, 2016 7:09:05 AM","dateFinished":"May 29, 2016 7:09:06 AM","dateStarted":"May 29, 2016 7:09:05 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(gender=u'female', max(max_height)=165, avg(age)=21.0, min(min_height)=121), Row(gender=u'male', max(max_height)=187, avg(age)=17.666666666666668, min(min_height)=146)]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464530977438_-1148875507","id":"20160529-070937_58344744","dateCreated":"May 29, 2016 7:09:37 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1784","text":"%md\n# Sorting Data","dateUpdated":"May 29, 2016 7:09:47 AM","dateFinished":"May 29, 2016 7:09:44 AM","dateStarted":"May 29, 2016 7:09:44 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Sorting Data</h1>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464530990138_1313148029","id":"20160529-070950_2126511249","dateCreated":"May 29, 2016 7:09:50 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1808","text":"%pyspark\ndf = sqlContext.createDataFrame([('Alice',12),('Bob',17)],['name','age'])\nresult = df.orderBy(df.name)\nprint result.collect()","dateUpdated":"May 29, 2016 7:11:39 AM","dateFinished":"May 29, 2016 7:11:40 AM","dateStarted":"May 29, 2016 7:11:39 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Alice', age=12), Row(name=u'Bob', age=17)]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464531104013_-1586918970","id":"20160529-071144_836097343","dateCreated":"May 29, 2016 7:11:44 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1828","text":"%pyspark\ndf = sqlContext.createDataFrame([('Alice',12),('Bob',17)],['name','age'])\nresult = df.orderBy(df.age.desc())\nprint result.collect()","dateUpdated":"May 29, 2016 7:12:46 AM","dateFinished":"May 29, 2016 7:12:46 AM","dateStarted":"May 29, 2016 7:12:46 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Bob', age=17), Row(name=u'Alice', age=12)]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464531317681_-970460931","id":"20160529-071517_553705629","dateCreated":"May 29, 2016 7:15:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1853","text":"%md\n# Joining Data","dateUpdated":"May 29, 2016 7:15:26 AM","dateFinished":"May 29, 2016 7:15:23 AM","dateStarted":"May 29, 2016 7:15:23 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Joining Data</h1>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464531328196_645499774","id":"20160529-071528_1321431629","dateCreated":"May 29, 2016 7:15:28 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1875","text":"%pyspark\nx = sqlContext.createDataFrame([('Alice',12),('Bob',17)],['name','age'])\ny = sqlContext.createDataFrame([('Alice','Frankfurt'),('Bob','Berlin')],['name','city'])\nresult = x.join(y,x.name == y.name).select(x.name,x.age,y.city)\nprint result.collect()","dateUpdated":"May 29, 2016 7:22:44 AM","dateFinished":"May 29, 2016 7:22:45 AM","dateStarted":"May 29, 2016 7:22:44 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Alice', age=12, city=u'Frankfurt'), Row(name=u'Bob', age=17, city=u'Berlin')]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464531819496_1370843919","id":"20160529-072339_492869246","dateCreated":"May 29, 2016 7:23:39 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1932","text":"%md\n# WordCount Revisited","dateUpdated":"May 29, 2016 7:24:58 AM","dateFinished":"May 29, 2016 7:24:59 AM","dateStarted":"May 29, 2016 7:24:59 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>WordCount Revisited</h1>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464531836952_-1766367964","id":"20160529-072356_1703010054","dateCreated":"May 29, 2016 7:23:56 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1954","text":"%pyspark\ntext = sc.textFile('/user/cloudera/alice.txt').map(lambda line: [line])\ndf = sqlContext.createDataFrame(text, ['line'])\nwords = df.select(explode(split(df.line,' ')).alias('word')).filter(col('word') != '')\ncounts = words.groupBy(words.word).count().orderBy('count',ascending=False)\n\nprint counts.take(10) ","dateUpdated":"May 29, 2016 7:28:03 AM","dateFinished":"May 29, 2016 7:28:08 AM","dateStarted":"May 29, 2016 7:28:03 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(word=u'the', count=1664), Row(word=u'and', count=780), Row(word=u'to', count=773), Row(word=u'a', count=662), Row(word=u'of', count=596), Row(word=u'she', count=484), Row(word=u'said', count=416), Row(word=u'in', count=401), Row(word=u'it', count=356), Row(word=u'was', count=329)]\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464525622452_1818482631","id":"20160529-054022_424118432","dateCreated":"May 29, 2016 5:40:22 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1111","dateUpdated":"May 29, 2016 6:06:21 AM","dateFinished":"May 29, 2016 6:06:19 AM","dateStarted":"May 29, 2016 6:06:19 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Accessing Tables in Hive</h1>\n"},"text":"%md\n# Accessing Tables in Hive","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464527169734_-1378777440","id":"20160529-060609_1852941820","dateCreated":"May 29, 2016 6:06:09 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1262","dateUpdated":"May 29, 2016 6:07:07 AM","dateFinished":"May 29, 2016 6:07:07 AM","dateStarted":"May 29, 2016 6:07:07 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(tableName=u'stations', isTemporary=False), Row(tableName=u'weather', isTemporary=False), Row(tableName=u'weather_raw', isTemporary=False)]\n"},"text":"%pyspark\nprint sqlContext.tables(dbName='training').collect()"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464527299004_1852698447","id":"20160529-060819_1244279969","dateCreated":"May 29, 2016 6:08:19 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1338","text":"%pyspark\nprint sqlContext.tableNames(dbName='training')","dateUpdated":"May 29, 2016 6:08:41 AM","dateFinished":"May 29, 2016 6:08:41 AM","dateStarted":"May 29, 2016 6:08:41 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'stations', u'weather', u'weather_raw']\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464527195583_1770053531","id":"20160529-060635_673646049","dateCreated":"May 29, 2016 6:06:35 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1286","dateUpdated":"May 29, 2016 6:08:01 AM","dateFinished":"May 29, 2016 6:08:01 AM","dateStarted":"May 29, 2016 6:08:01 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(usaf=u'USAF', wban=u'WBAN', name=u'STATION NAME', country=u'CTRY', state=u'STATE', icao=u'ICAO', latitude=u'LAT', longitude=u'LON', elevation=u'ELEV(M)', date_begin=u'BEGIN', date_end=u'END'), Row(usaf=u'007005', wban=u'99999', name=u'CWOS 07005', country=u'', state=u'', icao=u'', latitude=u'', longitude=u'', elevation=u'', date_begin=u'20120127', date_end=u'20120127'), Row(usaf=u'007011', wban=u'99999', name=u'CWOS 07011', country=u'', state=u'', icao=u'', latitude=u'', longitude=u'', elevation=u'', date_begin=u'20111025', date_end=u'20121129')]\n"},"text":"%pyspark\nprint sqlContext.table('training.stations').take(3)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464527263809_-551105411","id":"20160529-060743_2125519725","dateCreated":"May 29, 2016 6:07:43 AM","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1314","dateUpdated":"May 29, 2016 6:09:25 AM","text":""}],"name":"PySpark DataFrame Snippets","id":"2BK7RXG8U","angularObjects":{"2BKGW8Q6E":[],"2BP2JWUVF":[],"2BM4Z6DBF":[],"2BJUEKW1N":[],"2BNG99EDF":[],"2BM6V6VQG":[],"2BKHCUTH5":[],"2BJGUFRFB":[],"2BM4XH3S9":[],"2BKRDB8F5":[],"2BJDKPSX9":[],"2BN3H3JME":[],"2BMJC3KG9":[],"2BM79W2EN":[]},"config":{"looknfeel":"default"},"info":{}}