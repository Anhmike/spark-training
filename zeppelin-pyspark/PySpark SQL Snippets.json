{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464720685110_-272640091","id":"20160531-115125_1911582678","dateCreated":"May 31, 2016 11:51:25 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1061","text":"%pyspark\ndef print_df(df, limit=None):\n    if limit is not None:\n        data = df.take(limit)\n    else:\n        data = df.collect()\n        \n    print '%table'\n    print '\\t'.join(map(lambda field: field.name, df.schema.fields))\n    for row in data:\n        print '\\t'.join(map(str, row))","dateUpdated":"May 31, 2016 11:51:28 AM","dateFinished":"May 31, 2016 11:51:28 AM","dateStarted":"May 31, 2016 11:51:28 AM","result":{"code":"SUCCESS","type":"TEXT","msg":""}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464719520710_292497512","id":"20160531-113200_2009443712","dateCreated":"May 31, 2016 11:32:00 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:859","text":"%md\n# Registering SQL Table","dateUpdated":"May 31, 2016 11:38:58 AM","dateFinished":"May 31, 2016 11:38:56 AM","dateStarted":"May 31, 2016 11:38:56 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Registering SQL Table</h1>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464719936062_-239444940","id":"20160531-113856_1243668994","dateCreated":"May 31, 2016 11:38:56 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:876","dateUpdated":"May 31, 2016 11:39:35 AM","dateFinished":"May 31, 2016 11:39:35 AM","dateStarted":"May 31, 2016 11:39:35 AM","result":{"code":"SUCCESS","type":"TEXT","msg":""},"text":"%pyspark\nschema = ['name', 'age']\ndata = [('Alice', 13), ('Bob', 12)]\ndf = sqlContext.createDataFrame(data, schema)\ndf.registerTempTable('people')"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464719949825_1465408085","id":"20160531-113909_210991416","dateCreated":"May 31, 2016 11:39:09 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:904","dateUpdated":"May 31, 2016 11:39:43 AM","dateFinished":"May 31, 2016 11:39:45 AM","dateStarted":"May 31, 2016 11:39:43 AM","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tage\nAlice\t13\nBob\t12\n","comment":"","msgTable":[[{"key":"age","value":"Alice"},{"key":"age","value":"13"}],[{"value":"Bob"},{"value":"12"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"age","index":1,"aggr":"sum"}],"rows":[["Alice","13"],["Bob","12"]]},"text":"%sql\nselect * from people"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464720490235_823785361","id":"20160531-114810_29409719","dateCreated":"May 31, 2016 11:48:10 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1005","text":"%md\n# Using SQL Programmatically","dateUpdated":"May 31, 2016 11:51:28 AM","dateFinished":"May 31, 2016 11:51:28 AM","dateStarted":"May 31, 2016 11:51:28 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Using SQL Programmatically</h1>\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464720649283_1757649207","id":"20160531-115049_1417317885","dateCreated":"May 31, 2016 11:50:49 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1044","text":"%pyspark\ndf = sqlContext.sql('select * from people')\nprint_df(df)","dateUpdated":"May 31, 2016 11:51:44 AM","dateFinished":"May 31, 2016 11:51:44 AM","dateStarted":"May 31, 2016 11:51:44 AM","result":{"code":"SUCCESS","type":"TABLE","msg":"name\tage\nAlice\t13\nBob\t12\n","comment":"","msgTable":[[{"key":"age","value":"Alice"},{"key":"age","value":"13"}],[{"value":"Bob"},{"value":"12"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"age","index":1,"aggr":"sum"}],"rows":[["Alice","13"],["Bob","12"]]}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464719983536_578039204","id":"20160531-113943_979161555","dateCreated":"May 31, 2016 11:39:43 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:922","dateUpdated":"May 31, 2016 11:40:10 AM","dateFinished":"May 31, 2016 11:40:08 AM","dateStarted":"May 31, 2016 11:40:08 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>SQL WordCount</h1>\n"},"text":"%md\n# SQL WordCount"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"freq","index":0,"aggr":"sum"}],"values":[{"name":"word","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"freq","index":0,"aggr":"sum"},"yAxis":{"name":"word","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464720008046_-371490433","id":"20160531-114008_838837153","dateCreated":"May 31, 2016 11:40:08 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:944","dateUpdated":"May 31, 2016 11:52:34 AM","dateFinished":"May 31, 2016 11:52:36 AM","dateStarted":"May 31, 2016 11:52:34 AM","result":{"code":"SUCCESS","type":"TABLE","msg":"freq\tword\n1664\tthe\n780\tand\n773\tto\n662\ta\n596\tof\n484\tshe\n416\tsaid\n401\tin\n356\tit\n329\twas\n301\tyou\n260\tI\n246\tas\n226\tthat\n221\tAlice\n214\twith\n211\tat\n203\ther\n175\thad\n168\tall\n154\tbe\n148\ton\n146\tfor\n137\tor\n127\tvery\n122\tnot\n122\tthis\n121\t'I\n117\tlittle\n109\tthey\n105\tbut\n104\tso\n100\tThe\n97\tout\n96\the\n93\this\n91\tabout\n89\tis\n86\twhat\n83\tup\n82\twere\n79\twent\n78\tone\n77\tProject\n77\tdown\n77\thave\n76\tAlice,\n74\tlike\n73\tif\n72\tno\n72\tby\n68\twould\n67\tany\n67\tinto\n67\twhen\n63\tthought\n63\tcould\n62\tyour\n60\t*\n60\tdo\n60\tits\n56\tan\n56\tMock\n55\tmy\n54\tare\n54\tAlice.\n53\tGutenberg-tm\n53\tquite\n51\twho\n50\ttheir\n50\tdid\n50\tthen\n49\tAnd\n49\tthem\n48\tdon't\n48\tmust\n48\tsee\n47\tbegan\n47\tsome\n46\tme\n46\ttime\n45\tfrom\n45\tsuch\n45\tknow\n45\tonly\n45\tgot\n45\tlooked\n44\tthere\n44\twhich\n43\tjust\n43\tget\n41\tmuch\n41\tit,\n41\thow\n40\therself\n39\tway\n39\twork\n39\tgreat\n39\tother\n38\t'and\n","comment":"","msgTable":[[{"key":"word","value":"1664"},{"key":"word","value":"the"}],[{"value":"780"},{"value":"and"}],[{"value":"773"},{"value":"to"}],[{"value":"662"},{"value":"a"}],[{"value":"596"},{"value":"of"}],[{"value":"484"},{"value":"she"}],[{"value":"416"},{"value":"said"}],[{"value":"401"},{"value":"in"}],[{"value":"356"},{"value":"it"}],[{"value":"329"},{"value":"was"}],[{"value":"301"},{"value":"you"}],[{"value":"260"},{"value":"I"}],[{"value":"246"},{"value":"as"}],[{"value":"226"},{"value":"that"}],[{"value":"221"},{"value":"Alice"}],[{"value":"214"},{"value":"with"}],[{"value":"211"},{"value":"at"}],[{"value":"203"},{"value":"her"}],[{"value":"175"},{"value":"had"}],[{"value":"168"},{"value":"all"}],[{"value":"154"},{"value":"be"}],[{"value":"148"},{"value":"on"}],[{"value":"146"},{"value":"for"}],[{"value":"137"},{"value":"or"}],[{"value":"127"},{"value":"very"}],[{"value":"122"},{"value":"not"}],[{"value":"122"},{"value":"this"}],[{"value":"121"},{"value":"'I"}],[{"value":"117"},{"value":"little"}],[{"value":"109"},{"value":"they"}],[{"value":"105"},{"value":"but"}],[{"value":"104"},{"value":"so"}],[{"value":"100"},{"value":"The"}],[{"value":"97"},{"value":"out"}],[{"value":"96"},{"value":"he"}],[{"value":"93"},{"value":"his"}],[{"value":"91"},{"value":"about"}],[{"value":"89"},{"value":"is"}],[{"value":"86"},{"value":"what"}],[{"value":"83"},{"value":"up"}],[{"value":"82"},{"value":"were"}],[{"value":"79"},{"value":"went"}],[{"value":"78"},{"value":"one"}],[{"value":"77"},{"value":"Project"}],[{"value":"77"},{"value":"down"}],[{"value":"77"},{"value":"have"}],[{"value":"76"},{"value":"Alice,"}],[{"value":"74"},{"value":"like"}],[{"value":"73"},{"value":"if"}],[{"value":"72"},{"value":"no"}],[{"value":"72"},{"value":"by"}],[{"value":"68"},{"value":"would"}],[{"value":"67"},{"value":"any"}],[{"value":"67"},{"value":"into"}],[{"value":"67"},{"value":"when"}],[{"value":"63"},{"value":"thought"}],[{"value":"63"},{"value":"could"}],[{"value":"62"},{"value":"your"}],[{"value":"60"},{"value":"*"}],[{"value":"60"},{"value":"do"}],[{"value":"60"},{"value":"its"}],[{"value":"56"},{"value":"an"}],[{"value":"56"},{"value":"Mock"}],[{"value":"55"},{"value":"my"}],[{"value":"54"},{"value":"are"}],[{"value":"54"},{"value":"Alice."}],[{"value":"53"},{"value":"Gutenberg-tm"}],[{"value":"53"},{"value":"quite"}],[{"value":"51"},{"value":"who"}],[{"value":"50"},{"value":"their"}],[{"value":"50"},{"value":"did"}],[{"value":"50"},{"value":"then"}],[{"value":"49"},{"value":"And"}],[{"value":"49"},{"value":"them"}],[{"value":"48"},{"value":"don't"}],[{"value":"48"},{"value":"must"}],[{"value":"48"},{"value":"see"}],[{"value":"47"},{"value":"began"}],[{"value":"47"},{"value":"some"}],[{"value":"46"},{"value":"me"}],[{"value":"46"},{"value":"time"}],[{"value":"45"},{"value":"from"}],[{"value":"45"},{"value":"such"}],[{"value":"45"},{"value":"know"}],[{"value":"45"},{"value":"only"}],[{"value":"45"},{"value":"got"}],[{"value":"45"},{"value":"looked"}],[{"value":"44"},{"value":"there"}],[{"value":"44"},{"value":"which"}],[{"value":"43"},{"value":"just"}],[{"value":"43"},{"value":"get"}],[{"value":"41"},{"value":"much"}],[{"value":"41"},{"value":"it,"}],[{"value":"41"},{"value":"how"}],[{"value":"40"},{"value":"herself"}],[{"value":"39"},{"value":"way"}],[{"value":"39"},{"value":"work"}],[{"value":"39"},{"value":"great"}],[{"value":"39"},{"value":"other"}],[{"value":"38"},{"value":"'and"}]],"columnNames":[{"name":"freq","index":0,"aggr":"sum"},{"name":"word","index":1,"aggr":"sum"}],"rows":[["1664","the"],["780","and"],["773","to"],["662","a"],["596","of"],["484","she"],["416","said"],["401","in"],["356","it"],["329","was"],["301","you"],["260","I"],["246","as"],["226","that"],["221","Alice"],["214","with"],["211","at"],["203","her"],["175","had"],["168","all"],["154","be"],["148","on"],["146","for"],["137","or"],["127","very"],["122","not"],["122","this"],["121","'I"],["117","little"],["109","they"],["105","but"],["104","so"],["100","The"],["97","out"],["96","he"],["93","his"],["91","about"],["89","is"],["86","what"],["83","up"],["82","were"],["79","went"],["78","one"],["77","Project"],["77","down"],["77","have"],["76","Alice,"],["74","like"],["73","if"],["72","no"],["72","by"],["68","would"],["67","any"],["67","into"],["67","when"],["63","thought"],["63","could"],["62","your"],["60","*"],["60","do"],["60","its"],["56","an"],["56","Mock"],["55","my"],["54","are"],["54","Alice."],["53","Gutenberg-tm"],["53","quite"],["51","who"],["50","their"],["50","did"],["50","then"],["49","And"],["49","them"],["48","don't"],["48","must"],["48","see"],["47","began"],["47","some"],["46","me"],["46","time"],["45","from"],["45","such"],["45","know"],["45","only"],["45","got"],["45","looked"],["44","there"],["44","which"],["43","just"],["43","get"],["41","much"],["41","it,"],["41","how"],["40","herself"],["39","way"],["39","work"],["39","great"],["39","other"],["38","'and"]]},"text":"%sql\nwith text as (\n    select \n    explode(split(value,' ')) as word \n    from text.`/user/cloudera/alice.txt`\n)\n\nselect\n    sum(1) as freq,\n    word\nfrom text\nwhere word <> ''\ngroup by word\norder by freq desc\nlimit 100"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464720309459_-561923647","id":"20160531-114509_166779124","dateCreated":"May 31, 2016 11:45:09 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:964","dateUpdated":"May 31, 2016 11:54:31 AM","dateFinished":"May 31, 2016 11:54:28 AM","dateStarted":"May 31, 2016 11:54:28 AM","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>User Defined Functions</h1>\n"},"text":"%md\n# User Defined Functions"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464720868089_-1180203094","id":"20160531-115428_1956955194","dateCreated":"May 31, 2016 11:54:28 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1088","dateUpdated":"May 31, 2016 12:02:29 PM","dateFinished":"May 31, 2016 12:02:29 PM","dateStarted":"May 31, 2016 12:02:29 PM","result":{"code":"SUCCESS","type":"TEXT","msg":"Alice &amp; Bob\n"},"text":"%pyspark\nfrom pyspark.sql.types import *\nimport cgi\n\ndef html_encode(s):\n    return cgi.escape(s)\n    \nprint html_encode('Alice & Bob')\n\nsqlContext.registerFunction('html_encode',html_encode,StringType())"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"_c0","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"_c0","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464720946966_678826970","id":"20160531-115546_1781467922","dateCreated":"May 31, 2016 11:55:46 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1108","dateUpdated":"May 31, 2016 12:02:33 PM","dateFinished":"May 31, 2016 12:02:33 PM","dateStarted":"May 31, 2016 12:02:33 PM","result":{"code":"SUCCESS","type":"TABLE","msg":"_c0\nAlice &amp; Bob\n","comment":"","msgTable":[[{"value":"Alice &amp; Bob"}]],"columnNames":[{"name":"_c0","index":0,"aggr":"sum"}],"rows":[["Alice &amp; Bob"]]},"text":"%sql\nselect html_encode('Alice & Bob')"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464721073520_-1701847626","id":"20160531-115753_1441129430","dateCreated":"May 31, 2016 11:57:53 AM","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1156"}],"name":"PySpark SQL Snippets","id":"2BQ2G3SY1","angularObjects":{"2BKGW8Q6E":[],"2BP2JWUVF":[],"2BM4Z6DBF":[],"2BJUEKW1N":[],"2BNG99EDF":[],"2BM6V6VQG":[],"2BKHCUTH5":[],"2BJGUFRFB":[],"2BM4XH3S9":[],"2BKRDB8F5":[],"2BJDKPSX9":[],"2BN3H3JME":[],"2BMJC3KG9":[],"2BM79W2EN":[]},"config":{"looknfeel":"default"},"info":{}}