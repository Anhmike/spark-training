{"paragraphs":[{"text":"%md\n# Load Data","dateUpdated":"Jun 5, 2016 7:40:16 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465063764489_781608648","id":"20160604-110924_1079477554","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Load Data</h1>\n"},"dateCreated":"Jun 4, 2016 11:09:24 AM","dateStarted":"Jun 5, 2016 7:40:16 AM","dateFinished":"Jun 5, 2016 7:40:16 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1202"},{"text":"%pyspark\nfrom pyspark.sql.functions import *\n\ndata = sqlContext.read.text(\"/user/cloudera/data/amazon_baby\")\ndata = data.select(\n        split('value',',')[0].alias('name'),\n        split('value',',')[1].alias('review'),\n        split('value',',')[2].alias('rating').cast('int')\n).filter(col('rating').isNotNull()).cache()\nprint data.take(3)","dateUpdated":"Jun 5, 2016 7:40:16 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465063746923_1867739469","id":"20160604-110906_1526961609","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(name=u'Planetwise Wipe Pouch', review=u'it came early and was not disappointed. i love planet wise bags and now my wipe holder. it keps my osocozy wipes moist and does not leak. highly recommend it.', rating=5), Row(name=u'Annas Dream Full Quilt with 2 Shams', review=u'Very soft and comfortable and warmer than it looks...fit the full size bed perfectly...would recommend to anyone looking for this type of quilt', rating=5), Row(name=u\"Nature's Lullabies Second Year Sticker Calendar\", review=u'This was the only calender I could find for the second year. I did one for the first and wanted to continue cause there are so many things to note still after they turn 1. This one was better than the first year one I got him.', rating=5)]\n"},"dateCreated":"Jun 4, 2016 11:09:06 AM","dateStarted":"Jun 5, 2016 7:40:16 AM","dateFinished":"Jun 5, 2016 7:40:16 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1203"},{"text":"%md\n# Split Data","dateUpdated":"Jun 5, 2016 7:40:16 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465125834562_-426540495","id":"20160605-042354_1668516234","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Split Data</h1>\n"},"dateCreated":"Jun 5, 2016 4:23:54 AM","dateStarted":"Jun 5, 2016 7:40:16 AM","dateFinished":"Jun 5, 2016 7:40:16 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1204"},{"text":"%pyspark\ntrain_data, test_data = data.randomSplit([0.8,0.2], seed=1)\n\nprint \"train_data: %d\" % train_data.count()\nprint \"test_data: %d\" % test_data.count()","dateUpdated":"Jun 5, 2016 7:40:16 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465125850412_2063585035","id":"20160605-042410_795416739","result":{"code":"SUCCESS","type":"TEXT","msg":"train_data: 25613\ntest_data: 6497\n"},"dateCreated":"Jun 5, 2016 4:24:10 AM","dateStarted":"Jun 5, 2016 7:40:16 AM","dateFinished":"Jun 5, 2016 7:40:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1205"},{"text":"%md\n# Pretty Printing","dateUpdated":"Jun 5, 2016 7:40:16 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465063786830_-1711332717","id":"20160604-110946_2094988725","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Pretty Printing</h1>\n"},"dateCreated":"Jun 4, 2016 11:09:46 AM","dateStarted":"Jun 5, 2016 7:40:16 AM","dateFinished":"Jun 5, 2016 7:40:16 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1206"},{"text":"%pyspark\ndef print_df(df, limit=None):\n    if limit is not None:\n        data = df.take(limit)\n    else:\n        data = df.collect()\n        \n    print '%table'\n    print '\\t'.join(map(lambda field: field.name, df.schema.fields))\n    for row in data:\n        print '\\t'.join(map(str, row))","dateUpdated":"Jun 5, 2016 7:40:16 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465063797376_1969459","id":"20160604-110957_1336679763","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jun 4, 2016 11:09:57 AM","dateStarted":"Jun 5, 2016 7:40:17 AM","dateFinished":"Jun 5, 2016 7:40:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1207"},{"text":"%md\n# Implement Transform","dateUpdated":"Jun 5, 2016 7:40:16 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465063801824_-369297906","id":"20160604-111001_1789373867","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Implement Transform</h1>\n"},"dateCreated":"Jun 4, 2016 11:10:01 AM","dateStarted":"Jun 5, 2016 7:40:16 AM","dateFinished":"Jun 5, 2016 7:40:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1208"},{"text":"%pyspark\n\nfrom pyspark.ml import *\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import *\n\ndef _cleanup_text(text):\n    import string\n    for c in string.punctuation:\n        text = text.replace(c, ' ')\n    return text\n\n\nclass TextCleanupTransformer(Transformer):\n    def __init__(self, inputCol, outputCol):\n        super(Transformer, self).__init__()\n        self.inputCol = inputCol\n        self.outputCol = outputCol\n\n    def _transform(self, dataset):\n        remove_punctuation = udf(_cleanup_text, StringType())\n        return dataset.withColumn(self.outputCol, remove_punctuation(self.inputCol))\n\n\n","dateUpdated":"Jun 5, 2016 7:40:16 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465063494682_1524190994","id":"20160604-110454_1828410018","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jun 4, 2016 11:04:54 AM","dateStarted":"Jun 5, 2016 7:40:17 AM","dateFinished":"Jun 5, 2016 7:40:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1209"},{"text":"%pyspark\ncleaner = TextCleanupTransformer(inputCol='review', outputCol='clean_review')\nclean_data = cleaner.transform(data)\n\nprint_df(clean_data,4)","dateUpdated":"Jun 5, 2016 7:40:17 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465063815486_-982587652","id":"20160604-111015_1356988273","result":{"code":"SUCCESS","type":"TABLE","msg":"name\treview\trating\tclean_review\nPlanetwise Wipe Pouch\tit came early and was not disappointed. i love planet wise bags and now my wipe holder. it keps my osocozy wipes moist and does not leak. highly recommend it.\t5\tit came early and was not disappointed  i love planet wise bags and now my wipe holder  it keps my osocozy wipes moist and does not leak  highly recommend it \nAnnas Dream Full Quilt with 2 Shams\tVery soft and comfortable and warmer than it looks...fit the full size bed perfectly...would recommend to anyone looking for this type of quilt\t5\tVery soft and comfortable and warmer than it looks   fit the full size bed perfectly   would recommend to anyone looking for this type of quilt\nNature's Lullabies Second Year Sticker Calendar\tThis was the only calender I could find for the second year. I did one for the first and wanted to continue cause there are so many things to note still after they turn 1. This one was better than the first year one I got him.\t5\tThis was the only calender I could find for the second year  I did one for the first and wanted to continue cause there are so many things to note still after they turn 1  This one was better than the first year one I got him \nNature's Lullabies Second Year Sticker Calendar\tI completed a calendar for my son's first year and really enjoyed tracking all of his milestones and special moments - so much so that I wanted to continue in the second year since he's still doing amazing and fun things every day.  I really like the simple layout of the calendar and while it might not have all the questions and milestone stickers you want - at least it's something to keep recording all those special moments!\t4\tI completed a calendar for my son s first year and really enjoyed tracking all of his milestones and special moments   so much so that I wanted to continue in the second year since he s still doing amazing and fun things every day   I really like the simple layout of the calendar and while it might not have all the questions and milestone stickers you want   at least it s something to keep recording all those special moments \n","comment":"","msgTable":[[{"key":"review","value":"Planetwise Wipe Pouch"},{"key":"review","value":"it came early and was not disappointed. i love planet wise bags and now my wipe holder. it keps my osocozy wipes moist and does not leak. highly recommend it."},{"key":"review","value":"5"},{"key":"review","value":"it came early and was not disappointed  i love planet wise bags and now my wipe holder  it keps my osocozy wipes moist and does not leak  highly recommend it "}],[{"key":"rating","value":"Annas Dream Full Quilt with 2 Shams"},{"key":"rating","value":"Very soft and comfortable and warmer than it looks...fit the full size bed perfectly...would recommend to anyone looking for this type of quilt"},{"key":"rating","value":"5"},{"key":"rating","value":"Very soft and comfortable and warmer than it looks   fit the full size bed perfectly   would recommend to anyone looking for this type of quilt"}],[{"key":"clean_review","value":"Nature's Lullabies Second Year Sticker Calendar"},{"key":"clean_review","value":"This was the only calender I could find for the second year. I did one for the first and wanted to continue cause there are so many things to note still after they turn 1. This one was better than the first year one I got him."},{"key":"clean_review","value":"5"},{"key":"clean_review","value":"This was the only calender I could find for the second year  I did one for the first and wanted to continue cause there are so many things to note still after they turn 1  This one was better than the first year one I got him "}],[{"value":"Nature's Lullabies Second Year Sticker Calendar"},{"value":"I completed a calendar for my son's first year and really enjoyed tracking all of his milestones and special moments - so much so that I wanted to continue in the second year since he's still doing amazing and fun things every day.  I really like the simple layout of the calendar and while it might not have all the questions and milestone stickers you want - at least it's something to keep recording all those special moments!"},{"value":"4"},{"value":"I completed a calendar for my son s first year and really enjoyed tracking all of his milestones and special moments   so much so that I wanted to continue in the second year since he s still doing amazing and fun things every day   I really like the simple layout of the calendar and while it might not have all the questions and milestone stickers you want   at least it s something to keep recording all those special moments "}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"review","index":1,"aggr":"sum"},{"name":"rating","index":2,"aggr":"sum"},{"name":"clean_review","index":3,"aggr":"sum"}],"rows":[["Planetwise Wipe Pouch","it came early and was not disappointed. i love planet wise bags and now my wipe holder. it keps my osocozy wipes moist and does not leak. highly recommend it.","5","it came early and was not disappointed  i love planet wise bags and now my wipe holder  it keps my osocozy wipes moist and does not leak  highly recommend it "],["Annas Dream Full Quilt with 2 Shams","Very soft and comfortable and warmer than it looks...fit the full size bed perfectly...would recommend to anyone looking for this type of quilt","5","Very soft and comfortable and warmer than it looks   fit the full size bed perfectly   would recommend to anyone looking for this type of quilt"],["Nature's Lullabies Second Year Sticker Calendar","This was the only calender I could find for the second year. I did one for the first and wanted to continue cause there are so many things to note still after they turn 1. This one was better than the first year one I got him.","5","This was the only calender I could find for the second year  I did one for the first and wanted to continue cause there are so many things to note still after they turn 1  This one was better than the first year one I got him "],["Nature's Lullabies Second Year Sticker Calendar","I completed a calendar for my son's first year and really enjoyed tracking all of his milestones and special moments - so much so that I wanted to continue in the second year since he's still doing amazing and fun things every day.  I really like the simple layout of the calendar and while it might not have all the questions and milestone stickers you want - at least it's something to keep recording all those special moments!","4","I completed a calendar for my son s first year and really enjoyed tracking all of his milestones and special moments   so much so that I wanted to continue in the second year since he s still doing amazing and fun things every day   I really like the simple layout of the calendar and while it might not have all the questions and milestone stickers you want   at least it s something to keep recording all those special moments "]]},"dateCreated":"Jun 4, 2016 11:10:15 AM","dateStarted":"Jun 5, 2016 7:40:17 AM","dateFinished":"Jun 5, 2016 7:40:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1210"},{"text":"%md\n# Create Pipeline\n\nNow we have all components for creating an initial ML Pipeline. Remember that we have been using the following components before\n\n* Tokenizer - for splitting reviews into words\n* StopWordRemover - for removing stop words\n* CountVectorizer - for creating bag-of-word features from the words\n* LogisticRegression - for creating the real model\n\nYou also need to transform the incoming rating (1-5) to a sentiment (0 or 1) and you need to drop reviews with a rating of 3. This can be done using one ore more SQLTransformer instances.","dateUpdated":"Jun 8, 2016 12:08:24 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465125756112_681012026","id":"20160605-042236_1623356643","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Create Pipeline</h1>\n<p>Now we have all components for creating an initial ML Pipeline. Remember that we have been using the following components before</p>\n<ul>\n<li>Tokenizer - for splitting reviews into words</li>\n<li>StopWordRemover - for removing stop words</li>\n<li>CountVectorizer - for creating bag-of-word features from the words</li>\n<li>LogisticRegression - for creating the real model</li>\n</ul>\n<p>You also need to transform the incoming rating (1-5) to a sentiment (0 or 1) and you need to drop reviews with a rating of 3. This can be done using one ore more SQLTransformer instances.</p>\n"},"dateCreated":"Jun 5, 2016 4:22:36 AM","dateStarted":"Jun 8, 2016 12:08:21 PM","dateFinished":"Jun 8, 2016 12:08:21 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1211"},{"text":"%pyspark\nfrom pyspark.ml.feature import *\nfrom pyspark.ml.classification import *\n\nstages = [\n    TextCleanupTransformer(inputCol='review', outputCol='clean_review'),\n    SQLTransformer(statement='SELECT *,CASE WHEN rating < 3 THEN 0.0 ELSE 1.0 END AS sentiment FROM __THIS__ WHERE rating <> 3'),\n    Tokenizer(inputCol='clean_review', outputCol='words'),\n    StopWordsRemover(inputCol='words', outputCol='vwords', stopWords=['the','a','and','or', 'it', 'this', 'of', 'an', 'as', 'in', 'on', 'is', 'are', 'to']),\n    CountVectorizer(inputCol='vwords', outputCol='features', minDF=2.0),\n    LogisticRegression(featuresCol='features',labelCol='sentiment')\n]\npipe = Pipeline(stages = stages)\n\nmodel = pipe.fit(train_data)\n","dateUpdated":"Jun 8, 2016 12:08:16 PM","config":{"colWidth":12,"graph":{"mode":"table","height":82,"optionOpen":false,"keys":[{"name":"name","index":0,"aggr":"sum"}],"values":[{"name":"review","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"name","index":0,"aggr":"sum"},"yAxis":{"name":"review","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465063863601_-562983133","id":"20160604-111103_1041396055","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jun 4, 2016 11:11:03 AM","dateStarted":"Jun 5, 2016 7:40:17 AM","dateFinished":"Jun 5, 2016 7:40:22 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1212"},{"text":"%md\n## Predict Data","dateUpdated":"Jun 5, 2016 7:40:17 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465125804421_-1651073651","id":"20160605-042324_195585050","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Predict Data</h2>\n"},"dateCreated":"Jun 5, 2016 4:23:24 AM","dateStarted":"Jun 5, 2016 7:40:17 AM","dateFinished":"Jun 5, 2016 7:40:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1213"},{"text":"%pyspark\npred = model.transform(test_data)\n\nprint_df(pred.select('name', 'review', 'sentiment', 'prediction'), 10)","dateUpdated":"Jun 5, 2016 7:40:17 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"name","index":0,"aggr":"sum"}],"values":[{"name":"review","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"name","index":0,"aggr":"sum"},"yAxis":{"name":"review","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465064010123_1060503984","id":"20160604-111330_1803421983","result":{"code":"SUCCESS","type":"TABLE","msg":"name\treview\tsentiment\tprediction\nNature's Lullabies Second Year Sticker Calendar\tWe wanted to get something to keep track of our child's milestones and this is a cute option. There aren't many other choices out there and this does exactly what we wanted.\t1.0\t1.0\nSoftPlay Peek-A-Boo Where's Elmo A Children's Book\tThis is a cute little peek-a-boo story book.  It's soft.  It's safe.  And it is easy for baby to handle.\t1.0\t1.0\nOur Baby Girl Memory Book\tOMG.....we loved this baby book! Perfect for the memories you want to remember when your little one gets bigger and starts asking questions. It even had a place for foot and hand prints for when your baby is born which is the main reason why we liked this one. Also it has pockets for keepsakes and little places to put first locks of hair....etc! So cute and is a great baby shower gift!\t1.0\t1.0\nJellycat Elephant and Mouse Book\tThe book is just a few pages long with a few words to each page.  Just short enough to keep the attention of my 6 month old son.  We have the Elephant as well so when he's older it will be neat to see the realization of the association between the stuffed toy and the book character\t1.0\t1.0\nBlessed By Pope Benedict XVI Divine Mercy Full Color Medal\tvery nice Divine Mercy Pendant of Jesus now on chain around my neck.  Love It!  Divine Mercy represents Jesuswho offers us an ocean of divine mercy.  Pray to God for our country. You need HIM in your lives!\t1.0\t1.0\nSuper Mario Game Nintendo Wall Sticker and Decal\tThese do not stick to the wall. They start to peel as soon as you stick them to the wall.\t0.0\t1.0\nSemanario (7) Little Girls 14k Gold Overlay Bangle Bracelets for Your Little Princess Sizes 1 - 4 (Size 2 - ages 9-24 Months)\t. I am pleased with product. I love the bangles however they are a bit small. Had to slid them on with lotion. I like a snug fitting bangle but whew these were tough to get on!! If my hand was a hair bigger they wouldn't have fit. They are on to stay. I have small hands also. I got the size for large kid small adult and they fit wrist but tough over the hand. Overall satisfied with product and fast shipping!\t1.0\t1.0\nEdu-Petit Happy Jungle Day Finger Puppet Book Developmental Toy\tMy 2 year old grandson got it for Christmas and he loves when his Mommy reads it to him.  Good quality and very well made.  Other positive reviews directed me to buy it.\t1.0\t1.0\nModern House Trailing Cherry Blossom Vinyl Mural Art Wall Sticker Decal\tI haven't put these up yet but I was disappointed in the color of the flowers. They look more purple than pink.\t0.0\t1.0\nNeurosmith - Music Blocks with Mozart Music Cartridge\tThis was one of my favorite toys-but beware if you buy this I went through 3 of these- and the company no longer exists-so if there is a problem with it-you are out of luck\t1.0\t1.0\n","comment":"","msgTable":[[{"key":"review","value":"Nature's Lullabies Second Year Sticker Calendar"},{"key":"review","value":"We wanted to get something to keep track of our child's milestones and this is a cute option. There aren't many other choices out there and this does exactly what we wanted."},{"key":"review","value":"1.0"},{"key":"review","value":"1.0"}],[{"key":"sentiment","value":"SoftPlay Peek-A-Boo Where's Elmo A Children's Book"},{"key":"sentiment","value":"This is a cute little peek-a-boo story book.  It's soft.  It's safe.  And it is easy for baby to handle."},{"key":"sentiment","value":"1.0"},{"key":"sentiment","value":"1.0"}],[{"key":"prediction","value":"Our Baby Girl Memory Book"},{"key":"prediction","value":"OMG.....we loved this baby book! Perfect for the memories you want to remember when your little one gets bigger and starts asking questions. It even had a place for foot and hand prints for when your baby is born which is the main reason why we liked this one. Also it has pockets for keepsakes and little places to put first locks of hair....etc! So cute and is a great baby shower gift!"},{"key":"prediction","value":"1.0"},{"key":"prediction","value":"1.0"}],[{"value":"Jellycat Elephant and Mouse Book"},{"value":"The book is just a few pages long with a few words to each page.  Just short enough to keep the attention of my 6 month old son.  We have the Elephant as well so when he's older it will be neat to see the realization of the association between the stuffed toy and the book character"},{"value":"1.0"},{"value":"1.0"}],[{"value":"Blessed By Pope Benedict XVI Divine Mercy Full Color Medal"},{"value":"very nice Divine Mercy Pendant of Jesus now on chain around my neck.  Love It!  Divine Mercy represents Jesuswho offers us an ocean of divine mercy.  Pray to God for our country. You need HIM in your lives!"},{"value":"1.0"},{"value":"1.0"}],[{"value":"Super Mario Game Nintendo Wall Sticker and Decal"},{"value":"These do not stick to the wall. They start to peel as soon as you stick them to the wall."},{"value":"0.0"},{"value":"1.0"}],[{"value":"Semanario (7) Little Girls 14k Gold Overlay Bangle Bracelets for Your Little Princess Sizes 1 - 4 (Size 2 - ages 9-24 Months)"},{"value":". I am pleased with product. I love the bangles however they are a bit small. Had to slid them on with lotion. I like a snug fitting bangle but whew these were tough to get on!! If my hand was a hair bigger they wouldn't have fit. They are on to stay. I have small hands also. I got the size for large kid small adult and they fit wrist but tough over the hand. Overall satisfied with product and fast shipping!"},{"value":"1.0"},{"value":"1.0"}],[{"value":"Edu-Petit Happy Jungle Day Finger Puppet Book Developmental Toy"},{"value":"My 2 year old grandson got it for Christmas and he loves when his Mommy reads it to him.  Good quality and very well made.  Other positive reviews directed me to buy it."},{"value":"1.0"},{"value":"1.0"}],[{"value":"Modern House Trailing Cherry Blossom Vinyl Mural Art Wall Sticker Decal"},{"value":"I haven't put these up yet but I was disappointed in the color of the flowers. They look more purple than pink."},{"value":"0.0"},{"value":"1.0"}],[{"value":"Neurosmith - Music Blocks with Mozart Music Cartridge"},{"value":"This was one of my favorite toys-but beware if you buy this I went through 3 of these- and the company no longer exists-so if there is a problem with it-you are out of luck"},{"value":"1.0"},{"value":"1.0"}]],"columnNames":[{"name":"name","index":0,"aggr":"sum"},{"name":"review","index":1,"aggr":"sum"},{"name":"sentiment","index":2,"aggr":"sum"},{"name":"prediction","index":3,"aggr":"sum"}],"rows":[["Nature's Lullabies Second Year Sticker Calendar","We wanted to get something to keep track of our child's milestones and this is a cute option. There aren't many other choices out there and this does exactly what we wanted.","1.0","1.0"],["SoftPlay Peek-A-Boo Where's Elmo A Children's Book","This is a cute little peek-a-boo story book.  It's soft.  It's safe.  And it is easy for baby to handle.","1.0","1.0"],["Our Baby Girl Memory Book","OMG.....we loved this baby book! Perfect for the memories you want to remember when your little one gets bigger and starts asking questions. It even had a place for foot and hand prints for when your baby is born which is the main reason why we liked this one. Also it has pockets for keepsakes and little places to put first locks of hair....etc! So cute and is a great baby shower gift!","1.0","1.0"],["Jellycat Elephant and Mouse Book","The book is just a few pages long with a few words to each page.  Just short enough to keep the attention of my 6 month old son.  We have the Elephant as well so when he's older it will be neat to see the realization of the association between the stuffed toy and the book character","1.0","1.0"],["Blessed By Pope Benedict XVI Divine Mercy Full Color Medal","very nice Divine Mercy Pendant of Jesus now on chain around my neck.  Love It!  Divine Mercy represents Jesuswho offers us an ocean of divine mercy.  Pray to God for our country. You need HIM in your lives!","1.0","1.0"],["Super Mario Game Nintendo Wall Sticker and Decal","These do not stick to the wall. They start to peel as soon as you stick them to the wall.","0.0","1.0"],["Semanario (7) Little Girls 14k Gold Overlay Bangle Bracelets for Your Little Princess Sizes 1 - 4 (Size 2 - ages 9-24 Months)",". I am pleased with product. I love the bangles however they are a bit small. Had to slid them on with lotion. I like a snug fitting bangle but whew these were tough to get on!! If my hand was a hair bigger they wouldn't have fit. They are on to stay. I have small hands also. I got the size for large kid small adult and they fit wrist but tough over the hand. Overall satisfied with product and fast shipping!","1.0","1.0"],["Edu-Petit Happy Jungle Day Finger Puppet Book Developmental Toy","My 2 year old grandson got it for Christmas and he loves when his Mommy reads it to him.  Good quality and very well made.  Other positive reviews directed me to buy it.","1.0","1.0"],["Modern House Trailing Cherry Blossom Vinyl Mural Art Wall Sticker Decal","I haven't put these up yet but I was disappointed in the color of the flowers. They look more purple than pink.","0.0","1.0"],["Neurosmith - Music Blocks with Mozart Music Cartridge","This was one of my favorite toys-but beware if you buy this I went through 3 of these- and the company no longer exists-so if there is a problem with it-you are out of luck","1.0","1.0"]]},"dateCreated":"Jun 4, 2016 11:13:30 AM","dateStarted":"Jun 5, 2016 7:40:17 AM","dateFinished":"Jun 5, 2016 7:40:22 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1214"},{"text":"%md\n## Compare Accuracy with Baseline","dateUpdated":"Jun 5, 2016 7:40:17 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465126011355_447649521","id":"20160605-042651_212244501","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Compare Accuracy with Baseline</h2>\n"},"dateCreated":"Jun 5, 2016 4:26:51 AM","dateStarted":"Jun 5, 2016 7:40:17 AM","dateFinished":"Jun 5, 2016 7:40:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1215"},{"text":"%pyspark\n\nnum_total = pred.count()\nnum_positive = pred.filter(pred.sentiment == 1.0).count()\nnum_correct = pred.filter(pred.sentiment == pred.prediction).count()\n\nmodel_accuracy = float(num_correct) / num_total\nbaseline_accuracy = float(num_positive) / num_total\n\nprint \"Model Accuracy: %f\" % (float(num_correct) / num_total)\nprint \"Baseline Accuracy: %f\" % (float(num_positive) / num_total)","dateUpdated":"Jun 5, 2016 7:40:17 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465126198559_-1557583481","id":"20160605-042958_1889111133","result":{"code":"SUCCESS","type":"TEXT","msg":"Model Accuracy: 0.905803\nBaseline Accuracy: 0.866708\n"},"dateCreated":"Jun 5, 2016 4:29:58 AM","dateStarted":"Jun 5, 2016 7:40:22 AM","dateFinished":"Jun 5, 2016 7:40:23 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1216"},{"text":"%md\n## Use BinaryClassificationEvaluator","dateUpdated":"Jun 5, 2016 7:40:17 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465133868402_1594788946","id":"20160605-063748_601335624","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Use BinaryClassificationEvaluator</h2>\n"},"dateCreated":"Jun 5, 2016 6:37:48 AM","dateStarted":"Jun 5, 2016 7:40:17 AM","dateFinished":"Jun 5, 2016 7:40:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1217"},{"text":"%pyspark\n\nevaluator = BinaryClassificationEvaluator(labelCol='sentiment', metricName=\"areaUnderROC\")\nprint evaluator.evaluate(pred)","dateUpdated":"Jun 5, 2016 7:40:17 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465133882404_724486934","id":"20160605-063802_678693647","result":{"code":"SUCCESS","type":"TEXT","msg":"0.930575874315\n"},"dateCreated":"Jun 5, 2016 6:38:02 AM","dateStarted":"Jun 5, 2016 7:40:23 AM","dateFinished":"Jun 5, 2016 7:40:24 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1218"},{"text":"%md\n# Use different Hyper Parameters\n\nAgain we want to tune some hyper parameters, but this time inside a pipeline. The methodology is the same as before, we can directly include the CrossValidator into the pipeline. But step by step...\n\nFirst let us have a look at all paremeters of a LogisticRegression.","dateUpdated":"Jun 8, 2016 12:15:43 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465126211672_212676857","id":"20160605-043011_1420938648","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Use different Hyper Parameters</h1>\n<p>Again we want to tune some hyper parameters, but this time inside a pipeline. The methodology is the same as before, we can directly include the CrossValidator into the pipeline. But step by step&hellip;</p>\n<p>First let us have a look at all paremeters of a LogisticRegression.</p>\n"},"dateCreated":"Jun 5, 2016 4:30:11 AM","dateStarted":"Jun 8, 2016 12:15:40 PM","dateFinished":"Jun 8, 2016 12:15:40 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1219"},{"text":"%pyspark\n\nprint LogisticRegression().explainParams()","dateUpdated":"Jun 5, 2016 7:40:17 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465134192655_506579494","id":"20160605-064312_1249700228","result":{"code":"SUCCESS","type":"TEXT","msg":"elasticNetParam: the ElasticNet mixing parameter, in range [0, 1]. For alpha = 0, the penalty is an L2 penalty. For alpha = 1, it is an L1 penalty. (default: 0.0)\nfeaturesCol: features column name. (default: features)\nfitIntercept: whether to fit an intercept term. (default: True)\nlabelCol: label column name. (default: label)\nmaxIter: max number of iterations (>= 0). (default: 100)\npredictionCol: prediction column name. (default: prediction)\nprobabilityCol: Column name for predicted class conditional probabilities. Note: Not all models output well-calibrated probability estimates! These probabilities should be treated as confidences, not precise probabilities. (default: probability)\nrawPredictionCol: raw prediction (a.k.a. confidence) column name. (default: rawPrediction)\nregParam: regularization parameter (>= 0). (default: 0.1)\nstandardization: whether to standardize the training features before fitting the model. (default: True)\nthreshold: Threshold in binary classification prediction, in range [0, 1]. If threshold and thresholds are both set, they must match. (default: 0.5)\nthresholds: Thresholds in multi-class classification to adjust the probability of predicting each class. Array must have length equal to the number of classes, with values >= 0. The class with largest value p/t is predicted, where p is the original probability of that class and t is the class' threshold. (undefined)\ntol: the convergence tolerance for iterative algorithms. (default: 1e-06)\nweightCol: weight column name. If this is not set or empty, we treat all instance weights as 1.0. (undefined)\n"},"dateCreated":"Jun 5, 2016 6:43:12 AM","dateStarted":"Jun 5, 2016 7:40:23 AM","dateFinished":"Jun 5, 2016 7:40:24 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1220"},{"text":"%md\n## Create ParamGrid\n\nNow we create a param grid that should be used for using different sets of parameters. We want to tweak two parameters again:\n\n* regParam should take values in [0.0, 0.0001, 0.01, 1.0, 100.0]\n* maxIter should take values in [10, 100])\n\nIn order to create this grid, we first need to create an instance of a LogisticRegression, so we can access its parameters.","dateUpdated":"Jun 8, 2016 12:22:29 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465413736001_362786748","id":"20160608-122216_1360493948","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Create ParamGrid</h2>\n<p>Now we create a param grid that should be used for using different sets of parameters. We want to tweak two parameters again:</p>\n<ul>\n<li>regParam should take values in [0.0, 0.0001, 0.01, 1.0, 100.0]</li>\n<li>maxIter should take values in [10, 100])</li>\n</ul>\n<p>In order to create this grid, we first need to create an instance of a LogisticRegression, so we can access its parameters.</p>\n"},"dateCreated":"Jun 8, 2016 12:22:16 PM","dateStarted":"Jun 8, 2016 12:22:27 PM","dateFinished":"Jun 8, 2016 12:22:27 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1221"},{"text":"%pyspark\nfrom pyspark.ml.tuning import *\n\nlr = LogisticRegression(featuresCol='features',labelCol='sentiment')\n\nparam_grid = ParamGridBuilder() \\\n    .addGrid(lr.regParam, [0.0, 0.0001, 0.01, 1.0, 100.0]) \\\n    .addGrid(lr.maxIter, [10, 100]) \\\n    .build()","dateUpdated":"Jun 8, 2016 12:22:59 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465413752263_-1302006418","id":"20160608-122232_807347072","dateCreated":"Jun 8, 2016 12:22:32 PM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1222"},{"text":"%md\n## Create Pipeline\n\nNow we can create a pipeline using a CrossValidator instead of directly using a LogisticRegression. This means the configuration of the Pipeline should match the old one except that a CrossValidator is inserted instead of the LogisticRegression. The CrossValidator works as a wrapper of the regression algorithm.\n","dateUpdated":"Jun 8, 2016 12:23:14 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465413778588_-1450873594","id":"20160608-122258_1561980956","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Create Pipeline</h2>\n<p>Now we can create a pipeline using a CrossValidator instead of directly using a LogisticRegression. This means the configuration of the Pipeline should match the old one except that a CrossValidator is inserted instead of the LogisticRegression. The CrossValidator works as a wrapper of the regression algorithm.</p>\n"},"dateCreated":"Jun 8, 2016 12:22:58 PM","dateStarted":"Jun 8, 2016 12:23:10 PM","dateFinished":"Jun 8, 2016 12:23:10 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1223"},{"text":"%pyspark\nfrom pyspark.ml.feature import *\nfrom pyspark.ml.classification import *\n\nevaluator = BinaryClassificationEvaluator(labelCol='sentiment', metricName=\"areaUnderROC\")\n\nstages = [\n    TextCleanupTransformer(inputCol='review', outputCol='clean_review'),\n    SQLTransformer(statement='SELECT *,CASE WHEN rating < 3 THEN 0.0 ELSE 1.0 END AS sentiment FROM __THIS__ WHERE rating <> 3'),\n    Tokenizer(inputCol='clean_review', outputCol='words'),\n    StopWordsRemover(inputCol='words', outputCol='vwords', stopWords=['the','a','and','or', 'it', 'this', 'of', 'an', 'as', 'in', 'on', 'is', 'are', 'to']),\n    CountVectorizer(inputCol='vwords', outputCol='features', minDF=2.0),\n    CrossValidator(estimator=lr, estimatorParamMaps=param_grid, evaluator=evaluator, numFolds=3)\n]\npipe = Pipeline(stages = stages)\n\nmodel = pipe.fit(train_data)\n","dateUpdated":"Jun 8, 2016 12:22:59 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465133835392_1298101571","id":"20160605-063715_765624250","result":{"code":"SUCCESS","type":"TEXT","msg":"stages: pipeline stages (current: [TextCleanupTransformer_49e288dffaf58bd23471, SQLTransformer_4f2eb711bd2f51b2ef28, Tokenizer_4434beb67acb62bedb14, StopWordsRemover_45968bea2245ac043c6c, CountVectorizer_46efa5af11d346a25c84, CrossValidator_4fc197f2772a2a66f9ca])\n"},"dateCreated":"Jun 5, 2016 6:37:15 AM","dateStarted":"Jun 5, 2016 7:40:24 AM","dateFinished":"Jun 5, 2016 7:42:56 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1224"},{"text":"%pyspark\npred = model.transform(test_data)\nevaluator = BinaryClassificationEvaluator(labelCol='sentiment', metricName=\"areaUnderROC\")\nprint evaluator.evaluate(pred)\n","dateUpdated":"Jun 5, 2016 7:44:23 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465134282758_-910512001","id":"20160605-064442_323458833","result":{"code":"SUCCESS","type":"TEXT","msg":"0.929719923075\n"},"dateCreated":"Jun 5, 2016 6:44:42 AM","dateStarted":"Jun 5, 2016 7:44:24 AM","dateFinished":"Jun 5, 2016 7:44:25 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1225"},{"text":"%pyspark\n\nnum_total = pred.count()\nnum_correct = pred.filter(pred.sentiment == pred.prediction).count()\n\nmodel_accuracy = float(num_correct) / num_total\n\nprint \"Model Accuracy: %f\" % (float(num_correct) / num_total)\n","dateUpdated":"Jun 5, 2016 7:46:17 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465137863991_576749108","id":"20160605-074423_1692056180","result":{"code":"SUCCESS","type":"TEXT","msg":"Model Accuracy: 0.874711\n"},"dateCreated":"Jun 5, 2016 7:44:23 AM","dateStarted":"Jun 5, 2016 7:46:17 AM","dateFinished":"Jun 5, 2016 7:46:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1226"},{"text":"","dateUpdated":"Jun 5, 2016 7:46:27 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1465137915733_599742097","id":"20160605-074515_177186365","dateCreated":"Jun 5, 2016 7:45:15 AM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1227"}],"name":"PySpark Amazon Baby Products Pipeline","id":"2BQ953P1M","angularObjects":{"2BKGW8Q6E":[],"2BP2JWUVF":[],"2BM4Z6DBF":[],"2BJUEKW1N":[],"2BNG99EDF":[],"2BM6V6VQG":[],"2BKHCUTH5":[],"2BJGUFRFB":[],"2BM4XH3S9":[],"2BKRDB8F5":[],"2BJDKPSX9":[],"2BN3H3JME":[],"2BMJC3KG9":[],"2BM79W2EN":[]},"config":{"looknfeel":"default"},"info":{}}